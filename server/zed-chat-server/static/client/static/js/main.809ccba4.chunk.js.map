{"version":3,"sources":["components/loginScreen/loginGuard.js","store/slices/conversationsSlice.js","store/slices/accountSettingsSlice.js","store/slices/inviteSlice.js","store/slices/friendsSlice.js","store/slices/uiSlice.js","store/slices/authSlice.js","store/store.js","util/regex.js","components/loginScreen/loginScreen.js","modules/login.js","components/loginScreen/ForgotPassword.js","modules/forgotPassword.js","components/loginScreen/CreateAccount.js","modules/createAccount.js","components/socket/chatSocket.js","components/chat/ChatBox.js","util/windowSize.js","components/dropdowns/Message.js","components/listitems/Message.js","components/chat/MessagesListView.js","components/chat/ChatContainer.js","components/listItems/Chat.js","components/sidebar/Sidebar.js","modules/home.js","components/socket/notificationSocket.js","components/modals/SetPWModal.js","components/listItems/FriendCheckBox.js","components/newConversation/SelectFriendsListView.js","components/newConversation/NewConversation.js","modules/newConversation.js","components/modals/About.js","components/modals/ChangeTagname.js","components/modals/DeleteAccount.js","components/modals/Privacy.Security.Disclaimer.js","components/modals/ResetPW.js","components/settings/Settings.js","modules/settings.js","App.js","components/dropdowns/Settings.js","components/listItems/Friend.js","components/dropdowns/Friends.js","components/listItems/FriendRequest.js","components/listItems/AcceptedInvite.js","components/listItems/ReceivedInvite.js","components/dropdowns/Notifications.js","components/topbar/TopBar.js","index.js"],"names":["GuardedRoute","Component","component","auth","rest","render","props","to","conversationsSlice","createSlice","name","initialState","conversations","currentConversation","messages","joined","typing","id","defaultView","showConvList","reducers","clearConversations","state","addConversation","action","filter","conv","payload","conversation","length","console","log","push","removeConversation","setCurrentConversation","addMessage","convs","produce","Array","isArray","message","numberOfMessages","msg","removeMessage","conversationId","messageId","setJoined","setRead","el","convId","read","setTyping","setView","setShowConvList","sortMessages","sort","a","b","Date","parse","createdAt","pinMessage","pinned","batchAddMessages","actions","selectConversations","selectCurrentConversation","selectView","selectShowConvList","accountSlice","email","tagName","loggedIn","clearAccount","setEmail","setTagName","login","logout","setId","selectAccount","account","inviteSlice","sentInvites","receivedInvites","acceptedInvites","clearInvites","addSentInvite","addReceivedInvite","removeSentInvite","removeReceivedInvite","addAcceptedInvite","selectSent","invite","selectReceived","friendsSlice","friends","friendRequests","clearFriends","addFriend","friend","password","removeFriend","addFriendRequest","req","removeFriendRequest","declineRequest","request","cancelled","acceptRequest","accepted","selectFriends","selectFriendRequests","sidebarStates","uiSlice","sidebarState","topbarMessage","accountBackground","backgroundColor","backgroundTint","conversationBackground","setSidebarState","setTopbarMessage","setDefaultBackground","defaultBackground","setColor","setTint","setConversationBackground","selectTopbarMessage","ui","authSlice","username","token","setUserName","setToken","clearAuth","globalSlice","devHost","prodHost","testHost","metadata","api","refreshExpire","setMetadata","setRefreshExpire","selectHost","globals","selectRefreshExpire","reducer","configureStore","authReducer","conversationsReducer","accountReducer","inviteReducer","friendsReducer","uiReducer","tagNameSearch","firstName","lastName","messageBody","conversationName","loginServer","fetch","body","JSON","stringify","headers","method","response","json","statusCode","user","invites","refreshToken","now","validateAccountDetails","LoginScreen","useState","userName","_setUserName","_setPassword","allowLogin","setAllowLogin","error","setError","errorMsgs","setErrorMsgs","dispatch","useDispatch","useSelector","spinning","setSpinning","loggingInCookie","setLoggingInCookie","focusRef","useRef","useEffect","current","focus","credentials","refreshResult","res","addAccountToStore","checkInput","passing","regex","test","submit","result","map","pending","recipientId","Container","className","fluid","Row","Col","style","borderRadius","opacity","maxWidth","marginBottom","Spinner","animation","height","width","variant","InputGroup","FormControl","marginLeft","marginRight","color","minHeight","border","placeholder","aria-label","aria-describedby","onKeyPress","e","key","onChange","target","value","ref","type","Button","onClick","document","getElementById","click","textDecoration","size","marginTop","block","disabled","err","fontSize","LoginComponent","ForgotPassword","tagname","setTagname","emailInvalid","setEmailInvalid","tagnameInvalid","setTagnameInvalid","arr","listStyleType","paddingRight","ForgotPW","CreateAccount","pw1","setPW1","pw2","setPW2","backToLogin","setBackToLogin","passwordNoMatch","setPasswordNoMatch","pw1Invalid","setPw1Invalid","pw2Invalid","setPw2Invalid","bd","session","CreateAcc","chatSocket","socketEvents","connectSuccess","connectError","delivered","deliveryError","readReceipt","listening","unlistened","unlistenError","currentConversationUpdate","setCurrentConversationError","refreshSuccess","refreshError","messagePinned","messagePinnedError","connect","disconnect","chatToServer","readMessage","listen","unlisten","ChatSocket","host","io","transportOptions","polling","extraHeaders","forceNew","on","room","socketId","toast","info","position","hideProgressBar","pauseOnHover","clientId","data","emit","listenAllRooms","userId","refresh","Object","keys","off","close","searchTimeout","useWindowSize","undefined","windowSize","setWindowSize","handleResize","window","innerWidth","innerHeight","addEventListener","removeEventListener","ChatBox","setMessage","formRef","typingTimeout","setTypingTimeout","sendMessage","sender","sendTyping","isTyping","onkeypress","clearTimeout","setTimeout","bottom","left","minWidth","paddingLeft","Append","SendRounded","xs","MessageDropdown","sentByMe","deleteMessage","Dropdown","drop","Toggle","as","Menu","Item","preventDefault","stopPropagation","weekdays","getDateMetaData","date","hour","getHours","min","getMinutes","pm","day","getTime","getDay","minsAgo","MessageMe","isBottom","showMenu","setShowMenu","Math","random","onMouseLeave","onMouseEnter","Typography","display","wordWrap","alert","toFixed","MessageOther","maxHeight","MessageListItem","MessagesListView","setIsTyping","setMessages","loadingMessages","setLoadingMessages","colRef","rowHeight","isNaN","lazyLoadMessages","URLSearchParams","beforeDate","number","messageResult","handleScroll","scrollTop","scrollHeight","onScroll","paddingBottom","paddingTop","overflowY","idx","whiteSpace","ChatContainer","ChatListItem","selectConversation","deleteConversation","selected","buttonMargin","ListItem","toLocaleString","useStyles","makeStyles","animate_in","visibility","flexShrink","animationName","animationDuration","animate_out","narrowPaper","hidePaper","fullDrawerPaper","drawerContainer","overflowX","Sidebar","classes","narrowScreen","filteredConversations","setFilteredConversations","searchBar","setSearchBar","history","useHistory","location","useLocation","searchScreen","setSearchScreen","deleted","setDeleted","pathname","index","self","indexOf","listItemMinWidth","getMinWidthListItem","getButtonMargin","Drawer","paper","Toolbar","List","textAlign","autoComplete","Tooltip","title","anyConvs","includes","searchChatNames","SearchOutlined","Home","notificationSocket","received","inviteReceived","inviteSent","inviteSentError","acceptedInvite","acceptInviteError","friendRequestSent","friendRequestSentError","friendRequestDeclined","friendRequestDeclinedError","friendAdded","acceptFriendRequestError","friendRemoved","friendRemovedError","refreshNotificationSuccess","sent","sendInvite","acceptInvite","sendFriendRequest","declineFriendRequest","acceptFriendRequest","idExists","collection","inviteExists","friendExists","requestExists","requests","NotificationSocket","senderId","friendRequest","recId","warning","acceptor","requestId","acceptorId","exFriend1","exFriend2","friend1","friend2","setupEventListeners","teardownEventListeners","PasswordModalBody","handleSetConvPassword","pw","setPW","setPwRef","borderBottom","FriendCheckBoxListItem","onCheck","checked","setChecked","padding","SelectFriendsListView","errorSearch","selectedFriends","setSelectedFriends","setErrorSearch","setButtonsDisabled","filteredFriends","setFilteredFriends","handleCheck","fr","filterList","cursor","EnterChatName","setConversationName","errorName","enterChatRef","NewConversation","setErrorName","buttonsDisabled","newName","passwordOpened","setPasswordOpened","convPassword","setConvPassword","wide","friendTag","some","otherUsers","users","margin","Modal","open","onClose","aria-labelledby","split","join","NewConversationScreen","About","ChangeTagname","logoutAccount","newTagname","setNewTagname","tagNameError","setTagnameError","DeleteAccount","PrivacySecurityDisclaimer","ResetPW","Settings","aboutOpened","setAboutOpened","deleteAccOpened","setDeleteAccOpened","privacyOpened","setPrivacyOpened","resetPWOpened","setResetPWOpened","changeTagnameOpened","setChangeTagnameOpened","SettingScreen","App","refreshing","setRefreshing","successful","success","path","NewConv","SettingScr","SettingsDropdown","querySelector","FriendListItem","isOnline","friendAction","FriendsDropdown","addFriendInput","setAddFriendInput","searchFriendInput","setSearchFriendInput","searchError","setSearchError","addError","setAddError","checkAddFriendInput","searchFriends","ItemText","convsWithFriend","FriendRequestListItem","friendRequestId","AcceptedInviteListItem","tag","setTag","substring","ReceivedInviteListItem","inviteId","NotificationsDropdown","_acceptedInvites","Badge","overlap","badgeContent","Tabs","defaultActiveKey","Tab","eventKey","theme","root","flexGrow","appBar","zIndex","drawer","menuButton","spacing","menu","StartChatButton","view","boxShadow","TopBar","screenSmall","showConv","CssBaseline","AppBar","IconButton","edge","renderas","ReactDOM","StrictMode","store","basename","fallback"],"mappings":"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","file":"static/js/main.809ccba4.chunk.js","sourcesContent":["import React from 'react';\r\nimport { Route, Redirect } from \"react-router-dom\";\r\nimport PropTypes from 'prop-types';\r\n\r\nconst GuardedRoute = ({ component: Component, auth, ...rest }) => (\r\n    <Route {...rest} render={(props) => (\r\n        auth === true\r\n            ? <Component {...props} />\r\n            : <Redirect to='/login' />\r\n    )} />\r\n)\r\n\r\nGuardedRoute.propTypes = {\r\n    component: PropTypes.object, \r\n    auth: PropTypes.bool,\r\n    rest: PropTypes.object\r\n}   \r\n\r\nexport default GuardedRoute;","import { createSlice } from '@reduxjs/toolkit';\r\nimport produce from 'immer'; \r\n\r\nexport const conversationsSlice = createSlice({\r\n  name: 'conversations',\r\n  initialState: {\r\n    conversations: [],\r\n    currentConversation: { messages: [], joined: false, typing: false, id: 0 },\r\n    defaultView: true,\r\n    showConvList: false\r\n  },\r\n  reducers: {\r\n    clearConversations: (state) => {\r\n        state.conversations = [];\r\n        state.currentConversation = { messages: [], joined: false, typing: false, id: 0 };\r\n        state.defaultView = true;\r\n        state.showConvList = false;\r\n    },\r\n    addConversation: (state, action) => {\r\n        if(state.conversations.filter(conv => conv.id === action.payload.conversation.id).length  > 0) {\r\n            console.log(\"Error: cannot add conversation because one already exists in store\");\r\n            return;\r\n        }\r\n        state.conversations.push(action.payload.conversation);\r\n    },\r\n    removeConversation: (state, action) => {\r\n        state.conversations = state.conversations.filter((conv) => { return conv.id !== action.payload.id});\r\n    },\r\n    setCurrentConversation: (state, action) => {\r\n        if(state.conversations.filter(conv => conv.id === action.payload.conversation.id).length < 1) {\r\n            console.log(\"Error: cannot set current conversation to a conversation that doesn't exist in the store\");\r\n            return;\r\n        }\r\n        state.currentConversation = action.payload.conversation;\r\n    },\r\n    addMessage: (state, action) => {\r\n        const convs = produce(state.conversations, () => {});\r\n        for(let conv of convs){\r\n            if(conv.id === action.payload.conversation.id){\r\n                if(!Array.isArray(conv.messages)){\r\n                    console.log(\"Messages don't exist yet\");\r\n                    conv.messages = [];\r\n                    conv.messages.push(action.payload.message);\r\n                    if(conv.numberOfMessages < conv.messages.length) {\r\n                        conv.numberOfMessages = conv.messages.length;\r\n                    }\r\n                    break; \r\n                }\r\n                if(conv.messages.filter(msg => msg.id === action.payload.message.id).length > 0) {\r\n                    console.log(\"Error: Cannot add message because it already exists in the state!\");\r\n                    break;\r\n                }\r\n                if(conv.id === state.currentConversation.id){\r\n                    if(!Array.isArray(state.currentConversation.messages) || !state.currentConversation.messages) {\r\n                        state.currentConversation.messages = []\r\n                    } \r\n                    state.currentConversation.messages.push(action.payload.message);\r\n                    if(state.currentConversation.numberOfMessages <  state.currentConversation.messages.length) {\r\n                        state.currentConversation.numberOfMessages =  state.currentConversation.messages.length;\r\n                    }\r\n                    break;\r\n                }\r\n                if(Array.isArray(conv.messages)){\r\n                    conv.messages.push(action.payload.message);\r\n                    if(conv.numberOfMessages < conv.messages.length) {\r\n                        conv.numberOfMessages = conv.messages.length;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        state.conversations = produce(convs, () => {});\r\n    },\r\n    removeMessage: (state, action) => {\r\n        const { conversationId, messageId } = action.payload;\r\n        if(state.currentConversation === conversationId) {\r\n            state.currentConversation.messages = state.currentConversation.messages.filter(msg => msg.id !== messageId);\r\n        } \r\n        for(let conv of state?.conversations) {\r\n            if(conv.id === conversationId){\r\n                conv.messages = conv.messages.filter(msg => msg.id !== messageId); \r\n            }\r\n        }\r\n    },\r\n    setJoined: (state, action) => {\r\n        state.currentConversation.joined = action.payload\r\n    },\r\n    setRead: (state, action) => {\r\n        const conv = state.conversations.filter(el => el.id === action.payload.convId)[0];\r\n        if(conv){\r\n            const message = conv.messages.filter(el => el.id === action.payload.messageId)[0];\r\n            if(message){\r\n                message.read = true;\r\n            }\r\n        }\r\n    },\r\n    setTyping: (state, action) => {\r\n        state.currentConversation.typing = action.payload\r\n    },\r\n    setView: (state, action) => {\r\n        state.defaultView = action.payload\r\n    },\r\n    setShowConvList: (state, action) => {\r\n        state.showConvList = action.payload\r\n    },\r\n    sortMessages: (state) => {\r\n        if(state.currentConversation.messages.length > 1) \r\n            state.currentConversation.messages.sort((a, b) =>  Date.parse(a.createdAt) - Date.parse(b.createdAt));\r\n    },\r\n    pinMessage: (state, action) => {\r\n        for(let conv of state.conversations) {\r\n            if(action.payload.conversation.id === conv.id) {\r\n                for(let msg of conv.messages) {\r\n                    if(msg.id === action.payload.id){\r\n                        msg.pinned = action.payload.pinned;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    batchAddMessages: (state, action) => {\r\n        const { messages, conversationId } = action.payload; \r\n        for(let message of messages) {\r\n            if(message.conversation.id === state.currentConversation.id && \r\n                state.currentConversation.id === conversationId) {\r\n                state.currentConversation.messages.push(message); \r\n                if(state.currentConversation.numberOfMessages <  state.currentConversation.messages.length) {\r\n                    state.currentConversation.numberOfMessages =  state.currentConversation.messages.length;\r\n                }\r\n            } \r\n        }\r\n    }\r\n  }\r\n});\r\n\r\nexport const { batchAddMessages, removeMessage, sortMessages, setShowConvList, clearConversations, setView, setTyping, setRead, setJoined, addMessage, setCurrentConversation, addConversation, removeConversation, pinMessage } = conversationsSlice.actions;\r\n\r\nexport const selectConversations = state => state.conversations.conversations;\r\nexport const selectCurrentConversation = state => state.conversations.currentConversation;\r\nexport const selectJoined = state => state.conversations.currentConversation.joined;\r\nexport const selectTyping = state => state.conversations.currentConversation.typing;\r\nexport const selectView = state => state.conversations.defaultView;\r\nexport const selectShowConvList = state => state.conversations.showConvList;\r\n\r\nexport default conversationsSlice.reducer;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\n\r\nexport const accountSlice = createSlice({\r\n  name: 'account',\r\n  initialState: {\r\n    email: \"\",\r\n    tagName: \"\",\r\n    loggedIn: false,\r\n    id: \"\"\r\n  },\r\n  reducers: {\r\n    clearAccount: (state) => {\r\n      state.email = \"\";\r\n      state.tagName = \"\";\r\n      state.loggedIn = false;\r\n      state.id = \"\";\r\n    },\r\n    setEmail: (state, action) => {\r\n        state.email = action.payload\r\n    },\r\n    setTagName: (state, action) => {\r\n        state.tagName = action.payload\r\n    },\r\n    login: state => {\r\n        state.loggedIn = true\r\n    },\r\n    logout: state => {\r\n        state.loggedIn = false\r\n    },\r\n    setId: (state, action) => {\r\n        state.id = action.payload\r\n    }\r\n  },\r\n});\r\n\r\nexport const { clearAccount, setId, setEmail, setTagName, login, logout } = accountSlice.actions;\r\n\r\nexport const selectAccount = state => {\r\n  return {\r\n    id: state.account.id,\r\n    email: state.account.email,\r\n    tagName: state.account.tagName,\r\n    loggedIn: state.account.loggedIn\r\n   }\r\n};\r\n\r\nexport default accountSlice.reducer;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\n\r\nexport const inviteSlice = createSlice({\r\n  name: 'invite',\r\n  initialState: {\r\n    sentInvites: [],\r\n    receivedInvites: [],\r\n    acceptedInvites: []\r\n  },\r\n  reducers: {\r\n    clearInvites: (state) => {\r\n        state.sentInvites = []\r\n        state.receivedInvites = []\r\n        state.acceptedInvites = []\r\n    },\r\n    addSentInvite: (state, action) => {\r\n        state.sentInvites.push(action.payload)\r\n    },\r\n    addReceivedInvite: (state, action) => {\r\n        state.receivedInvites.push(action.payload)\r\n    },\r\n    removeSentInvite: (state, action) => {\r\n        state.sentInvites = state.sentInvites.filter(el => el.id !== action.payload)\r\n    },\r\n    removeReceivedInvite: (state, action) => {\r\n        state.receivedInvites = state.receivedInvites.filter(el => el.id !== action.payload)\r\n    },\r\n    addAcceptedInvite: (state, action) => {\r\n        state.acceptedInvites.push(action.payload)\r\n    }\r\n  },\r\n});\r\n\r\nexport const { clearInvites, addSentInvite, addReceivedInvite, removeSentInvite, removeReceivedInvite, addAcceptedInvite } = inviteSlice.actions;\r\n\r\n// // The function below is called a thunk and allows us to perform async logic. It\r\n// // can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This\r\n// // will call the thunk with the `dispatch` function as the first argument. Async\r\n// // code can then be executed and other actions can be dispatched\r\n// export const incrementAsync = amount => dispatch => {\r\n//   setTimeout(() => {\r\n//     dispatch(incrementByAmount(amount));\r\n//   }, 1000);\r\n// };\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice file. For example: `useSelector((state) => state.counter.value)`\r\nexport const selectSent = state => state.invite.sentInvites;\r\nexport const selectReceived = state => state.invite.receivedInvites;\r\nexport const acceptedInvites = state => state.invite.acceptedInvites;\r\n\r\nexport default inviteSlice.reducer;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\n\r\nexport const friendsSlice = createSlice({\r\n  name: 'friends',\r\n  initialState: {\r\n    friends: [],\r\n    friendRequests: []\r\n  },\r\n  reducers: {\r\n    clearFriends: (state) => {\r\n       state.friendRequests = []\r\n       state.friends = []\r\n    },\r\n    addFriend: (state, action) => {\r\n        if(state.friends.filter(friend => friend.id === action.payload.id || friend.tagName === action.payload.tagName).length > 0){\r\n            return;\r\n        }\r\n        if(action.payload.password) delete action.payload.password;  \r\n        state.friends = [...state.friends, action.payload]\r\n    },\r\n    removeFriend: (state, action) => {\r\n        state.friends = state.friends.filter(el => el.id !== action.payload)\r\n    },\r\n    addFriendRequest: (state, action) => {\r\n        if(state.friendRequests.filter(req => req.id === action.payload.id).length > 0){\r\n          return;\r\n        }\r\n        state.friendRequests = [...state.friendRequests, action.payload]\r\n    },\r\n    removeFriendRequest: (state, action) => {\r\n        state.friendRequests = state.friendRequests.filter(el => el.id !== action.payload)\r\n    },\r\n    declineRequest: (state, action) => {\r\n      const request = state.friendRequests.filter(el => el.id === action.payload)[0];\r\n      if(request)\r\n        request.cancelled = true;\r\n    },\r\n    acceptRequest: (state, action) => {\r\n      const request = state.friendRequests.filter(el => el.id === action.payload)[0];\r\n      if(request)\r\n        request.accepted = true;\r\n    }\r\n  }\r\n});\r\n\r\nexport const { clearFriends, addFriend, removeFriend, addFriendRequest, removeFriendRequest, declineRequest, acceptRequest } = friendsSlice.actions;\r\n\r\n// // The function below is called a thunk and allows us to perform async logic. It\r\n// // can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This\r\n// // will call the thunk with the `dispatch` function as the first argument. Async\r\n// // code can then be executed and other actions can be dispatched\r\n// export const incrementAsync = amount => dispatch => {\r\n//   setTimeout(() => {\r\n//     dispatch(incrementByAmount(amount));\r\n//   }, 1000);\r\n// };\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice file. For example: `useSelector((state) => state.counter.value)`\r\nexport const selectFriends = state => state.friends.friends;\r\n\r\nexport const selectFriendRequests = state => state.friends.friendRequests;\r\n\r\nexport default friendsSlice.reducer;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\n\r\nexport const sidebarStates = {\r\n    hidden: \"hidden\",\r\n    show: \"show\",\r\n    full: \"full\"\r\n}\r\n\r\n// export const backgroundColors = {\r\n//     black: \"#191919\",\r\n//     red: \"\",\r\n//     blue: \"\",\r\n//     green: \"\",\r\n//     purple: \"\",\r\n//     gray: \"\",\r\n// }\r\n\r\n// export const filters = {\r\n//     red: \"\",\r\n//     blue: \"\",\r\n//     green: \"\",\r\n//     purple: \"\",\r\n//     gray: \"\",\r\n//     clear: \"\",\r\n//     opaque: \"\"\r\n// }\r\n\r\n// export const defaultAccountBackgroundURL = {\r\n//     mthood: \"\",\r\n//     mtsthelens: \"\",\r\n//     mtadams: \"\",\r\n//     mtrainier: \"\",\r\n//     mtbaker: \"\"\r\n// }\r\n\r\nexport const uiSlice = createSlice({\r\n  name: 'ui',\r\n  initialState: {\r\n    sidebarState: \"hidden\",\r\n    topbarMessage: \"\",\r\n    accountBackground: \"\",\r\n    backgroundColor: \"#191919\",\r\n    backgroundTint: \"transparent\",\r\n    conversationBackground: \"mthood\"\r\n  },\r\n  reducers: {\r\n    setSidebarState: (state, action) => {\r\n        switch(action.payload){\r\n            case action.payload === sidebarStates.hidden && state.sidebarState !== sidebarStates.hidden:\r\n                state.sidebarState = sidebarStates.hidden;\r\n                break ;\r\n            case action.payload === sidebarStates.show && state.sidebarState !== sidebarStates.show:\r\n                state.sidebarState = sidebarStates.show;\r\n                break ;\r\n            case action.payload === sidebarStates.full && state.sidebarState !== sidebarStates.full:\r\n                state.sidebarState = sidebarStates.full;\r\n                break ;\r\n            default: state.sidebarState = sidebarStates.show; break;\r\n        }\r\n    }, \r\n    setTopbarMessage: (state, action) => {\r\n        state.topbarMessage = action.payload;\r\n    },  \r\n    setDefaultBackground: (state, action) => {\r\n        state.defaultBackground = action.payload;\r\n    },  \r\n    setColor: (state, action) => {\r\n        state.backgroundColor = action.payload;\r\n    }, \r\n    setTint: (state, action) => {\r\n        state.backgroundTint = action.payload;\r\n    }, \r\n    setConversationBackground: (state, action) => {\r\n        state.conversationBackground = action.payload;\r\n    }   \r\n  }\r\n});\r\n\r\nexport const { setSidebarState, setTopbarMessage, setDefaultBackground, setColor, setTint, setConversationBackground } = uiSlice.actions;\r\n\r\nexport const selectSidebarState = state => state.ui.sidebarState;\r\nexport const selectTopbarMessage = state => state.ui.topbarMessage;\r\nexport const selectAccountBackground = state => state.ui.accountBackground;\r\nexport const selectBackgroundColor = state => state.ui.backgroundColor;\r\nexport const selectBackgroundTint = state => state.ui.backgroundTint;\r\nexport const selectConversationBackground = state => state.ui.conversationBackground;\r\n\r\nexport default uiSlice.reducer;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\n\r\nexport const authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState: {\r\n    username: \"\",\r\n    token: \"\"\r\n  },\r\n  reducers: {\r\n    setUserName: (state, action) => {\r\n      state.username = action.payload;\r\n    },\r\n    setToken: (state, action) => {\r\n        state.token = action.payload;\r\n    },\r\n    clearAuth: (state) => {\r\n      state.username = \"\"\r\n      state.token = \"\"\r\n    }\r\n  }\r\n});\r\n\r\nexport const { clearAuth, setUserName, setToken } = authSlice.actions;\r\n\r\nexport const selectUserName = state => state.auth.username;\r\nexport const selectToken = state => state.auth.token;\r\n\r\nexport default authSlice.reducer;\r\n","import { configureStore } from '@reduxjs/toolkit';\r\nimport { createSlice } from '@reduxjs/toolkit';\r\nimport uiReducer from './slices/uiSlice';\r\nimport authReducer from './slices/authSlice';\r\nimport conversationsReducer from './slices/conversationsSlice';\r\nimport accountReducer from './slices/accountSettingsSlice';\r\nimport friendsReducer from './slices/friendsSlice';\r\nimport inviteReducer from './slices/inviteSlice';\r\n\r\nexport const globalSlice = createSlice({\r\n  name: 'globals',\r\n  initialState: {\r\n    devHost: \"http://localhost:3000\",\r\n    prodHost: \"http://localhost:3000\", //will add custom host soon\r\n    testHost: \"http://localhost:3000\",\r\n    metadata: \"\",\r\n    api: \"http://localhost:3000\",\r\n    refreshExpire: -1,\r\n  },\r\n  reducers: {\r\n    setMetadata: (state, action) => {\r\n      state.metadata = action.payload;\r\n    },\r\n    setRefreshExpire: (state, action) => {\r\n      state.refreshExpire = action.payload;\r\n    }\r\n  },\r\n});\r\n\r\nexport const { setMetadata, setRefreshExpire } = globalSlice.actions;\r\n\r\nexport const selectHost = state => {\r\n    if (process.env.NODE_ENV === \"production\") {\r\n      return state.globals.prodHost; \r\n    } \r\n    else if (process.env.NODE_ENV === \"development\") {\r\n      return state.globals.devHost; \r\n    } \r\n    else if (process.env.NODE_ENV === \"test\") {\r\n      return state.globals.testHost;\r\n    } else {\r\n      return state.globals.devHost;\r\n    }\r\n};\r\n\r\nexport const selectApi = state => {\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    return state.globals.prodHost; \r\n  } \r\n  else if (process.env.NODE_ENV === \"development\") {\r\n    return state.globals.api; \r\n  } \r\n  else if (process.env.NODE_ENV === \"test\") {\r\n    return state.globals.api;\r\n  } else {\r\n    return state.globals.api;\r\n  }\r\n}\r\n\r\nexport const selectRefreshExpire = state => {\r\n  return state.globals.refreshExpire;\r\n}\r\n\r\nexport const reducer = globalSlice.reducer;\r\n\r\nexport default configureStore({\r\n  reducer: {\r\n    auth: authReducer,\r\n    conversations: conversationsReducer,\r\n    account: accountReducer,\r\n    invite: inviteReducer,\r\n    friends: friendsReducer,\r\n    globals: reducer,\r\n    ui: uiReducer\r\n  },\r\n});","export default {\r\n    tagNameSearch: /^([a-zA-Z0-9_-]){1,20}$/,\r\n    tagName: /^([a-zA-Z0-9_-]){8,20}$/,\r\n    password: /^([a-zA-Z0-9\\_\\-\\$\\#\\%\\^\\&\\*\\(\\)]){8,32}$/,\r\n    email: /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/,\r\n    firstName: /^([A-Z]){1}([a-zA-Z]){1,32}$/,\r\n    lastName: /^([A-Z]){1}([a-zA-Z]){1,32}$/,\r\n    messageBody: /^(.){1,200}$/,\r\n    conversationName: /^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]){4,64}$/\r\n};","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { Button, InputGroup, Spinner, FormControl, Container, Row, Col } from 'react-bootstrap'\r\nimport { Redirect, Link } from 'react-router-dom';\r\nimport {\r\n  addConversation\r\n} from '../../store/slices/conversationsSlice'\r\nimport {\r\n  setId,\r\n  setEmail,\r\n  setTagName,\r\n  login, \r\n  selectAccount\r\n} from '../../store/slices/accountSettingsSlice'\r\nimport {\r\n  addAcceptedInvite,\r\n  addReceivedInvite\r\n} from '../../store/slices/inviteSlice'\r\nimport { addFriend, \r\n  addFriendRequest \r\n} from '../../store/slices/friendsSlice';\r\nimport {\r\n  setTopbarMessage\r\n} from '../../store/slices/uiSlice';\r\nimport {\r\n  setRefreshExpire\r\n} from '../../store/store';\r\nimport regex from '../../util/regex';\r\nimport './loginscreen.css';\r\n\r\nconst loginServer = async (username, password) => {\r\n  try {\r\n    const response = await fetch(\"http://localhost:3000/api/auth/login\", {\r\n      body: JSON.stringify({\r\n        tagName: `${username}`,\r\n        password: `${password}`\r\n      }),\r\n      headers: { \"content-type\": \"application/json\",\r\n    },\r\n      method: \"POST\"\r\n    });\r\n    const body = await response.json();\r\n    const { statusCode, id, user, invites, refreshToken } = body; \r\n    if(statusCode === 401 || statusCode === 400){\r\n        console.log(\"Error: Unauthorized, invalid credentials\");\r\n        return false;\r\n    }\r\n    if(statusCode === 500){\r\n        console.log(\"Error: Server error while attempting login!\")\r\n        return false;\r\n    }\r\n    if(refreshToken === true) {\r\n       console.log(\"Refresh token successfully set and will timeout in 15 mins or \" + Date.now() + 900000);\r\n    }\r\n    console.log(\"Successfully logging in user\", user.tagName); \r\n    return { user, id, invites, refreshToken };\r\n  } catch(err) {\r\n    console.log(\"Error: Unable to login. Please refresh.\", err);\r\n    return false;\r\n  }\r\n}\r\n\r\nconst validateAccountDetails = (id, user, invites) => {\r\n  if(!id || \r\n      !user || \r\n      !user?.email || \r\n      !user?.tagName ||  \r\n      !Array.isArray(user?.conversations) ||  \r\n      !Array.isArray(user?.friends) || \r\n      !Array.isArray(user?.friendRequests) || \r\n      !Array.isArray(invites))\r\n      {\r\n        return false \r\n      }\r\n    else return true\r\n}\r\n\r\nfunction LoginScreen() {\r\n  const [userName, _setUserName] = useState(\"\");\r\n  const [password, _setPassword] = useState(\"\");\r\n  const [allowLogin, setAllowLogin] = useState(false);\r\n  const [error, setError] = useState(false);\r\n  const [errorMsgs, setErrorMsgs] = useState([]);\r\n  const dispatch = useDispatch();\r\n  const account = useSelector(selectAccount);\r\n  const [spinning, setSpinning] = useState(false);\r\n  const [loggingInCookie, setLoggingInCookie] = useState(false); \r\n  const focusRef = useRef(null);\r\n  useEffect(() => {\r\n    if(focusRef.current) {\r\n      focusRef.current.focus();\r\n    }\r\n  }, []);\r\n\r\n  useEffect(async () => {\r\n    try {\r\n      if(loggingInCookie === false){\r\n        setLoggingInCookie(true);\r\n        const refreshResult = await fetch(\"http://localhost:3000/api/auth/refreshAccount\", {\r\n          credentials: \"include\"\r\n        });\r\n        if(refreshResult) {\r\n          const res = await refreshResult.json();\r\n          if(res?.statusCode === 401){\r\n           // console.log(res);\r\n            console.log(\"No valid refresh token. User must login\");\r\n            setAllowLogin(true);\r\n            setSpinning(false); \r\n            setLoggingInCookie(false);\r\n          } \r\n          const  { id, user, invites, refreshToken } = res;\r\n          if(refreshToken === true) dispatch(setRefreshExpire(Date.now() + 875000)); \r\n          if(false === validateAccountDetails(id, user, invites)){\r\n            setSpinning(false); \r\n            setLoggingInCookie(false);\r\n            return;\r\n          }\r\n          addAccountToStore({ user: user, invites: invites });\r\n          dispatch(login());\r\n          console.log(\"Successfully logged in user \" + user?.tagName);\r\n          setSpinning(false);\r\n          setLoggingInCookie(false);\r\n       }\r\n      }\r\n    } catch(err) {\r\n      console.log(\"No valid refresh token. User must login\", err);\r\n      setAllowLogin(true); \r\n    }  \r\n  }, [])\r\n\r\n  const checkInput = () => {\r\n    let passing = true;\r\n    if(regex.tagName.test(userName) === false){\r\n      setErrorMsgs([\"Tag name must be 8-24 characters\", ...errorMsgs]);\r\n      passing = false;\r\n    }\r\n    if(regex.password.test(password) === false){\r\n      setErrorMsgs([\"Password must be 8-32 characters\", ...errorMsgs]);\r\n      passing = false;\r\n    }\r\n    if(!passing) setError(true);\r\n    return passing;\r\n  };\r\n\r\n  useEffect(() => {\r\n      dispatch(setTopbarMessage(\"\"));\r\n  }, []);\r\n\r\n  const submit = async () => {\r\n    setError(false);\r\n    setErrorMsgs([]);\r\n    setSpinning(true);\r\n    if(!checkInput()){\r\n      console.log(\"Invalid form field inputs\", errorMsgs);\r\n      setSpinning(false);\r\n      return;\r\n    }\r\n    const result = await loginServer(userName, password);\r\n    if(result === false) {\r\n        setError(true);\r\n        setSpinning(false);\r\n        setErrorMsgs([\"Invalid Credentials\", ...errorMsgs]);\r\n        return;\r\n    }\r\n    const  { id, user, invites, refreshToken } = result;\r\n    if(refreshToken === true) dispatch(setRefreshExpire(Date.now() + 875000)); \r\n    if(false === validateAccountDetails(id, user, invites)){\r\n          setError(true);\r\n          setSpinning(false);\r\n          setErrorMsgs([\"Invalid Credentials\", ...errorMsgs]);\r\n          return;\r\n    }\r\n    addAccountToStore({ user: user, invites: invites });\r\n    dispatch(login());\r\n    console.log(\"Successfully logged in user \" + user?.tagName);\r\n    setSpinning(false);\r\n  }\r\n\r\n  const addAccountToStore = ({ user, invites }) => {\r\n    dispatch(setEmail(user?.email));\r\n    dispatch(setTagName(user?.tagName));\r\n    dispatch(setId(user?.id));\r\n    user.conversations.map(conv => {\r\n        if(conv.pending !== true){\r\n          dispatch(addConversation({ conversation: conv }));\r\n        }\r\n    });\r\n    user.friends.map(friend => {\r\n      dispatch(addFriend(friend));\r\n    }); \r\n    if(user.friendRequests && Array.isArray(user?.friendRequests)){   \r\n      for(let request of user?.friendRequests){\r\n        if(request?.recipientId === user?.id){   \r\n          dispatch(addFriendRequest(request))\r\n        } \r\n      }\r\n    }\r\n    if(invites && Array.isArray(invites)){\r\n      for(let invite of invites){\r\n        if(invite?.accepted === true)\r\n          dispatch(addAcceptedInvite(invite));\r\n        else  \r\n          dispatch(addReceivedInvite(invite));\r\n      }\r\n    }\r\n  }\r\n  return (\r\n    (!account?.loggedIn) ? (\r\n    <Container className=\"h-100 w-100\" fluid>\r\n      <Row className=\"p-3 mt-5 text-white lead text-center\">\r\n        <Col className=\"p-3 text-center, mx-auto pt-5 mt-5 shadow\" style={{ borderRadius: \"15px\", backgroundColor: \"#191919\", opacity: 0.6, maxWidth: \"500px\"}}> \r\n          <h2 className=\"text-white\" style={{ opacity: 0.8, marginBottom: \"35px\" }} >Welcome to <span className=\"text-danger\">Project Zed</span></h2>\r\n          <h6 className=\"text-muted font-italic\" style={{ marginBottom: \"35px\"  }}>Secured by you, for you</h6>\r\n            {\r\n              (loggingInCookie) \r\n                ? (\r\n                  <Container fluid className=\"text-center\">\r\n                     <Row className=\"text-center pb-2\"><Col className=\"text-center\"><h6>Welcome Back!</h6></Col></Row>\r\n                     <Row className=\"text-center pb-2\"><Col className=\"text-center\"><span className=\"text-muted\">Logging Back In!</span></Col></Row>\r\n                     <Row className=\"text-center pt-4 pb-2\"><Col><Spinner animation=\"border\" className=\"mb-4\" style={{ height: 100, width: 100 }} variant=\"success\" /></Col></Row>\r\n                  </Container>)\r\n                : (\r\n                    <div>\r\n                      <InputGroup className=\"mb-5 mt-3\">\r\n                        <FormControl\r\n                          style={{marginLeft: \"auto\", marginRight: \"auto\", color: \"white\", opacity: 0.87, maxWidth: '400px', minHeight: '50px', border: 'none', backgroundColor: \"#404040\" }}\r\n                          placeholder=\"@Tagname\"\r\n                          aria-label=\"@Tagname\"\r\n                          aria-describedby=\"basic-addon1\"\r\n                          onKeyPress={\r\n                            async (e) => {\r\n                                if(e.key === \"Enter\") {\r\n                                    await submit()\r\n                                }\r\n                            }\r\n                        }\r\n                          onChange={ e => _setUserName(e.target.value) }\r\n                          ref={focusRef}\r\n                        />\r\n                      </InputGroup>\r\n                      <InputGroup className=\"mb-5\">\r\n                        <FormControl\r\n                          style={{marginLeft: \"auto\", marginRight: \"auto\", color: \"white\", opacity: 0.87, maxWidth: '400px', minHeight: '50px',border: 'none',  backgroundColor: \"#404040\" }}\r\n                          type=\"password\"\r\n                          placeholder=\"Password\"\r\n                          aria-label=\"Password\"\r\n                          aria-describedby=\"basic-addon1\"\r\n                          onKeyPress={\r\n                              async (e) => {\r\n                                  if(e.key === \"Enter\") {\r\n                                      await submit()\r\n                                  }\r\n                              }\r\n                          }\r\n                          onChange={ e => _setPassword(e.target.value) }\r\n                        />\r\n                      </InputGroup>\r\n                      <Container fluid className=\"border-top border-dark pt-2\">   \r\n                        <Row className=\"mt-3\">\r\n                          <Col>               \r\n                            <Button style={{ marginRight: 30, backgroundColor: \"#191919\", color: \"white\", opacity: 0.87, border:\"none\"}} variant=\"dark\" className=\"mx-auto button-outline-black\" onClick={() => document.getElementById(\"link-create-account\").click() }><Link id=\"link-create-account\" style={{ textDecoration: 'none', color: \"white\" }} to=\"/createAccount\">Create&nbsp;Account</Link></Button>\r\n                          </Col>\r\n                        </Row>\r\n                        <Row className=\"mt-3\">\r\n                          <Col>\r\n                              <Button style={{ color: \"white\", backgroundColor: \"#191919\", opacity: 0.87, border:\"none\"}} variant=\"dark\" className=\"mx-auto button-outline-black \" onClick={() => document.getElementById(\"link-forgot-password\").click() }><Link id=\"link-forgot-password\" style={{ textDecoration: 'none', color: \"white\" }} to=\"/forgotPassword\">Forgot&nbsp;Password?</Link></Button>\r\n                          </Col>\r\n                        </Row>\r\n                        <Row className=\"mt-3 mb-2\">\r\n                          <Col>\r\n                            {\r\n                              (spinning) ?  <Spinner animation=\"border\" className=\"mb-4\" style={{ height: 60, width: 60 }} variant=\"success\" /> : <Button onClick={submit} size=\"lg\" className=\"rounded-pill mb-4 mx-auto\" variant=\"outline-success\" style={{ opacity: 0.8, maxWidth: '200px', marginTop: \"20px\" }} block disabled={!allowLogin}>Login</Button>\r\n                            }\r\n                          </Col>\r\n                        </Row>\r\n                        <Row className=\"mt-3 mb-3\">\r\n                          { \r\n                            (error) ? (<Col className=\"text-center\">\r\n                                        <ul>\r\n                                          {\r\n                                            errorMsgs.map(err => <li key={err} className=\"text-danger text-center lead font-italic\">{err}</li>)\r\n                                          }\r\n                                        </ul>\r\n                                      </Col>)\r\n                                    : \"\"\r\n                            }\r\n                            { \r\n                              (spinning) ? (<Col className=\"text-center\">\r\n                                              <span className=\"text-success lead font-italic font-weight-bolder\" style={{ opacity: 1.0, fontSize: \"15pt\" }}>Logging in...</span>\r\n                                            </Col>)\r\n                                          : \"\"\r\n                            }\r\n                          </Row>\r\n                      </Container>\r\n                    </div>\r\n                  )\r\n              }\r\n        </Col> \r\n      </Row>\r\n    </Container>)\r\n    : <Redirect to=\"/home\"></Redirect>\r\n  );\r\n}\r\n\r\nexport default LoginScreen;\r\n","import React from 'react';\r\nimport LoginScreen from '../components/loginScreen/loginScreen';\r\nimport './animations.css';\r\n\r\nexport default function LoginComponent(){\r\n   return (<div key=\"login-screen-div\" className=\"w-100 h-100\">\r\n            <LoginScreen></LoginScreen>\r\n         </div>)               \r\n}\r\n\r\n\r\n","import React, { useState, useEffect } from 'react'\r\nimport {  Button, InputGroup, FormControl, Container, Row, Col } from 'react-bootstrap';\r\nimport { useDispatch } from 'react-redux';\r\nimport regex from '../../util/regex';\r\nimport { setTopbarMessage } from '../../store/slices/uiSlice';\r\nimport './createaccount.css';\r\nexport default function ForgotPassword(){\r\n    const [email, setEmail] = useState(\"\");\r\n    const [tagname, setTagname] = useState(\"\");\r\n    const [error, setError] = useState(false);\r\n    const [errorMsgs, setErrorMsgs] = useState([]);\r\n    const [emailInvalid, setEmailInvalid] = useState(false);\r\n    const [tagnameInvalid, setTagnameInvalid] = useState(false);\r\n    const dispatch = useDispatch();\r\n\r\n    const clearErr = () => {\r\n      setEmailInvalid(false);\r\n      setTagnameInvalid(false);\r\n    }\r\n    const checkInput = () => {\r\n      let passing = true;\r\n      const arr = [];\r\n      if(regex.email.test(email) === false){\r\n          arr.push(\"Invalid Email Address!\");\r\n          setEmailInvalid(true);\r\n          passing = false;\r\n      }\r\n      if(regex.tagName.test(tagname) === false){\r\n          arr.push(\"Tag name must be 8-24 characters\");\r\n          setTagnameInvalid(true);\r\n          passing = false;\r\n      }\r\n      if(!passing) {\r\n        setErrorMsgs(arr);\r\n        setError(true);\r\n      }\r\n      return passing;\r\n    }\r\n    const submit = () => {\r\n      clearErr();\r\n      setErrorMsgs([]);\r\n      setError(false);\r\n      if(!checkInput()){\r\n        console.log(\"Error with data submission: \", errorMsgs)\r\n        return;\r\n      }\r\n      console.log(`Sending forgot password request for user @${tagname} with email ${email}`);\r\n    }\r\n\r\n    useEffect(() => {\r\n      dispatch(setTopbarMessage(\"\"))\r\n    }, []);\r\n\r\n    return (\r\n            <Container className=\"h-100 w-100 pb-5\" fluid>\r\n              <Row className=\"p-3 mt-5 text-white lead text-center\">\r\n                  <Col className=\"p-3 text-center, mx-auto pt-5 mt-5 shadow\" style={{ borderRadius: \"15px\", backgroundColor: \"#191919\", opacity: 0.6, maxWidth: \"500px\"}}> \r\n                      <h4 className=\"text-white\" style={{ opacity: 0.8, marginBottom: \"35px\" }}>Forgotten Password</h4>\r\n                        <InputGroup className=\"mb-5 mt-3\">                      \r\n                          <FormControl\r\n                            style={{ marginLeft: \"auto\", marginRight: \"auto\", color: \"white\", opacity: 0.87, maxWidth: '400px', minHeight: '50px',border: 'none',  backgroundColor: \"#404040\" }}\r\n                            placeholder=\"Enter Your Tagname\"\r\n                            aria-label=\"Enter Your Tagname\"\r\n                            aria-describedby=\"basic-addon1\"\r\n                            className={(tagnameInvalid) ? \"form-control-error\" : \"form-control-normal\"}\r\n                            onChange={ e => { setTagname(e.target.value) }  }\r\n                          />\r\n                        </InputGroup>\r\n                        <InputGroup className=\"mb-5 mt-3\">\r\n                        <FormControl\r\n                          style={{ marginLeft: \"auto\", marginRight: \"auto\", color: \"white\", opacity: 0.87, maxWidth: '400px', minHeight: '50px',border: 'none',  backgroundColor: \"#404040\" }}\r\n                          placeholder=\"Enter Your Email\"\r\n                          aria-label=\"Enter Your Email\"\r\n                          aria-describedby=\"basic-addon1\"\r\n                          className={(emailInvalid) ? \"form-control-error\" : \"form-control-normal\"}\r\n                          onChange={ e => setEmail(e.target.value) }\r\n                        />\r\n                      </InputGroup>\r\n                      <Button onClick={submit} size=\"lg\" className=\"rounded-pill mb-4 mx-auto\" variant=\"outline-success\" style={{ opacity: 0.8, maxWidth: '200px' }} block>Reset Password</Button>\r\n                      <Container fluid style={{ opacity: 1.2 }}>\r\n                        <Row>\r\n                          <Col className=\"mx-auto text-left\">\r\n                            <ul style={{ listStyleType: \"none\", marginRight: \"auto\", marginLeft: \"auto\", paddingRight: \"30px\" }}>\r\n                              {(error) ?  <li><h6 className=\"border-bottom pb-2 border-danger text-danger font-weight-bold\">Errors</h6></li> : \"\"}\r\n                              {\r\n                                (error) ? errorMsgs.map(el => (<li key={el} className=\"font-italic lead text-danger\">{el}</li>)) : \"\"\r\n                              }   \r\n                            </ul>    \r\n                          </Col>\r\n                        </Row>  \r\n                      </Container>\r\n                  </Col> \r\n              </Row>\r\n          </Container>\r\n      );  \r\n}","import React from 'react';\r\nimport ForgotPassword from '../components/loginScreen/ForgotPassword';\r\n\r\nexport default function ForgotPW() {\r\n    return (  \r\n      <div className=\"w-100 h-100\">\r\n        <ForgotPassword></ForgotPassword>\r\n      </div>\r\n    )\r\n  }","import React, { useState, useEffect } from 'react';\r\nimport { Button, InputGroup, FormControl, Container, Row, Col } from 'react-bootstrap';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport { setTopbarMessage } from '../../store/slices/uiSlice';\r\nimport './createaccount.css';\r\nimport regex from '../../util/regex';\r\n\r\nfunction CreateAccount(){\r\n    const [tagName, setTagName] = useState(\"\");\r\n    const [email, setEmail] = useState(\"\");\r\n    const [pw1, setPW1] = useState(\"\");\r\n    const [pw2, setPW2] = useState(\"\");\r\n    const [backToLogin, setBackToLogin] = useState(false);\r\n    const [error, setError] = useState(false);\r\n    const [errorMsgs, setErrorMsgs] = useState([]);\r\n    const [passwordNoMatch, setPasswordNoMatch] = useState(false);\r\n    const [tagnameInvalid, setTagnameInvalid] = useState(false);\r\n    const [emailInvalid, setEmailInvalid] = useState(false);\r\n    const [pw1Invalid, setPw1Invalid] = useState(false);\r\n    const [pw2Invalid, setPw2Invalid] = useState(false);\r\n    const dispatch = useDispatch();\r\n\r\n    const clearErr = () => {\r\n        setPasswordNoMatch(false);\r\n        setTagnameInvalid(false);\r\n        setEmailInvalid(false);\r\n        setPw1Invalid(false);\r\n        setPw2Invalid(false);\r\n    }\r\n    const checkInput = () => {\r\n        let passing = true;\r\n        const arr = []\r\n        if(pw1 !== pw2){\r\n            arr.push(\"Passwords don't match\")\r\n            setPasswordNoMatch(true);\r\n            passing = false;\r\n        }\r\n        if(regex.tagName.test(tagName) === false){\r\n            arr.push(\"Invalid Tagname\");\r\n            setTagnameInvalid(true);\r\n            passing = false;\r\n        }\r\n        if(regex.email.test(email) === false){\r\n            arr.push(\"Invalid Email\")\r\n            setEmailInvalid(true);\r\n            passing = false;\r\n        }\r\n        if(regex.password.test(pw1) === false){\r\n            arr.push(\"Invalid Password. Must be 10-32 characters and digits.\")\r\n            setPw1Invalid(true);\r\n            passing = false;\r\n        }\r\n        if(regex.password.test(pw2) === false){\r\n            arr.push(\"Invalid Second Password. Must be 10-32 characters and digits.\")\r\n            setErrorMsgs(arr);\r\n            setPw1Invalid(true);\r\n            passing = false;\r\n        }\r\n        if(!passing) {\r\n            setError(true);\r\n            setErrorMsgs(arr);\r\n        }\r\n        return passing;\r\n    }\r\n    const submit = async () => {\r\n        setError(false);\r\n        clearErr();\r\n        if(!checkInput()){\r\n            console.log(\"Error with data submission: \", errorMsgs)\r\n            return;\r\n        }\r\n        const bd = {\r\n            email: email,\r\n            password: pw1,\r\n            session: 0,\r\n            tagName: tagName\r\n        }\r\n        const res = await fetch(\"http://localhost:3000/api/users/\", {\r\n            method: \"POST\",\r\n            headers: { 'content-type': 'application/json' },\r\n            body: JSON.stringify(bd)\r\n        })\r\n        const body = await res.json();\r\n        console.log(body);\r\n        setBackToLogin(true);\r\n    }\r\n\r\n    useEffect(() => {\r\n        dispatch(setTopbarMessage(\"\"))\r\n    }, []);\r\n\r\n    return (\r\n        (!backToLogin) ? \r\n        <Container className=\"h-100 w-100\" fluid>\r\n            <Row className=\"p-3 mt-5 text-white lead text-center\">\r\n                <Col className=\"p-3 text-center, mx-auto pt-5 mt-5 shadow\" style={{ borderRadius: \"15px\", backgroundColor: \"#191919\", opacity: 0.6, maxWidth: \"500px\" }}> \r\n                    <h4 className=\"text-white\" style={{ opacity: 0.8, marginBottom: \"55px\" }}>Enter your account information</h4>\r\n                    <InputGroup className=\"mb-5 mt-3\">\r\n                        <FormControl\r\n                            style={{ marginLeft: \"auto\", marginRight: \"auto\", color: \"white\", opacity: 0.87, maxWidth: '400px', minHeight: '50px',border: 'none',  backgroundColor: \"#404040\" }}\r\n                            placeholder=\"Email Address\"\r\n                            aria-label=\"Email Address\"\r\n                            aria-describedby=\"basic-addon1\"\r\n                            onChange={ (e) => setEmail(e.target.value) }\r\n                            className={(emailInvalid) ? \"form-control-error\" : \"form-control-normal\"}\r\n                        />\r\n                    </InputGroup>\r\n                    <InputGroup  className=\"mb-5 mt-3\">\r\n                        <FormControl\r\n                            style={{ marginLeft: \"auto\", marginRight: \"auto\", color:  \"white\", opacity: 0.87, maxWidth: '400px', minHeight: '50px',border: 'none',  backgroundColor: \"#404040\" }}\r\n                            placeholder=\"Desired Tag Name\"\r\n                            aria-label=\"Desired Tag Name\"\r\n                            aria-describedby=\"basic-addon1\"\r\n                            onChange={ (e) => setTagName(e.target.value) }\r\n                            className={(tagnameInvalid) ? \"form-control-error\" : \"form-control-normal\"}\r\n                        />\r\n                    </InputGroup>\r\n                    <InputGroup className=\"mb-5 mt-3\">\r\n                        <FormControl\r\n                            style={{ marginLeft: \"auto\", marginRight: \"auto\", color: \"white\", opacity: 0.87, maxWidth: '400px', minHeight: '50px',border: 'none',  backgroundColor: \"#404040\" }}\r\n                            type=\"password\"\r\n                            placeholder=\"Desired Password\"\r\n                            aria-label=\"Desired Password\"\r\n                            aria-describedby=\"basic-addon1\"\r\n                            onChange={ (e) => setPW1(e.target.value) }\r\n                            className={(pw1Invalid || passwordNoMatch) ? \"form-control-error\" : \"form-control-normal\"}\r\n                            />\r\n                    </InputGroup>\r\n                    <InputGroup  className=\"mb-5 mt-3\">\r\n                        <FormControl\r\n                            style={{ marginLeft: \"auto\", marginRight: \"auto\", color: \"white\", opacity: 0.87, maxWidth: '400px', minHeight: '50px',border: 'none',  backgroundColor: \"#404040\" }}\r\n                            type=\"password\"\r\n                            placeholder=\"Confirm Password\"\r\n                            aria-label=\"Confirm Password\"\r\n                            aria-describedby=\"basic-addon1\"\r\n                            onChange={ (e) => setPW2(e.target.value) }\r\n                            className={(pw2Invalid || passwordNoMatch) ? \"form-control-error\" : \"form-control-normal\"}\r\n                            />\r\n                    </InputGroup>\r\n                    <Button onClick={submit} size=\"lg\" className=\"rounded-pill mb-4 mx-auto\" variant=\"outline-success\" style={{ opacity: 0.8, maxWidth: '200px' }} block>Sign Up</Button>\r\n                    <Container fluid style={{ opacity: 1.2 }}>\r\n                        <Row>\r\n                          <Col className=\"mx-auto text-left\">\r\n                            <ul style={{ listStyleType: \"none\", marginRight: \"auto\", marginLeft: \"auto\", paddingRight: \"30px\" }}>\r\n                              {(error) ?  <li><h6 className=\"border-bottom pb-2 border-danger text-danger font-weight-bold\">Errors</h6></li> : \"\"}\r\n                              {\r\n                                (error) ? errorMsgs.map(el => (<li key={el} className=\"font-italic lead text-danger\">{el}</li>)) : \"\"\r\n                              }   \r\n                            </ul>    \r\n                          </Col>\r\n                        </Row>  \r\n                      </Container>\r\n                </Col> \r\n            </Row>\r\n        </Container>\r\n      : <Redirect to=\"/login\"></Redirect>\r\n    );\r\n}\r\nexport default CreateAccount;","import React from 'react';\r\nimport CreateAccount from '../components/loginScreen/CreateAccount';\r\n\r\nexport default function CreateAcc(){\r\n    return (\r\n      <div className=\"w-100 h-100\">\r\n        <CreateAccount></CreateAccount>\r\n      </div>  \r\n    )\r\n  }","import React, { useEffect } from 'react';\r\nimport io from \"socket.io-client\";\r\nimport { selectAccount } from '../../store/slices/accountSettingsSlice';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { selectHost } from '../../store/store';\r\nimport {\r\n    addMessage,\r\n    selectConversations,\r\n    selectCurrentConversation,\r\n    setTyping,\r\n    setRead,\r\n    pinMessage\r\n} from '../../store/slices/conversationsSlice';\r\nimport {\r\n    selectFriends\r\n} from '../../store/slices/friendsSlice';\r\nimport {  toast } from 'react-toastify';\r\nlet chatSocket = null;\r\n\r\nconst socketEvents = {\r\n    received: {\r\n        connectSuccess: \"connectSuccess\",\r\n        connectError: \"connectError\",\r\n        delivered: \"delivered\",\r\n        deliveryError: \"deliveryError\",\r\n        readReceipt: \"readReceipt\",\r\n        typing: \"typing\",\r\n        listening: \"listening\",\r\n        unlistened: \"unlistened\",\r\n        unlistenError: \"unlistenError\",\r\n        currentConversationUpdate: \"currentConversationUpdate\",\r\n        setCurrentConversationError: \"setCurrentConversationError\",\r\n        refreshSuccess: \"refreshSuccess\",\r\n        refreshError: \"refreshError\",\r\n        messagePinned: \"messagePinned\",\r\n        messagePinnedError: \"messagePinnedError\"\r\n    },\r\n    sent: {\r\n        connect: \"connect\",\r\n        disconnect: \"disconnect\",\r\n        chatToServer: \"chatToServer\",\r\n        readMessage: \"readMessage\",\r\n        typing: \"typing\",\r\n        listen: \"listen\",\r\n        unlisten: \"unlisten\",\r\n        setCurrentConversation: \"setCurrentConversation\",\r\n        pinMessage: \"pinMessage\"\r\n    }\r\n}\r\n\r\nexport default function ChatSocket(){\r\n    const account = useSelector(selectAccount);\r\n    let currentConversation = useSelector(selectCurrentConversation);\r\n    const conversations = useSelector(selectConversations);\r\n    const dispatch = useDispatch();\r\n    const host = useSelector(selectHost);\r\n    const friends = useSelector(selectFriends);\r\n    const listenAllRooms = (chatSocket) => {\r\n        console.log(\"Listening to all rooms\", conversations)\r\n        if(conversations && Array.isArray(conversations)){\r\n            for(let conv of conversations){\r\n                if(conv && conv.id && conv.pending === false){\r\n                    console.log(\"listening to conversation\", conv);\r\n                    chatSocket.emit(socketEvents.sent.listen, { room: conv.id, user: account.id });\r\n                }\r\n            }\r\n        } else {\r\n            //conversations = single conversation aka current one\r\n            chatSocket.emit(socketEvents.sent.listen, { room: currentConversation.id, user: account.id });\r\n        }\r\n    } \r\n    \r\n    // const teardownEventListeners = (chatSocket) => {\r\n    //     if(chatSocket == null || !chatSocket){\r\n    //         return true;\r\n    //     }\r\n    //     for(let key in socketEvents.received){\r\n    //         chatSocket.off(socketEvents.received[key]);\r\n    //     }\r\n    // }\r\n\r\n    useEffect(() => {\r\n        if(currentConversation && currentConversation.id && account && currentConversation.id !== \"0\"){\r\n            const socketOptions = {\r\n                transportOptions: {\r\n                    polling: {\r\n                        extraHeaders: {\r\n                            credentials: \"include\"\r\n                        }\r\n                    }\r\n                },\r\n                forceNew: true\r\n            }\r\n            console.log(\"Setting up chat socket\");\r\n            chatSocket = io(`${host}/chat`, socketOptions);\r\n            console.log(\"Setting up chat socket event listeners and listening to rooms\");\r\n            console.log(\"Setting up listeners\");\r\n            chatSocket.on(socketEvents.received.listening, (msg) => {\r\n                console.log(`Successfully listening on room with ID ${msg.room}`)\r\n            })\r\n            chatSocket.on(socketEvents.received.connectSuccess, (msg) => {\r\n                console.log(`Connected to socket.io server successfully with client id ${msg.socketId}`);\r\n            });\r\n            chatSocket.on(socketEvents.received.connectError, (msg) => {\r\n                console.log(`Error: Cannot connect to socket.io server | ${msg.message}`);\r\n            });\r\n            chatSocket.on(socketEvents.received.delivered, (msg) => {\r\n                console.log(`Handle message | ${msg.message.id} | delivered`);\r\n                if(account.id !== msg.message.user.id && msg.message.conversation.id !== currentConversation.id){\r\n                    //On another screen and received a message, pop up a toast\r\n                    toast.info(`Message received from: ${msg.message.user.tagName}` , { position: \"top-center\", hideProgressBar: true, pauseOnHover: true} );\r\n                }\r\n                if(msg.message.id && msg.message.body && msg.message.createdAt){\r\n                    console.log(`Adding message to state ... | ${msg.message.id}`);\r\n                    dispatch(addMessage({ message: msg.message, conversation: msg.message.conversation }));\r\n                }\r\n            });\r\n            chatSocket.on(socketEvents.received.deliveryError, () => {\r\n                console.log(\"Error: server error while marking message as delivered\");\r\n            });\r\n            chatSocket.on(socketEvents.received.readReceipt, (msg) => {\r\n                console.log(`Handle message | ${msg.message.id} | read receipt`);\r\n                if(msg.message.id && msg.message.body && msg.message.createdAt){\r\n                    //Is the message valid? ... Just checking properties....\r\n                    //Can probably use typescript interfaces eventually once I add ts transpiler to build scripts\r\n                    console.log(`Adding message read receipt to state ... | ${msg.message.id}`);\r\n                    dispatch(setRead({ messageId: msg.message.id, convId: msg.message.conversation.id }));\r\n                }\r\n            });\r\n            chatSocket.on(socketEvents.received.typing, (msg) => {\r\n                console.log(`Handle typing event conversation | ${msg.conv}`);\r\n                if(msg.conv && msg.user){\r\n                    if(msg.user.id === account.id){\r\n                        //Is the sender of this event equal to myself?\r\n                        //Return void okay?\r\n                        return;\r\n                    }\r\n                    if(currentConversation.id === msg.conv){\r\n                        //If msg.typing is null for whatever reason || false\r\n                        dispatch(setTyping(msg.typing || false));\r\n                    }\r\n                }\r\n            });\r\n            chatSocket.on(socketEvents.received.unlistened, (msg) => {\r\n                console.log(`Handle unlisten event for conversation | ${msg.room}`);\r\n            });\r\n            chatSocket.on(socketEvents.received.unlistenError, (msg) => {\r\n                console.log(`Error: unlisten event error for conversation | ${msg.msg}`);\r\n            });\r\n            chatSocket.on(socketEvents.received.currentConversationUpdate, (msg) => {\r\n                console.log(`Handle current conversation update event for user | ${msg.user.tagName}`);\r\n                if(msg.user){\r\n                    let friend = friends.filter(el => el.id === msg.user.id)[0];\r\n                    if(friend){\r\n                        console.log(`Handle set current conversation for friend @${msg.user.tagName}`);\r\n                        friend = msg.user;\r\n                    }\r\n                }\r\n            });\r\n            chatSocket.on(socketEvents.received.setCurrentConversationError, (msg) => {\r\n                console.log(`Error: set current conversation event error | ${msg.msg}`);\r\n            }); \r\n            chatSocket.on(socketEvents.received.refreshSuccess, (msg) => {\r\n                console.log(`Handle success refresh socket client ID with server ${msg.clientId}`);\r\n            });\r\n            chatSocket.on(socketEvents.received.refreshError, (msg) => {\r\n                console.log(`Handle error for refresh socket client ID with server error ${msg.msg}`);\r\n            });\r\n            chatSocket.on(socketEvents.received.messagePinned, data => {\r\n                console.log(\"Handle message pinned from server\", data); \r\n                dispatch(pinMessage(data.message)); \r\n            });\r\n            chatSocket.on(socketEvents.received.messagePinnedError, data => {\r\n                console.log(\"Handle message pinned error from server\", data); \r\n            });\r\n            listenAllRooms(chatSocket);\r\n            chatSocket.emit('refresh', { userId: account.id, refresh: true });\r\n        } else {\r\n            chatSocket = null;\r\n        }\r\n        return () => {\r\n            if(chatSocket) {\r\n                Object.keys(socketEvents.received).map(el => chatSocket.off(el));\r\n                chatSocket.close();\r\n                chatSocket = null;\r\n            }\r\n        }\r\n    }, [currentConversation.id]);\r\n    return (<></>);\r\n}\r\n\r\nexport { chatSocket }","import React, { useEffect, useState, useRef } from 'react' \r\nimport { Row, Col, InputGroup, FormControl, Button, Spinner } from 'react-bootstrap';\r\nimport { SendRounded } from '@material-ui/icons';\r\nimport {\r\n    selectCurrentConversation\r\n} from '../../store/slices/conversationsSlice';\r\nimport {\r\n    selectAccount\r\n} from '../../store/slices/accountSettingsSlice';\r\nimport { useSelector } from 'react-redux'\r\nimport { chatSocket } from '../socket/chatSocket';\r\nimport useWindowSize from '../../util/windowSize';\r\nimport regex from '../../util/regex';\r\nlet searchTimeout;\r\n\r\nexport default function ChatBox(){\r\n    const [message, setMessage] = useState(\"\");\r\n    const account = useSelector(selectAccount);\r\n    const currentConversation = useSelector(selectCurrentConversation);\r\n    const formRef = useRef(null);\r\n    const [typingTimeout, setTypingTimeout] = useState(null);\r\n    const size = useWindowSize();\r\n    const [error, setError] = useState(false);\r\n    const [errorMsgs, setErrorMsgs] = useState([]);\r\n    const [spinning, setSpinning] = useState(false);\r\n    const checkInput = () => {\r\n        let passing = true;\r\n        if(regex.messageBody.test(message) === false){\r\n            setErrorMsgs([\"Invalid message body. Must be 1-200 characters.\", ...errorMsgs]);\r\n            passing = false;\r\n        }\r\n        if(!passing) setError(true);\r\n        return passing;\r\n    }\r\n\r\n    const sendMessage = async () => {\r\n        if(!checkInput()){\r\n            console.log(\"Error with sending message\", errorMsgs);\r\n            return;\r\n        }\r\n        console.log(\"Send message \", message);\r\n        if(chatSocket){\r\n           chatSocket.emit('chatToServer', { sender: account.tagName, room: currentConversation.id, body: `${message}` });\r\n           setSpinning(true);\r\n           formRef.current.value = \"\"\r\n        }\r\n        else {\r\n            setError(true);\r\n            setErrorMsgs([\"Corrupted chat socket. Please refresh.\"])\r\n            console.log(\"Corrupted chat socket. Please refresh.\");\r\n        }\r\n    }\r\n    const sendTyping = (isTyping) => {\r\n        if(chatSocket && account && currentConversation){\r\n            chatSocket.emit('typing', { sender: account.tagName, room: currentConversation.id, typing: isTyping } );\r\n        }\r\n        else {\r\n            console.log(\"Error: no conversation to send typing to! Please refresh\")\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(chatSocket && formRef && currentConversation && account){\r\n            formRef.current.onkeypress = () => { \r\n                if (searchTimeout !== undefined) clearTimeout(searchTimeout);\r\n                searchTimeout = setTimeout(() => {\r\n                    console.log(\"typing done\")\r\n                    setTypingTimeout(false)\r\n                    sendTyping(false)\r\n                }, 1000);\r\n            }\r\n        }\r\n    }, [currentConversation.id])\r\n    useEffect(() => {\r\n        if(currentConversation.messages && Array.isArray(currentConversation.messages)){\r\n            setSpinning(false);\r\n        }\r\n    }, [currentConversation.messages])\r\n    return ( \r\n        <div>\r\n            <Row className=\"w-100 text-center\" style={{ position: \"fixed\", bottom: 40, left: 50 }}>\r\n                {(size.width > 768) ? (<Col style={{ minWidth: \"240px\", maxWidth: \"240px\" }}></Col>) : \"\" }\r\n                <Col className=\"mx-auto\" style={{ paddingRight: \"15px\", paddingLeft: (size.width > 768) ? \"2%\" : \"5%\" }}>\r\n                {(error) ? (<div className=\"text-danger lead\" style={{ opacity: 0.7 }}>{errorMsgs}</div>) : \"\"}\r\n                <InputGroup className=\"pb-3 mx-auto\">\r\n                    <FormControl\r\n                        style={{ backgroundColor: \"#404040\", color: \"white\", border: \"none\" }}\r\n                        placeholder=\"Enter a Message\"\r\n                        aria-label=\"Enter a Message\"\r\n                        aria-describedby=\"basic-addon2\"\r\n                        className=\"rounded-pill p-4\"\r\n                        ref={formRef}\r\n                        onKeyPress={\r\n                            async (e) => {\r\n                                if(e.key === \"Enter\") {\r\n                                    await sendMessage()\r\n                                }\r\n                            }\r\n                        }\r\n                        onChange={async (e) => {\r\n                            if(chatSocket && !typingTimeout){\r\n                                setTypingTimeout(true)\r\n                                sendTyping(true)\r\n                                console.log(\"Typing started\")\r\n                            }\r\n                            setMessage(e.target.value)\r\n                        }}\r\n                    />\r\n                    <InputGroup.Append>\r\n                    {\r\n                        (spinning) ? <Spinner className=\"m-2 p-2\" size=\"lg\" variant=\"info\" animation=\"border\" /> :\r\n                            (<Button onClick={async () => { \r\n                                await sendMessage() } } \r\n                                    className=\"ml-1 rounded-pill text-right\" \r\n                                    variant=\"outline-secondary\" \r\n                                    style={{ \"border\": \"none\", \r\n                                    backgroundColor: \"#404040\", \r\n                                    color: \"#02a5ff\" }} \r\n                                    id=\"basic-addon2\">\r\n                                <SendRounded \r\n                                    style={{ color: \"white\", opacity: \"0.87\"}}\r\n                                >\r\n                                </SendRounded>\r\n                            </Button>)\r\n                    }  \r\n                    </InputGroup.Append>\r\n                </InputGroup>\r\n                </Col>\r\n                <Col xs=\"1\"></Col>\r\n            </Row>\r\n        </div>\r\n    );\r\n}","import {useState, useEffect} from 'react'\r\nexport default function useWindowSize() {\r\n    // Initialize state with undefined width/height so server and client renders match\r\n    // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\r\n    const [windowSize, setWindowSize] = useState({\r\n      width: undefined,\r\n      height: undefined,\r\n    });\r\n  \r\n    useEffect(() => {\r\n      // Handler to call on window resize\r\n      function handleResize() {\r\n        // Set window width/height to state\r\n        setWindowSize({\r\n          width: window.innerWidth,\r\n          height: window.innerHeight,\r\n        });\r\n      }\r\n      \r\n      // Add event listener\r\n      window.addEventListener(\"resize\", handleResize);\r\n      \r\n      // Call handler right away so state gets updated with initial window size\r\n      handleResize();\r\n      \r\n      // Remove event listener on cleanup\r\n      return () => window.removeEventListener(\"resize\", handleResize);\r\n    }, []); // Empty array ensures that effect is only run on mount\r\n  \r\n    return windowSize;\r\n  }","import React from 'react';\r\nimport { Button, Dropdown } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types'\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport FlagIcon from '@material-ui/icons/Flag';\r\nimport DeleteOutlineIcon from '@material-ui/icons/DeleteOutline';\r\nimport '../topbar/topbar.css';\r\nexport default function MessageDropdown({ sentByMe, deleteMessage, pinMessage }){\r\n    return (\r\n    <Dropdown className={(sentByMe) ? \"msg-dropdown message-dropdown-sender light-hover\" : \"msg-dropdown message-dropdown-received light-hover\"}  drop={(sentByMe) ? \"left\" : \"right\"} >              \r\n      <Dropdown.Toggle \r\n          as={Button} variant=\"dark\" className=\"message-menu-button\">\r\n          <MoreVertIcon></MoreVertIcon>\r\n      </Dropdown.Toggle>\r\n      <Dropdown.Menu style={{ backgroundColor: \"#222222\", minWidth: \"80px\"} } className=\"my-dropdown-message shadow text-white text-center\">        \r\n          <Dropdown.Item  \r\n              className=\"text-white shadow dropdown-item-message\" \r\n              as=\"button\" onClick={ \r\n                  (e) =>\r\n                  {\r\n                      e.preventDefault();\r\n                      e.stopPropagation();\r\n                      if(pinMessage) pinMessage();\r\n                  }}>\r\n              Pin&nbsp;<FlagIcon></FlagIcon>\r\n          </Dropdown.Item>    \r\n          {\r\n              (sentByMe) ?  <Dropdown.Item  \r\n                              className=\"text-white shadow dropdown-item-message\" \r\n                              as=\"button\" onClick={ \r\n                                  (e) =>\r\n                                  {\r\n                                      e.preventDefault();\r\n                                      e.stopPropagation();\r\n                                      if(deleteMessage) deleteMessage();\r\n                                  }}>\r\n                              Delete&nbsp;<DeleteOutlineIcon></DeleteOutlineIcon>\r\n                          </Dropdown.Item> : \"\"\r\n          }\r\n      </Dropdown.Menu>\r\n    </Dropdown>)\r\n}\r\nMessageDropdown.propTypes = {\r\n    sentByMe: PropTypes.bool, \r\n    deleteMessage: PropTypes.func,\r\n    pinMessage: PropTypes.func\r\n}","import React, { useState }  from 'react';\r\nimport { Row, Col, Container } from 'react-bootstrap';\r\nimport { useSelector } from 'react-redux';\r\nimport PropTypes from 'prop-types'; \r\nimport { selectAccount } from '../../store/slices/accountSettingsSlice';\r\nimport { Typography } from '@material-ui/core'; \r\nimport MessageDropdown from '../dropdowns/Message'; \r\nimport useWindowSize from '../../util/windowSize';\r\nimport './listitems.css';\r\nimport '../topbar/topbar.css';\r\nconst weekdays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n// returns: \r\n// {\r\n//     hour: number (0-12),\r\n//     min: number (0-60),\r\n//     pm: undefined (bool),\r\n//     day: number (0-31),\r\n//     minsAgo\r\n// }\r\nexport const getDateMetaData = (createdAt) => {\r\n    const date = new Date(Date.parse(createdAt));\r\n    return {\r\n        hour: date.getHours(),\r\n        min: date.getMinutes(),\r\n        pm: (date.getHours() > 12),\r\n        day: (date.getTime() < Date.now() - 86400000) ? weekdays[date.getDay()] : \"\",\r\n        minsAgo: ((Date.now() - date) / 1000 ) / 60\r\n    }\r\n}\r\n//Component for a message from me \r\nexport function MessageMe({ message, isBottom }) {\r\n    const date = getDateMetaData(message.createdAt); \r\n    const [showMenu, setShowMenu] = useState(false);\r\n    const size = useWindowSize();\r\n    const pinMessage = () => {\r\n        alert('message pinned');\r\n    }\r\n    const deleteMessage = () => {\r\n        alert('message del');\r\n    }\r\n    return (\r\n        <Container key={Math.random()} className=\"mt-2 mb-2\" style={{ marginTop: \"auto\", minHeight: \"80px\" }} fluid>\r\n            <Row onMouseLeave={() => setShowMenu(false) }>\r\n                <Col xs=\"12\" className=\"text-right pr-2\">\r\n                    <Container fluid className={(size.width > 768) ? \"pr-5\" : \"\"}>\r\n                        <Row>\r\n                            <Col className=\"text-right message-me-column\" onMouseEnter={() => { setShowMenu(true)}} >\r\n                                <Typography className=\"p-2 m-1 text-white text-left message-from-me message-column\" style={{ borderRadius: \"18px 18px 5px 18px\", display:\"block\", backgroundColor: \"#3266a8\", wordWrap: \"break-word\"}}>{message.body}</Typography>\r\n                            </Col>\r\n                            <Col xs=\"1\" style={{maxWidth: \"20px\" }} className=\"text-right\">\r\n                                {(showMenu) ? <MessageDropdown sentByMe={true} pinMessage={pinMessage} deleteMessage={deleteMessage}></MessageDropdown>: \"\"}\r\n                            </Col>\r\n                        </Row>\r\n                    </Container>\r\n                </Col>\r\n            </Row>\r\n            {\r\n                (showMenu || isBottom) ? (\r\n                    <Row style={{ opacity: 0.8 }}>\r\n                        <Col xs=\"12\" className=\"text-right pr-3\">\r\n                            <Container fluid className={(size.width > 768) ? \"pr-5\" : \"\"}>\r\n                                <Row>\r\n                                    <Col xs={(size.width > 768 ? \"8\" : \"6\")} className=\"text-center\">\r\n                                    </Col>\r\n                                    <Col className=\"text-right\">\r\n                                        <span style={{ opacity: 0.7, fontSize: \"10pt\" }} className=\"font-italic text-left text-white text-small\">\r\n                                            {`${(message.read === true ) ? \"Read - \" : \" Delivered - \"}`}\r\n                                            {(date.minsAgo < 60) ? \r\n                                                `${(date.minsAgo.toFixed() > 0) ? date.minsAgo.toFixed() + \" mins ago\" : \"Now\"}`  \r\n                                                : `${(date.day) ? date.day + \", \" : \"Today, \"}${date.hour}:${(date.min < 10) ? \"0\" + date.min : date.min}${(date.pm) ? \"PM\" : \"AM\"}`}\r\n                                        </span>\r\n                                    </Col>     \r\n                                </Row>\r\n                            </Container>\r\n                        </Col>                   \r\n                    </Row>\r\n                ) : \"\"\r\n            }\r\n        </Container>\r\n    ) \r\n}\r\n\r\n//Component for a message from someone else\r\nexport function MessageOther({ message }) {\r\n    const date = getDateMetaData(message.createdAt); \r\n    const [showMenu, setShowMenu] = useState(false);\r\n    const pinMessage = () => {\r\n        alert('message pinned');\r\n    }\r\n    return (\r\n        <Container key={Math.random()} className=\"mt-2 mb-2 p-1\"  style={{ marginTop: \"auto\", minHeight: \"80px\" }} fluid>\r\n         <Row onMouseLeave={() => setShowMenu(false) }>\r\n                <Col xs=\"12\" className=\"text-left\">\r\n                    <Container fluid>\r\n                        <Row>\r\n                            <Col xs=\"1\" style={{maxWidth: \"20px\" }} className=\"text-left\">\r\n                                {(showMenu) ? <MessageDropdown pinMessage={pinMessage} sentByMe={false}></MessageDropdown>: \"\"}\r\n                            </Col>\r\n                            <Col className=\"text-left message-me-column\" onMouseEnter={() => { setShowMenu(true)}} >\r\n                                <Typography className=\"p-2 m-1 text-white text-left message-from-other message-column\" style={{ borderRadius: \"5px 18px 18px 18px\", display:\"block\", backgroundColor: \"#1E3D64\", wordWrap: \"break-word\"}}>{message.body}</Typography>\r\n                            </Col>  \r\n                        </Row>\r\n                    </Container>\r\n                </Col>   \r\n        </Row>\r\n        <Row style={{ opacity: 0.8, maxHeight: \"10px\" }}>\r\n            <Col xs=\"9\" className=\"text-left pl-4 pt-2\" style={{ opacity: 0.7 }}>\r\n                <span className=\"font-italic text-left text-white\">\r\n                <span style={{ opacity: 0.7, fontSize: \"10pt\" }}  className=\"text-white text-small\">{`@${message.user.tagName} `}</span>\r\n                {(date.minsAgo < 60) ? `- ${(date.minsAgo.toFixed() > 0) ? \r\n                    date.minsAgo.toFixed() + \" mins ago\" : \"Now\"}`  \r\n                    : `- ${(date.day) ? date.day + \", \" : \"Today, \"}${date.hour}:${(date.min < 10) ? \"0\" + date.min : date.min} ${(date.pm) ? \"PM\" : \"AM\"}`}\r\n                </span>\r\n            </Col>\r\n            <Col xs=\"3\" className=\"text-center\">\r\n            </Col>\r\n       </Row>\r\n    </Container>)\r\n}\r\n\r\n\r\nexport default function MessageListItem({ message, isBottom }) {\r\n    const account = useSelector(selectAccount);\r\n    const isSender = (message.user.id === account.id); \r\n    return (isSender) ? (\r\n           <MessageMe message={message} isBottom={isBottom}></MessageMe>\r\n    ) : (\r\n           <MessageOther message={message}></MessageOther>\r\n    )\r\n}\r\n\r\nMessageMe.propTypes = {\r\n    message: {\r\n        read: PropTypes.bool, \r\n        createdAt: PropTypes.string,\r\n        body: PropTypes.string, \r\n        user: PropTypes.object\r\n    }, \r\n    isBottom: PropTypes.bool\r\n}\r\nMessageOther.propTypes = {\r\n    message: {\r\n        read: PropTypes.bool, \r\n        createdAt: PropTypes.string,\r\n        body: PropTypes.string, \r\n        user: PropTypes.object\r\n    }, \r\n}\r\nMessageListItem.propTypes = {\r\n    message: {\r\n        read: PropTypes.bool, \r\n        createdAt: PropTypes.string,\r\n        body: PropTypes.string, \r\n        user: PropTypes.object\r\n    }, \r\n    isBottom: PropTypes.bool\r\n}","import React, { useEffect, useState, useRef } from 'react';\r\nimport { Row, Col, Container, Spinner } from 'react-bootstrap';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport useWindowSize from '../../util/windowSize';\r\nimport { \r\n    selectCurrentConversation,\r\n    sortMessages,\r\n    batchAddMessages\r\n} from '../../store/slices/conversationsSlice';\r\nimport MessageListItem from '../listitems/Message'; \r\nimport './messages.css';\r\nimport '../sidebar/sidebar.css'; \r\n\r\nexport default function MessagesListView({ defaultView }){\r\n    const [ isTyping, setIsTyping] = useState(false);\r\n    const [messages, setMessages] = useState([]);\r\n    const [loadingMessages, setLoadingMessages] = useState(false);\r\n    let currentConversation = useSelector(selectCurrentConversation);\r\n    const size = useWindowSize();\r\n    const colRef = useRef();\r\n    const dispatch = useDispatch();\r\n    if(!currentConversation) currentConversation = {}\r\n    let rowHeight = size.height - (size.height / 8);\r\n    if(isNaN(rowHeight)){\r\n        rowHeight = window.innerHeight - (window.innerHeight / 8)\r\n    }\r\n    const lazyLoadMessages = async () => {\r\n        console.log(\"Requesting more messages for conversation \" + currentConversation.id)\r\n        const messageResult = await fetch(`http://localhost:3000/api/conversation/messages/range/?` + new URLSearchParams({\r\n            id: currentConversation.id,\r\n            beforeDate: currentConversation.messages[0].createdAt,\r\n            number: 25,\r\n        }), {\r\n            headers: {\r\n                'credentials': 'include'\r\n            }\r\n        });\r\n        const messages = await messageResult.json(); \r\n        if(Array.isArray(messages)) {\r\n            console.log(messages)\r\n            dispatch(batchAddMessages({ messages: messages, conversationId: currentConversation.id }));     \r\n        }\r\n    }\r\n    const handleScroll = async () => {\r\n        if(colRef.current){\r\n            if(colRef.current?.scrollTop <= 100 && loadingMessages !== true) {\r\n                if(currentConversation?.messages?.length < currentConversation?.numberOfMessages){\r\n                    if(loadingMessages === false) {\r\n                        setLoadingMessages(true);\r\n                        await lazyLoadMessages();\r\n                        setLoadingMessages(false);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    useEffect(() => {\r\n        if(currentConversation && currentConversation.messages){\r\n            dispatch(sortMessages());\r\n            setMessages(currentConversation.messages);\r\n        }\r\n        if(colRef && colRef.current && loadingMessages === false)\r\n            colRef.current.scrollTop = colRef.current.scrollHeight\r\n    }, [currentConversation.messages]);\r\n    useEffect(() => {\r\n        if(colRef && colRef.current && loadingMessages === false)\r\n            colRef.current.scrollTop = colRef.current.scrollHeight\r\n    }, [messages]);\r\n    useEffect(() => {\r\n        if(currentConversation && currentConversation.typing !== undefined){\r\n            console.log(\"Typing\");\r\n            setIsTyping(currentConversation.typing)\r\n        }\r\n    }, [currentConversation.typing]);\r\n    return (\r\n        (defaultView) ? \r\n            <Row>\r\n                <Col xs='3'></Col>\r\n                <Col className=\"mt-5 lead\" style={{ opacity: 0.87, color: \"#404040\" }}>\r\n                    <span style={{ marginTop: 'auto' }}>Click a conversation</span>\r\n                </Col>\r\n                <Col  xs='3'></Col>\r\n            </Row>\r\n        :\r\n        <Row className=\"w-100\" style={{ marginTop: 75 }}>\r\n            {(size.width > 768 ? <Col style={{ minWidth: \"240px\", maxWidth: \"240px\" }}></Col> : \"\")}\r\n            <Col style={{ paddingLeft: (size.width > 768) ? \"0%\" : \"3%\" }}  >\r\n                <Container fluid>\r\n                    <Row style={{ height: rowHeight}}>\r\n                        <Col ref={colRef} onScroll={handleScroll} className=\"ul\" style={{ \r\n                            bottom: 150, \r\n                            paddingBottom: 50, \r\n                            paddingTop: 100,\r\n                            height: rowHeight - 10, \r\n                            overflowY: \"scroll\",\r\n                            position: \"fixed\", \r\n                            paddingLeft: \"20px\",\r\n                            paddingRight: \"85px\",\r\n                            width: (size.width > 768) ? (size.width - 240) : size.width,\r\n                            maxWidth: (size.width > 768) ? (size.width - 240): size.width }}\r\n                        >\r\n                            {messages.map((message, idx) => {\r\n                                return (\r\n                                    <Row  key={message.id + \"row\"} className=\"messages-list-item\">\r\n                                        <MessageListItem key={message.id} message={message} isBottom={(idx >= (messages.length - 1))}></MessageListItem>\r\n                                    </Row>\r\n                                )\r\n                                }\r\n                            )}\r\n                        </Col>\r\n                    </Row>\r\n                    {\r\n                    (isTyping || loadingMessages) ? (\r\n                    <Row>\r\n                        <Container key={Math.random()} style={{ position: \"fixed\", bottom: 120 }} className=\"typing-list-item-container\" fluid>\r\n                                <Row className=\"mt-1 mb-1\">\r\n                                <Col xs=\"1\"></Col>\r\n                                <Col xs=\"9\" className=\"text-left\">\r\n                                    <div className=\"p-2 m-1 text-white typing-list-item\"\r\n                                        style={{ borderRadius: \"18px\", \r\n                                        display:\"inline-block\", \r\n                                        whiteSpace: \"nowrap\", \r\n                                        backgroundColor: \"#1E3D64\"}}>\r\n                                        {\r\n                                            (loadingMessages) ? (\r\n                                                <span>\r\n                                                    <span className='font-italic text-muted' style={{ fontSize: '18pt' }}>Loading Messages</span>\r\n                                                    &nbsp;&nbsp;<Spinner animation=\"grow\" size=\"lg\" />\r\n                                                </span>\r\n                                            ) : \"\"\r\n                                        } \r\n                                        {\r\n                                            (isTyping) ? ( \r\n                                                <span>\r\n                                                    <Spinner animation=\"grow\" size=\"lg\" />\r\n                                                    <Spinner animation=\"grow\" size=\"lg\" />\r\n                                                    <Spinner animation=\"grow\" size=\"lg\" />\r\n                                                </span>) : \"\"\r\n                                        }   \r\n                                    </div>\r\n                                </Col>\r\n                                <Col xs=\"3\" className=\"text-center\">\r\n                                </Col>\r\n                                </Row>\r\n                                <Row className=\"\" style={{ marginTop: -10 }}>\r\n                                        <Col xs=\"9\" className=\"text-left pl-4\">\r\n                                            <span className=\"font-italic text-left text-muted\"></span>\r\n                                        </Col>\r\n                                        <Col xs=\"3\" className=\"text-center\">\r\n                                        </Col>\r\n                                </Row>\r\n                        </Container>\r\n                    </Row>\r\n                    ) : \"\"\r\n                    }\r\n                </Container>\r\n            </Col>\r\n        </Row>\r\n    )\r\n}\r\n\r\nMessagesListView.propTypes = {\r\n    defaultView: PropTypes.bool\r\n}","import React from 'react';\r\nimport { Container, Row } from 'react-bootstrap';\r\nimport { useSelector } from 'react-redux';\r\nimport ChatBox from './ChatBox';\r\nimport MessagesListView from './MessagesListView';\r\nimport {\r\n    selectView\r\n  } from '../../store/slices/conversationsSlice';\r\nimport useWindowSize from '../../util/windowSize';\r\nexport default function ChatContainer(){\r\n    const size = useWindowSize();\r\n    const defaultView = useSelector(selectView);    \r\n    return (\r\n        (defaultView) ?\r\n        <Container fluid>\r\n        </Container>\r\n        :\r\n        <Container className=\"pl-3\" style={{ minHeight: size.height, height: size.height}} fluid>\r\n            <Row style={{ minHeight: size.height - 150, height: size.height - 150, paddingBottom: 'auto'}}>\r\n                <MessagesListView defaultView={defaultView} style={{ minHeight: size.height, height: size.height}}></MessagesListView>\r\n            </Row>\r\n            <Row style={{ minHeight: 20 }}>\r\n\r\n            </Row>  \r\n            <Row className=\"pb-2\">\r\n                <ChatBox></ChatBox>\r\n            </Row>  \r\n            <Row style={{ minHeight: 20 }}>\r\n\r\n            </Row>  \r\n        </Container>\r\n    )\r\n}","import React from 'react';\r\nimport { Row, Col, Button, Dropdown, Container } from 'react-bootstrap';\r\nimport { ListItem } from '@material-ui/core';\r\nimport DeleteOutlineIcon from '@material-ui/icons/DeleteOutline';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport PropTypes from 'prop-types'; \r\nimport './listitems.css';\r\nimport '../topbar/topbar.css';\r\n\r\nexport default function ChatListItem({  conversation, \r\n                                        selectConversation, \r\n                                        deleteConversation, \r\n                                        selected, \r\n                                        minWidth, \r\n                                        buttonMargin }) {\r\n    return (\r\n        <ListItem onClick={() => selectConversation(conversation)} key={conversation.id} className={(selected) ? \"sidebar-list-item light-selected\" : \"sidebar-list-item light-hover\"} style={{ backgroundColor: \"#222222\" }} >\r\n            <Container fluid style={{ backgroundColor: \"#222222\" }} className={(selected) ? \"light-selected\" : \"light-hover\"} >\r\n                <Row style={{ backgroundColor: \"#222222\" }} className={(selected) ? \"light-selected\" : \"light-hover\"}>\r\n                    <Col className={(selected) ? \"conv-info light-selected\" : \"conv-info light-hover\"} style={{ minWidth: minWidth }}>\r\n                        <Container fluid className={(selected) ? \"light-selected\" : \"light-hover\"}>\r\n                            <Row className=\"font-italic text-primary\" style={{ fontSize: \"11pt\", minWidth: minWidth  }}>\r\n                                {conversation.conversationName}\r\n                            </Row>\r\n                            <Row className=\"w-100\" style={{ fontSize: \"9pt\" }}>\r\n                                <div className=\"ml-1 d-block text-truncate\">\r\n                                    {conversation.messages[0].body}            \r\n                                </div>\r\n                            </Row>\r\n                            <Row className=\"lead w-100 mt-1\" style={{ fontSize: \"8pt\"}}>\r\n                                <div className=\"ml-1 d-block font-italic\">\r\n                                    {new Date(Date.parse(conversation.createdAt)).toLocaleString('en-US')}   \r\n                                </div>\r\n                            </Row>\r\n                        </Container>\r\n                    </Col>\r\n                    <Col className={(selected) ? \"hide-conv-info text-right light-selected\" : \"hide-conv-info text-right light-hover\"}\r\n                    style={{ backgroundColor: \"#222222\", marginLeft: buttonMargin }}>\r\n                        <Container className={(selected) ? \"light-selected\" : \"light-hover\"} style={{ backgroundColor: \"#222222\" }} fluid>\r\n                            <Dropdown className={(selected) ? \"light-selected\" : \"light-hover\"} style={{ backgroundColor: \"#222222\", marginLeft: \"-20px\"}}>              \r\n                                <Dropdown.Toggle \r\n                                    className=\"dropdown-toggle-conv-info text-white\"\r\n                                    style={{ border:\" none\", backgroundColor: \"#222222\"}} \r\n                                    as={Button} variant=\"dark\" id=\"dropdown-custom-components\">\r\n                                    <MoreVertIcon></MoreVertIcon>\r\n                                </Dropdown.Toggle>\r\n                                <Dropdown.Menu style={{ backgroundColor: \"#222222\"}} className=\"my-dropdown shadow text-white text-center\">        \r\n                                    <Dropdown.Item  \r\n                                        className=\"text-white shadow conv-dropdown p-2\" \r\n                                        as=\"button\" onClick={ \r\n                                            (e) =>\r\n                                            {\r\n                                                e.preventDefault();\r\n                                                e.stopPropagation();\r\n                                                if(deleteConversation) deleteConversation(conversation.id);\r\n                                            }}>\r\n                                        Delete&nbsp;<DeleteOutlineIcon></DeleteOutlineIcon>\r\n                                    </Dropdown.Item>                                                    \r\n                                </Dropdown.Menu>\r\n                            </Dropdown>\r\n                        </Container>\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n        </ListItem>\r\n    );\r\n}\r\n\r\nChatListItem.propTypes = {\r\n    conversation: {\r\n        id: PropTypes.string, \r\n        conversationName: PropTypes.string, \r\n        messages: PropTypes.arrayOf({ body: PropTypes.string }),\r\n        createdAt: PropTypes.string \r\n    }, \r\n    selectConversation: PropTypes.func, \r\n    deleteConversation: PropTypes.func, \r\n    selected: PropTypes.bool, \r\n    minWidth: PropTypes.number,\r\n    buttonMargin: PropTypes.number\r\n}","import React, { useState } from 'react';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport useWindowSize from '../../util/windowSize'\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport { Container, InputGroup, FormControl, Button } from 'react-bootstrap';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { removeConversation, \r\n    selectConversations, \r\n    setCurrentConversation, \r\n    selectShowConvList, \r\n    setShowConvList, \r\n    selectCurrentConversation,\r\n    setView  } from '../../store/slices/conversationsSlice';\r\nimport { selectAccount } from '../../store/slices/accountSettingsSlice';\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\nimport { setTopbarMessage } from '../../store/slices/uiSlice';\r\nimport { SearchOutlined } from '@material-ui/icons';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport { chatSocket } from '../socket/chatSocket';\r\nimport ChatListItem from '../listItems/Chat'; \r\nimport regex from '../../util/regex';\r\nimport \"./sidebar.css\";\r\n\r\nconst getMinWidthListItem = (narrowScreen, deleted, showConvList) => {\r\n    if((narrowScreen || deleted) && showConvList){\r\n        //Only show conversation list, aka sidebar\r\n        return \"450px\";\r\n    } else if(narrowScreen && !showConvList) {\r\n        //Only show current conversation, hide sidebar  \r\n        return \"0px\";\r\n    } else if(!narrowScreen && !showConvList) {\r\n        //Narrow sidebar for wider screens\r\n        return \"200px\";\r\n    } else {\r\n        return \"200px\";\r\n    } \r\n}\r\n\r\nconst getButtonMargin = (narrowScreen, showConvList) => {\r\n    if(narrowScreen && showConvList){\r\n        //Only show conversation list, aka sidebar\r\n        return \"150px\";\r\n    } else if(narrowScreen && !showConvList) {\r\n        //Only show current conversation, hide sidebar  \r\n        return \"0px\";\r\n    } else if(!narrowScreen && !showConvList) {\r\n        //Narrow sidebar for wider screens\r\n        return \"-5px\";\r\n    } else {\r\n        return \"-5px\";\r\n    } \r\n}\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    animate_in: {\r\n        width: 0,\r\n        visibility: \"invisible\",\r\n        flexShrink: 0,\r\n        animationName: \"fadeout\",\r\n        animationDuration: \"1s\"\r\n    },\r\n    animate_out: {\r\n        width: \"200px\",\r\n        flexShrink: 0,\r\n        animationName: \"fadeout\",\r\n        animationDuration: \"1s\"\r\n    },\r\n    '@keyframes fadeout': {\r\n        '0%': {\r\n            width: \"25%\"\r\n        },\r\n        '100%': {\r\n            width: 0,\r\n            display: \"none\",\r\n            opacity: 1\r\n        },\r\n    },\r\n    '@keyframes fadein': {\r\n        '0%': {\r\n            width: 0,\r\n            opacity: 0\r\n        },\r\n        '100%': {\r\n            width: \"25%\",\r\n            opacity: 1\r\n        }\r\n    },\r\n    narrowPaper: {\r\n        minWidth: \"240px\",\r\n        maxWidth: \"240px\",\r\n        backgroundColor: \"#222222\",\r\n        opacity: 0.8\r\n      },\r\n    hidePaper: {\r\n        backgroundColor: \"#222222\",\r\n        width: \"0%\",\r\n    },\r\n    fullDrawerPaper: {\r\n        width: \"100%\",\r\n        backgroundColor: \"#222222\"\r\n    },\r\n    drawerContainer: {\r\n      backgroundColor: \"#222222\",\r\n      color: \"white\",\r\n      paddingRight: \"20px\",\r\n      overflowX: \"hide\"\r\n    },\r\n}));\r\n\r\nexport default function Sidebar(){\r\n    const size = useWindowSize();\r\n    const classes = useStyles();\r\n    const narrowScreen = size.width < 768;\r\n    let conversations = useSelector(selectConversations);\r\n    let [filteredConversations, setFilteredConversations] = useState([]);\r\n    const dispatch = useDispatch();\r\n    const showConvList = useSelector(selectShowConvList);\r\n    const account = useSelector(selectAccount);\r\n    const [searchBar, setSearchBar] = useState(\"\");\r\n    const history = useHistory();\r\n    const location = useLocation();\r\n    const currentConversation = useSelector(selectCurrentConversation);\r\n    const [searchScreen, setSearchScreen] = useState(false);\r\n    const [error, setError] = useState(false);\r\n    const [deleted, setDeleted] = useState(false);\r\n\r\n    const getPaper = () => {\r\n        if((narrowScreen || deleted) && showConvList){\r\n            //Only show conversation list, aka sidebar\r\n            return classes.fullDrawerPaper;\r\n        } else if(narrowScreen && !showConvList) {\r\n            //Only show current conversation, hide sidebar  \r\n            return classes.hidePaper;\r\n        } else if(!narrowScreen && !showConvList) {\r\n            //Narrow sidebar for wider screens\r\n            return classes.narrowPaper;\r\n        } else {\r\n            return classes.narrowPaper;\r\n        }  \r\n    }\r\n\r\n    const searchChatNames = () => {\r\n        setError(false);\r\n        if(searchBar.length > 4){\r\n            if(regex.conversationName.test(searchBar) === false) {\r\n                console.log(\"Input failed for searching a conversation name\");\r\n                setError(true);\r\n                return; \r\n            }\r\n            const anyConvs = conversations.filter(conv => conv.conversationName.includes(searchBar) || searchBar.includes(conv.conversationName));\r\n            if(anyConvs.length > 0) {\r\n                setFilteredConversations(anyConvs);\r\n                setSearchScreen(true);\r\n            } else {\r\n                setError(true);\r\n            }\r\n        } else setError(true);\r\n    }\r\n\r\n    const selectConversation = (el) => {\r\n        if(!el.pending){\r\n            console.log(\"Setting current conversation...\", el);\r\n            console.log(history, location);\r\n            setDeleted(false);\r\n            if(location.pathname !== '/home'){\r\n                history.push('/home');\r\n            }\r\n            if(currentConversation.conversationName === el.conversationName){\r\n                //dispatch(setCurrentConversation({conversation: el }));\r\n                dispatch(setView(false)); \r\n                dispatch(setShowConvList(false));\r\n                return; //Speaks for itself\r\n            }\r\n            if(el && el.conversationName !== '' && size.width > 768 && (currentConversation.conversationName !== el.conversationName)){\r\n                //Wide screen shows name\r\n                dispatch(setTopbarMessage(el.conversationName));\r\n            }  \r\n            if(el && el.conversationName !== '' && size.width <= 768 && (currentConversation.conversationName !== el.conversationName)) {\r\n                //Narrow screen only icon\r\n                dispatch(setTopbarMessage(\"\")); \r\n            }\r\n            dispatch(setView(false)); //Set NOT default view\r\n            dispatch(setCurrentConversation({conversation: el })); //Speaks for itself\r\n            //Now that we set the current conv, we going to notify server\r\n            if(chatSocket){\r\n                chatSocket.emit('setCurrentConversation', { user: account, conversationId: el.id }, \r\n                () => console.log(\"Emitted setCurrentConversation successfully\"));\r\n            }\r\n            dispatch(setShowConvList(false)); //Sidebar not showing or narrow\r\n        } else {\r\n            console.log(`Conversation is pending invite accept`, el);\r\n            return;\r\n        }\r\n    }\r\n\r\n    const deleteConversation = (convId) => {\r\n        console.log(\"Deleting Conversation \" + convId);\r\n        if(currentConversation && (currentConversation.id === convId)){\r\n            dispatch(setShowConvList(true)); \r\n            dispatch(setTopbarMessage(\"\"));\r\n            setDeleted(true);\r\n        }\r\n        dispatch(removeConversation({ id: convId }));\r\n    }\r\n\r\n    if(Array.isArray(conversations) && conversations.length > 1){\r\n        conversations = conversations.filter((value, index, self) => {\r\n            return self.indexOf(value) === index;\r\n        })\r\n    }\r\n    \r\n    const listItemMinWidth = getMinWidthListItem(narrowScreen, deleted, showConvList);\r\n    const buttonMargin = getButtonMargin(narrowScreen, showConvList);\r\n    return (\r\n        <Drawer\r\n            variant=\"permanent\"\r\n            classes={{\r\n                paper: getPaper()\r\n            }}\r\n        >\r\n            <Toolbar />\r\n            <div className={classes.drawerContainer}>\r\n                <List style={{ opacity: 0.8 }}>\r\n                <ListItem style={{ maxWidth: \"500px\", maxHeight: \"120px\" }} className=\"text-small text-center mx-auto\" selected={false} key='sidebar-search'>\r\n                   <Container fluid>\r\n                        <InputGroup className=\"mx-auto\">\r\n                                <FormControl\r\n                                    style={{ textAlign: \"center\" }}\r\n                                    placeholder=\"Search\"\r\n                                    aria-label=\"Search\"\r\n                                    aria-describedby=\"basic-addon1\"\r\n                                    onChange={ e => setSearchBar(e.target.value) }\r\n                                    className=\"mx-auto lead form-control-custom\"\r\n                                    autoComplete=\"new-password\"\r\n                                />  \r\n                                <InputGroup.Append style={{ maxWidth: \"30px\" }}>\r\n                                    <Tooltip title=\"Search Chat Names\">\r\n                                        <Button variant=\"dark\" onClick={() => searchChatNames()} className=\"custom-sidebar-search-button\" style={{ backgroundColor: \"#404040\", border: \"none\" }}><SearchOutlined className={(error) ? \"error-icon\" : \"\"} style={{ color: \"#EEEEEE\" }}></SearchOutlined></Button>\r\n                                    </Tooltip>\r\n                                    {\r\n                                      (searchScreen) ?  \r\n                                        <Tooltip title=\"Exit Search\">\r\n                                            <Button variant=\"dark\" onClick={() => setSearchScreen(false)} className=\"custom-sidebar-search-button\" style={{ backgroundColor: \"#404040\", border: \"none\" }}>X</Button>\r\n                                        </Tooltip>\r\n                                        : \"\"\r\n                                    }\r\n                                    \r\n                                </InputGroup.Append>      \r\n                        </InputGroup>\r\n                   </Container>\r\n                </ListItem>\r\n                    {                           \r\n                    (searchScreen) ? \r\n                            filteredConversations.map((conversation) => {\r\n                            if(conversation.pending === true){\r\n                                return \"\"\r\n                            }\r\n                            return ( <ChatListItem\r\n                                        conversation={conversation}\r\n                                        selectConversation={selectConversation}\r\n                                        deleteConversation={deleteConversation}\r\n                                        buttonMargin={buttonMargin} \r\n                                        selected={currentConversation.conversationName === conversation.conversationName} \r\n                                        minWidth={listItemMinWidth}\r\n                                        key={conversation.id}\r\n                                    />) })\r\n                    :\r\n                        conversations.map((conversation) => {\r\n                            if(conversation.pending === true){\r\n                                return \"\"\r\n                            }\r\n                            return ( <ChatListItem\r\n                                conversation={conversation}\r\n                                selectConversation={selectConversation}\r\n                                deleteConversation={deleteConversation}\r\n                                buttonMargin={buttonMargin} \r\n                                selected={currentConversation.conversationName === conversation.conversationName} \r\n                                minWidth={listItemMinWidth}\r\n                                key={conversation.id}\r\n                            />) })\r\n                    }\r\n                </List>\r\n            </div>\r\n        </Drawer>\r\n    )\r\n}","import React from 'react'; \r\nimport {\r\n    selectShowConvList\r\n} from '../store/slices/conversationsSlice'; \r\nimport ChatSocket from '../components/socket/chatSocket';\r\nimport { Container } from 'react-bootstrap'; \r\nimport ChatContainer from '../components/chat/ChatContainer';\r\nimport { useSelector } from 'react-redux'; \r\nimport Sidebar from '../components/sidebar/Sidebar';\r\n\r\nexport default function Home(){ \r\n    const showConvList = useSelector(selectShowConvList)\r\n    return (showConvList) ? (<Sidebar></Sidebar>) :\r\n    (\r\n      <div className=\"w-100 h-100\">\r\n        <ChatSocket></ChatSocket>\r\n        <Sidebar></Sidebar>\r\n        <Container fluid className=\"w-100 h-100\">\r\n          <ChatContainer className=\"w-100 h-100\"></ChatContainer>\r\n        </Container>\r\n      </div>\r\n    )\r\n  }   ","import { useEffect } from 'react';\r\nimport io from \"socket.io-client\";\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport {\r\naddConversation,\r\nremoveConversation,\r\nselectConversations\r\n} from '../../store/slices/conversationsSlice';\r\nimport {\r\naddFriend,\r\nremoveFriend,\r\naddFriendRequest,\r\nselectFriends,\r\ndeclineRequest,\r\nacceptRequest,\r\nselectFriendRequests\r\n} from '../../store/slices/friendsSlice';\r\nimport { selectAccount } from '../../store/slices/accountSettingsSlice';\r\nimport { addReceivedInvite, addSentInvite, selectReceived, selectSent } from '../../store/slices/inviteSlice';\r\nimport { toast } from 'react-toastify';\r\nimport { selectHost } from '../../store/store';\r\n\r\nlet notificationSocket = null;\r\n\r\nconst socketEvents = {\r\n    received: {\r\n        connectSuccess: \"connectSuccess\",\r\n        connectError: \"connectError\",\r\n        inviteReceived: \"inviteReceived\",\r\n        inviteSent: \"inviteSent\",\r\n        inviteSentError: \"inviteSentError\",\r\n        acceptedInvite: \"acceptedInvite\",\r\n        acceptInviteError: \"acceptInviteError\",\r\n        friendRequestSent: \"friendRequestSent\",\r\n        friendRequestSentError: \"friendRequestSentError\",\r\n        friendRequestDeclined: \"friendRequestDeclined\",\r\n        friendRequestDeclinedError: \"friendRequestDeclinedError\",\r\n        friendAdded: \"friendAdded\",\r\n        acceptFriendRequestError: \"acceptFriendRequestError\",\r\n        friendRemoved: \"friendRemoved\",\r\n        friendRemovedError: \"friendRemovedError\",\r\n        refreshNotificationSuccess: \"refreshNotificationSuccess\"\r\n    },\r\n    sent: {\r\n        connect: \"connect\",\r\n        disconnect: \"disconnect\",\r\n        sendInvite: \"sendInvite\",\r\n        acceptInvite: \"acceptInvite\",\r\n        sendFriendRequest: \"sendFriendRequest\",\r\n        declineFriendRequest: \"declineFriendRequest\",\r\n        acceptFriendRequest: \"acceptFriendRequest\",\r\n        removeFriend: \"removeFriend\",\r\n    }\r\n}\r\n\r\nconst idExists = (id, collection) => {\r\n    let res = false;\r\n    if(collection && Array.isArray(collection)){\r\n        for(let el of collection){\r\n            if(el.id === id){\r\n                res = true\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return res;\r\n}\r\n\r\nconst inviteExists = (id, invites) => {\r\n    return idExists(id, invites);\r\n}\r\n\r\nconst friendExists = (id, friends) => {\r\n    return idExists(id, friends);\r\n}\r\n\r\nconst requestExists = (id, requests) => {\r\n    return idExists(id, requests);\r\n}\r\n\r\nconst setupEventListeners = (notificationSocket, dispatch, account, friends, requests, conversations, sentInvites, receivedInvites) => {\r\n    //After passing an enormous amount of shit, this function sets up the notification socket.\r\n    //I need to refactor this, document. I pulled it out of the \"notifications socket\" component below... \r\n    //TODO\r\n    notificationSocket.on(socketEvents.received.connectSuccess, (msg) => {\r\n        console.log(`Successfully connected to notifications namespace with client ID | ${msg.clientId}`);\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.connectError, (msg) => {\r\n        console.log(`Error: cannot connect to notifications namespace... error from server | ${msg.err}`);\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.inviteReceived, (msg) => {\r\n        try {\r\n            console.log(`Handle invite received from user @${msg.user.tagName}`);\r\n            if(inviteExists(msg.invite.id, receivedInvites)){\r\n                console.log(`Error: Invite already received with ID | ${msg.invite.id} |`);\r\n                return;\r\n            }\r\n            if(msg.invite.recipientId === account.id && msg.conv){\r\n                if(conversations){ //Conversations list exists in state\r\n                    if(0 === conversations.filter(el => el.id === msg.invite.conversationId).length){\r\n                        //conversations list doesn't contain the invite's conversation ID, so length is 0\r\n                        //Probably a better way to do this...\r\n                        //So basically, add a new invite/conversation \r\n                        dispatch(addConversation({ conversation: msg.conv }));\r\n                        msg.invite.sender = msg.user;\r\n                        //Set the sender to the received user\r\n                        dispatch(addReceivedInvite(msg.invite));\r\n                        console.log(`Handle invite received successfully from user @${msg.user.tagName} for new conversation ${msg.conv.id}`);\r\n                        toast.info(`Invite received from: @${msg.invite.user.tagName}` , { position: \"top-center\", hideProgressBar: true, pauseOnHover: true} );\r\n                    }\r\n                }\r\n            } \r\n        } catch(err) {\r\n            console.log(`Error: Handle invite received error | ${err}`);\r\n        }\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.inviteSent, (msg) => {\r\n        try {\r\n            console.log(`Handle invite successfully sent event for conversation ${msg.conv.id}`);\r\n            if(inviteExists(msg.invite.id, sentInvites)){\r\n                console.log(`Error: Invite already sent with ID | ${msg.invite.id} |`);\r\n                return;\r\n            }\r\n            if(msg && msg.conv && msg.invite){\r\n                dispatch(addSentInvite(msg.invite));\r\n                console.log(`Invite | ${msg.invite.id} | for conversation | ${msg.conv.id} | saved and successfully added to state`);\r\n                toast.info(`Invite successfully sent!` , { position: \"top-center\", hideProgressBar: true, pauseOnHover: true });\r\n            } else {\r\n                throw `Error: Invite sent data received from the server is malformed | ${msg}`;\r\n            }\r\n        } catch(err) {\r\n            console.log(\"Error with sending invite from server\", err);\r\n        }\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.inviteSentError, (msg) => {\r\n        console.log(`Handle invite sent error from server | ${msg.msg}`);\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.acceptedInvite, (msg) => {\r\n        console.log(`Handle conversation invite accepted by user ID | ${msg.invite.recipientId}`); \r\n        if(msg.conv && msg.invite && msg.invite.senderId === account.id){\r\n            //Event from server, with NOT pending conversation object, emitted to the sender of the conversation invite\r\n            console.log(`Setting conversation with ID | ${msg.conv.id} | to not pending for sender`); \r\n            dispatch(removeConversation({ id: msg.conv.id }));\r\n            dispatch(addConversation({ conversation: msg.conv }));\r\n            const user = friends.filter(el => el.id === msg.invite.recipientId)[0];\r\n            if(user) toast.info(`Conversation Invite accepted by @${user.tagName}` , { position: \"top-center\", hideProgressBar: true, pauseOnHover: true} );\r\n            else console.log(`Error: friend with ID | ${msg.invite.senderId} | does not exist, cannot accept conversation!`, msg.invite, friends);\r\n            return;\r\n        } else if(msg.conv && msg.invite && msg.invite.recipientId === account.id){\r\n            //Event from server, with NOT pending conversation object, emitted back to the recipient of the conversation invite after they accept\r\n            console.log(`Setting conversation with ID | ${msg.conv.id} | to not pending`); \r\n            //dispatch(removeConversation({ id: msg.conv.id }));\r\n            dispatch(addConversation({ conversation: msg.conv }));\r\n            const user = friends.filter(el => el.id === msg.invite.senderId)[0];\r\n            if(user) toast.info(`Conversation Invite accepted by @${user.tagName}` , { position: \"top-center\", hideProgressBar: true, pauseOnHover: true} );\r\n            else console.log(`Error: friend with ID | ${msg.invite.senderId} | does not exist, cannot accept conversation!`, msg.invite, friends);\r\n            return;\r\n        } else {\r\n            console.log(`Error: accepted invite data from server incorrectly formatted!`, msg);\r\n        }\r\n    });    \r\n\r\n    notificationSocket.on(socketEvents.received.acceptInviteError, (msg) => {\r\n        console.log(`Handle accept invite error from server | ${msg.msg}`);\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.friendRequestSent, (msg) => {\r\n        console.log(`Handle friend request sent event`);\r\n        if(msg && msg.friendRequest){\r\n            const recId = msg.friendRequest.recipientId;\r\n            const senderId = msg.friendRequest.sender.id;\r\n            if(recId === account.id){\r\n                //Recipient of friend request\r\n                if(friendExists(senderId, friends)){\r\n                    console.log(`Error: Cannot receive a friend request from user that is already in friend's list!`, msg.friendRequest.sender, friends);\r\n                    return;\r\n                } else {\r\n                    dispatch(addFriendRequest(msg.friendRequest));\r\n                    toast.info(`Friend request received from user @${msg.friendRequest.sender.tagName}`, { position: \"top-center\", hideProgressBar: true, pauseOnHover: true} );\r\n                    console.log(`Successfully received friend request with ID | ${msg.friendRequest.id} | and added to state`);\r\n                    return;\r\n                }\r\n            } else if(senderId === account.id){\r\n                //Sender of friend request\r\n                if(friendExists(recId, friends)){\r\n                    console.log(`Error: Cannot send a friend request to a user that is already in friend's list!`, msg.friendRequest.recipientId, friends);\r\n                    return;\r\n                } else {\r\n                    dispatch(addFriendRequest(msg.friendRequest));\r\n                    toast.info(`Successfully sent friend request to ${msg.friendRequest.recipientId}`,  { position: \"top-center\", hideProgressBar: true, pauseOnHover: true})\r\n                    console.log(`Successfully sent friend request with ID | ${msg.friendRequest.id} | and added to state`);\r\n                    return;\r\n                }\r\n            } else {\r\n                console.log(`Error: Friend request object does not contain a user with ID equal to this account!`, msg.friendRequest);\r\n                return;\r\n            }\r\n        } else {\r\n            console.log(`Error: malformed friend request sent event message object! ${msg}`);\r\n            return;\r\n        }\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.friendRequestSentError, (msg) => {\r\n        console.log(`Error: friend request sent server error | ${msg.msg}`);\r\n        toast.warning(`Server error: friend request not sent! ${msg.err}` , { position: \"top-center\", hideProgressBar: true, pauseOnHover: true})\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.friendRequestDeclined, (msg) => {\r\n        console.log(`Handle friend request declined event`);\r\n        if(msg && msg.friendRequest){\r\n            const recId = msg.friendRequest.recipientId;\r\n            const senderId = msg.friendRequest.sender.id;\r\n            if(false === requestExists(msg.friendRequest.id, requests)){\r\n                //Request doesn't exist, can't decline a request that doesn't exist!\r\n                console.log(`Error: cannot mark a friend request as declined if it does not exist! Request with ID: ${msg.friendRequest.id}`);\r\n                return;\r\n            } else {\r\n                if(recId === account.id){\r\n                    if(friendExists(senderId, friends)){\r\n                        console.log(`Friend exists in state. Declining new friend request will result in deleted friendship.`);\r\n                        dispatch(removeFriend(senderId));\r\n                    } \r\n                    //If you declined the friend request, check if friend exists just in case and delete \r\n                    //And mark the request in the state with the same ID as declined/cancelled (whatever the property is in this redux state compared to the database, where it's \"cancelled\" as a boolean)\r\n                    dispatch(declineRequest(msg.friendRequest.id));\r\n                    console.log(`Successfully marked friend request with ID | ${msg.friendRequest.id} | as declined in state`, requests);\r\n                    return;\r\n                } else if(senderId === account.id){\r\n                    //If you sent the request and now it's being declined, check if friend exists and delete\r\n                    //Mark the request in the state as declined \r\n                    //Ensure that the user cannot request friendship with the user in the future (save the request, mark it as cancelled, on next outbound friendRequestSend check for any requests with same user ID && cancelled/declined)\r\n                    if(friendExists(recId, friends)){\r\n                        console.log(`Friend exists in state. Declined friend request will result in deleted friendship.`);\r\n                        dispatch(removeFriend(recId));\r\n                    } \r\n                    dispatch(declineRequest(msg.friendRequest.id));\r\n                    toast.warning(`Friend request declined`, { position: \"top-center\", hideProgressBar: true, pauseOnHover: true});\r\n                    console.log(`Successfully marked friend request with ID | ${msg.friendRequest.id} | as declined in state`, requests);\r\n                    return;\r\n                } else {\r\n                    console.log(`Error: cannot mark friend request as declined. Current user is not friend request sender or recipient`);\r\n                    return;\r\n                }\r\n            }\r\n        } else {\r\n            console.log(`Error: cannot mark friend request as declined. Malformed message object from the server`);\r\n            return;\r\n        }\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.friendRequestDeclinedError, (msg) => {\r\n        console.log(`Error: server error while declining friend request ${msg.msg}`);\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.friendAdded, (msg) => {\r\n        console.log(`Handle friend added event`);\r\n        if(msg && msg.friendRequest && msg.acceptor){\r\n            const requestId = msg.friendRequest.id;\r\n            const sender = msg.friendRequest.sender;\r\n            const acceptor = msg.acceptor;\r\n            const acceptorId = acceptor.id;\r\n            //First check for the request and mark it as accepted \r\n            //If it doesn't error out\r\n            if(requestExists(requestId, requests)){\r\n                console.log(`Marking request with ID | ${requestId} | as accepted in the state`);\r\n                dispatch(acceptRequest(requestId));\r\n            } else {\r\n                console.log(`Error: Friend Request with ID | ${requestId} | does not exist, cannot mark as accepted and add friend from it`);\r\n                return;\r\n            }\r\n            if(acceptorId === account.id){\r\n                //This user accepted the friendship, will add SENDER profile into redux state \r\n                //First, check if exists in friends already, return if so\r\n                if(friendExists(sender.id, friends)){\r\n                    console.log(`Error: cannot add new friend that already exists`, friends, sender);\r\n                    return;\r\n                } else {\r\n                    console.log(`Adding new friend @${sender.tagName} to friend's list`, sender);\r\n                    dispatch(addFriend(sender));\r\n                    return;\r\n                }\r\n            } else if(sender.id === account.id) {\r\n                //This user sent the request, and it was accepted by the other user. Now they input the \r\n                //acceptor profile into the redux state\r\n                if(friendExists(acceptorId, friends)){\r\n                    console.log(`Error: cannot add new friend that already exists`, friends, acceptor);\r\n                    return;\r\n                } else {\r\n                    console.log(`Adding new friend @${acceptor.tagName} to friend's list`, acceptor);\r\n                    dispatch(addFriend(acceptor));\r\n                    return;\r\n                }\r\n            } else {\r\n                console.log(`Error: Friend request sender and recipient do not have IDs associated with current user`, msg.friendRequest, account.id);\r\n                return;\r\n            }\r\n        } else {\r\n            console.log(`Error: received friend request object from server is malformed`, msg);\r\n            return;\r\n        }\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.acceptFriendRequestError, (msg) => {\r\n        console.log(`Error: server error while accept friend request action performed ${msg.msg}`);\r\n    });\r\n\r\n    notificationSocket.on(socketEvents.received.friendRemoved, (msg) => {\r\n        console.log(`Handle friend removed event`);\r\n        if(msg && msg.exFriend1 && msg.exFriend2){\r\n            const friend1 = msg.exFriend1;\r\n            const friend2 = msg.exFriend2;\r\n            if(friend1 === account.id){\r\n                if(friendExists(friend2, friends)){\r\n                    const friend = friends.filter(el => el.id === friend2)[0];\r\n                    console.log(`Removing friend from friend's list`, friend);\r\n                    dispatch(removeFriend(friend2));\r\n                    return;\r\n                } else {\r\n                    console.log(`Error: friend with ID | ${friend2} | does not exist in friend's list, cannot remove`);\r\n                    return;\r\n                }\r\n            } else if(friend2 === account.id){\r\n                if(friendExists(friend1, friends)){\r\n                    const friend = friends.filter(el => el.id === friend1)[0];\r\n                    console.log(`Removing friend from friend's list`, friend);\r\n                    dispatch(removeFriend(friend1));\r\n                    return;\r\n                } else {\r\n                    console.log(`Error: friend with ID | ${friend1} | does not exist in friend's list, cannot remove`);\r\n                    return;\r\n                }\r\n            } else {\r\n                console.log(`Error: remove friend event does not have IDs associated with the current user or user's friend list`, friends, msg);\r\n                return;\r\n            }\r\n        } else {\r\n            console.log(`Error: remove friend event handler received a malformed message object from server`, msg);\r\n        }\r\n    });\r\n    notificationSocket.on(socketEvents.received.friendRemovedError, (msg) => {\r\n        console.log(`Error: Friend removed server error | ${msg.msg}`);\r\n    });\r\n    notificationSocket.on(socketEvents.received.refreshNotificationSuccess, (msg) => {\r\n        console.log(`Successfully refreshed notification socket and set client ID to ${msg.clientId}`);\r\n    });\r\n}\r\n\r\nexport default function NotificationSocket(){\r\n    const account = useSelector(selectAccount)\r\n    const dispatch = useDispatch();\r\n    const conversations = useSelector(selectConversations)\r\n    const host = useSelector(selectHost);\r\n    const sentInvites = useSelector(selectSent);\r\n    const receivedInvites = useSelector(selectReceived);\r\n    const friends = useSelector(selectFriends);\r\n    const requests = useSelector(selectFriendRequests);\r\n\r\n    const teardownEventListeners = (notificationSocket) => {\r\n        if(notificationSocket == null || !notificationSocket){\r\n            return true;\r\n        }\r\n        for(let key in socketEvents.received){\r\n            notificationSocket.off(socketEvents.received[key]);\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        console.log(\"Attemping to establish notifications socket\");\r\n        const notificationSocketOptions = {\r\n            transportOptions: {\r\n                polling: {\r\n                    extraHeaders: {\r\n                        credentials: \"include\"\r\n                    }\r\n                }\r\n            },\r\n            forceNew: true\r\n        }\r\n        if(account.loggedIn === true){\r\n            try {\r\n                console.log(\"Attemping connection to notifications socket gateway\");\r\n                notificationSocket = io(`${host}/notifications`, notificationSocketOptions);\r\n                setupEventListeners(notificationSocket, dispatch, account, friends, requests, conversations, sentInvites, receivedInvites);\r\n                notificationSocket.emit('refreshNotificationSocket', { userId: account.id } );\r\n                console.log(\"Successfully setup notifications socket\");\r\n                return () => {\r\n                    teardownEventListeners(notificationSocket);\r\n                }\r\n            } catch(err) {\r\n                console.log(\"Error establishing notifications notificationSocket\", err)\r\n            }\r\n        }\r\n        return () => {\r\n            if(notificationSocket) {\r\n                Object.keys(socketEvents.received).map(el => notificationSocket.off(el));\r\n                notificationSocket.close();    \r\n                notificationSocket = null;\r\n            }\r\n        }\r\n        \r\n    }, [account?.loggedIn]);\r\n    return null;\r\n}\r\n\r\nexport { notificationSocket };","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Row, Col, InputGroup, FormControl, Button, Container } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport EnhancedEncryptionIcon from '@material-ui/icons/EnhancedEncryption';\r\nimport regex from '../../util/regex';\r\nimport './modal.css';\r\nexport default function PasswordModalBody({ handleSetConvPassword }) {\r\n    const [pw, setPW] = useState(\"\");\r\n    const [error, setError] = useState(false);\r\n    const errorMsgs = useRef([]);\r\n    const setPwRef = useRef(null);\r\n    const checkInput = () => {\r\n        let passing = true;\r\n        if(regex.password.test(pw) === false) {\r\n            passing = false;\r\n            errorMsgs.current.push(\"Invalid Password. Must be 8-32 characters\");\r\n        }\r\n        if(!passing) setError(true); \r\n        return passing;\r\n    }\r\n    const submit = () => {\r\n        setError(false);\r\n        errorMsgs.current = [];\r\n        if(!checkInput()) {\r\n            console.log(\"Error with password\", errorMsgs);\r\n            return;\r\n        }\r\n        handleSetConvPassword(pw);\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(setPwRef.current != null)\r\n            setPwRef.current.focus();\r\n    }, [setPwRef]);\r\n\r\n    return (\r\n        <div className=\"modal-password-set\">\r\n            <Container fluid>\r\n                <Row className=\"pt-2 pb-3\">\r\n                    <Col className=\"mx-auto text-center pt-3\">\r\n                        <EnhancedEncryptionIcon style={{ width: 42, height: 42 }}></EnhancedEncryptionIcon>\r\n                    </Col>\r\n                </Row>\r\n                <Row>\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <h5>Set Password</h5>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"pt-2 pb-2\">\r\n                    <Col style={{ borderBottom: \"1px solid #303030\"}} className=\"mx-auto text-center\" xs=\"10\">\r\n                        <InputGroup className=\"mb-3 mt-2 mx-auto\">\r\n                                <FormControl\r\n                                    style={{ fontSize: \"18pt\", textAlign: \"center\", color: \"white\", minHeight: '50px', border: 'none', minWidth: \"80%\", backgroundColor: \"#252525\" }}\r\n                                    placeholder=\"Enter Password\"\r\n                                    type=\"password\"\r\n                                    aria-label=\"Enter Password\"\r\n                                    aria-describedby=\"basic-addon1\"\r\n                                    onChange={ e => {\r\n                                        setPW(e.target.value);\r\n                                    }}\r\n                                    className={ (error) ? \"mx-auto lead form-control-red\" : \"mx-auto lead form-control-custom\"}\r\n                                    ref={setPwRef}\r\n                                    autoComplete=\"new-password\"\r\n                                    name=\"setPWNewConv\"\r\n                                />\r\n                        </InputGroup>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"pt-3 mt-2\">\r\n                    <Col className=\"mx-auto text-center\" xs=\"10\">\r\n                        <Button onClick={ () => submit() } variant=\"outline-success\" size=\"lg\" style={{ backgroundColor: \"#252525\", marginLeft: \"auto\", marginRight: \"auto\"}} className=\"p-3 rounded-pill\">Set Password</Button>\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nPasswordModalBody.propTypes = {\r\n    handleSetConvPassword: PropTypes.func\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { Row, Col, Button } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport './listitems.css';\r\nimport '../topbar/topbar.css';\r\n\r\nexport default function FriendCheckBoxListItem({ tagName, onCheck }){\r\n    const [checked, setChecked] = useState(false);\r\n    const check = () => {\r\n        setChecked(!checked);\r\n    }\r\n    useEffect(() => {\r\n        onCheck(tagName, checked);\r\n    }, [checked]);\r\n    return (\r\n        <Row className=\"p-2\">\r\n            <Col className=\"text-center justify-content-around\">\r\n                <Button onClick={() => check()} className={(checked) ? \"p-3 m-2 account-button-checked\" : \"p-3 m-2 account-button\"} variant=\"dark\" style={{ border: \"none\", backgroundColor: \"#202020\", padding: \"15px\", minWidth: \"150px\", maxWidth: \"150px\", minHeight: \"125px\", maxHeight: \"125px\" }} >@{tagName}</Button>\r\n            </Col> \r\n        </Row>    \r\n    )\r\n}\r\n\r\nFriendCheckBoxListItem.propTypes = {\r\n    tagName: PropTypes.string, \r\n    onCheck: PropTypes.func\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Row, Col, InputGroup, FormControl, Button, Container } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport { selectFriends } from '../../store/slices/friendsSlice';\r\nimport { useSelector } from 'react-redux';\r\nimport regex from '../../util/regex.js';\r\nimport { SearchOutlined } from '@material-ui/icons';\r\nimport FriendListItemCheckBox from '../listItems/FriendCheckBox';\r\n\r\nexport default function SelectFriendsListView({ \r\n        errorSearch, \r\n        selectedFriends, \r\n        setSelectedFriends, \r\n        setErrorSearch, \r\n        setError, \r\n        errorMsgs,\r\n        setButtonsDisabled\r\n    }){\r\n    const friends = useSelector(selectFriends); \r\n    const [searchBar, setSearchBar] = useState(\"\");\r\n    const [filteredFriends, setFilteredFriends] = useState([]);\r\n\r\n    useEffect(() => {\r\n        setFilteredFriends(JSON.parse(JSON.stringify(friends)));\r\n    }, [friends]);\r\n\r\n    useEffect(() => {\r\n        if(selectedFriends.length < 1){\r\n            setButtonsDisabled(true);\r\n            console.log(\"Buttons disabled\")\r\n        } else {\r\n            setButtonsDisabled(false);\r\n            console.log(\"Buttons enabled\")\r\n        }\r\n    }, [selectedFriends]);\r\n\r\n    const filterList = () => {\r\n        setErrorSearch(false);\r\n        setError(false);\r\n        errorMsgs.current = []\r\n        if(regex.tagName.test(searchBar) === false){\r\n            setErrorSearch(true);\r\n            setError(true);\r\n            setSearchBar(\"\");\r\n            errorMsgs.current.push(\"Invalid tagname for search\");\r\n            return;\r\n        }\r\n        setFilteredFriends(filteredFriends.filter(friend => (friend.tagName.includes(searchBar) || searchBar.includes(friend.tagName))));\r\n    }\r\n    const handleCheck = (tagName, checked) => {\r\n        const arr = JSON.parse(JSON.stringify(selectedFriends));\r\n        if(checked){\r\n            if(selectedFriends.length > 0){\r\n                if(selectedFriends.filter(fr => fr === tagName).length > 1){\r\n                    return;\r\n                } else {\r\n                    arr.push(tagName)\r\n                    setSelectedFriends(arr);\r\n                    return;\r\n                }\r\n            } else {\r\n                setSelectedFriends([tagName]);\r\n                return;\r\n            }   \r\n        } else {\r\n            if(selectedFriends.length > 0){\r\n                if(selectedFriends.filter(fr => fr === tagName).length > 0){\r\n                    setSelectedFriends(selectedFriends.filter(fr => fr !== tagName));\r\n                    return;\r\n                } else {\r\n                    return;\r\n                }\r\n            } else {\r\n                setSelectedFriends([]);\r\n            }\r\n        }\r\n    }\r\n    return (\r\n        <Container fluid>\r\n            <Row className=\"pb-3\">\r\n                <Col xs=\"2\"></Col>\r\n                <Col xs=\"8\" className=\"border-bottom border-dark\" style={{ maxWidth: \"450px\" }}>\r\n                    <InputGroup className=\"mb-3 mt-2 mx-auto\">\r\n                        <FormControl\r\n                            style={{ textAlign: \"center\", fontSize: \"18pt\", color: \"#EEEEEE\", opacity: 0.8, minHeight: '50px', border: 'none', backgroundColor: \"#191919\" }}\r\n                            placeholder=\"Search friends\"\r\n                            aria-label=\"Search friends\"\r\n                            aria-describedby=\"basic-addon1\"\r\n                            onChange={ e => setSearchBar(e.target.value) }\r\n                            className={ (errorSearch) ? \"mx-auto lead form-control-red font-italic\" : \"mx-auto lead form-control-custom font-italic\"}\r\n                            value={searchBar}\r\n                            autoComplete=\"new-password\"\r\n                            />\r\n                        </InputGroup>\r\n                </Col>\r\n                <Col xs=\"2\" style={{ maxWidth: \"50px\" }}>\r\n                    <Button onClick={() => { filterList() }} variant=\"dark\" style={{ marginTop: \"10px\", display: \"block\", backgroundColor: \"#191919\", border: \"none\" }}><span className=\"text-primary text-lg-center\"><SearchOutlined style={{ color: \"#BBBBBB\", height: 35, width: 35, cursor: \"pointer\"}}></SearchOutlined></span></Button>\r\n                </Col>\r\n            </Row>\r\n            <Row className=\"mb-2\">\r\n                <Col className=\"mx-auto\">\r\n                    <span className=\"font-italic text-small\" style={{ color: \"dodgerblue\"}}>Select Friends For Chat</span>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col xs=\"2\"></Col>\r\n                <Col xs=\"8\" style={{ maxWidth: \"500px\" }}>\r\n                    <Container fluid style={{ minHeight: \"225px\", overflowY: \"scroll\", backgroundColor: \"#191919\"}}>\r\n                        {\r\n                            (filteredFriends && filteredFriends.length > 0) ?\r\n                            (\r\n                                filteredFriends.map((friend) => {\r\n                                    return (\r\n                                        <FriendListItemCheckBox key={friend.id} id={friend.id} tagName={friend.tagName} onCheck={handleCheck}></FriendListItemCheckBox>\r\n                                    );\r\n                                }) \r\n                            )\r\n                            : \r\n                            <Row className=\"mb-4\">\r\n                                <Col className=\"mx-auto text-center text-muted font-italic pt-5\">\r\n                                    No friends available! Add a friend!\r\n                                </Col>\r\n                            </Row>\r\n                        }\r\n                    </Container>\r\n                </Col>\r\n                <Col xs=\"2\"></Col>\r\n            </Row>\r\n        </Container>\r\n    )\r\n}\r\n\r\nSelectFriendsListView.propTypes = {\r\n    errorSearch: PropTypes.bool,\r\n    selectedFriends: PropTypes.array, \r\n    setSelectedFriends: PropTypes.func, \r\n    setErrorSearch: PropTypes.func,\r\n    setError: PropTypes.func,\r\n    errorMsgs: PropTypes.array,\r\n    setButtonsDisabled: PropTypes.func\r\n}","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Row, Col, InputGroup, FormControl, Button, Container } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport { selectAccount } from '../../store/slices/accountSettingsSlice';\r\nimport { selectFriends } from '../../store/slices/friendsSlice';\r\nimport { selectConversations } from '../../store/slices/conversationsSlice';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport useWindowSize from '../../util/windowSize';\r\nimport regex from '../../util/regex.js';\r\nimport EnhancedEncryptionIcon from '@material-ui/icons/EnhancedEncryption';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport { notificationSocket } from '../socket/notificationSocket';\r\nimport { Modal } from '@material-ui/core';\r\nimport PasswordModalBody from '../modals/SetPWModal';\r\nimport { setTopbarMessage } from '../../store/slices/uiSlice';\r\nimport SelectFriendsListView from './SelectFriendsListView';\r\nimport { toast } from 'react-toastify'; \r\n\r\nexport function EnterChatName({ setConversationName, errorName }){\r\n    const enterChatRef = useRef(null);\r\n    useEffect(() => {\r\n        if(enterChatRef.current){\r\n            enterChatRef.current.focus();\r\n        }\r\n    }, [enterChatRef.current]);\r\n    return (\r\n        <Container fluid style={{ maxWidth: \"500px\" }}>\r\n            <InputGroup className=\"mt-2 mx-auto\">\r\n                <FormControl\r\n                    style={{ textAlign: \"center\", fontSize: \"22pt\", color: \"#d9534f\", minHeight: '50px', border: 'none', backgroundColor: \"#191919\" }}\r\n                    placeholder=\"Enter Chat Name\"\r\n                    aria-label=\"Enter Chat Name\"\r\n                    aria-describedby=\"basic-addon1\"\r\n                    onChange={ e => setConversationName(e.target.value) }\r\n                    className={ (errorName) ? \"mx-auto lead form-control-red\" : \"mx-auto lead form-control-custom\"}\r\n                    autoComplete=\"new-password\"\r\n                    name=\"setNameNewConv\"\r\n                    ref={enterChatRef}\r\n                    />\r\n            </InputGroup>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default function NewConversation(){\r\n    const conversations = useSelector(selectConversations);\r\n    const account = useSelector(selectAccount);\r\n    const [conversationName, setConversationName] = useState(\"\");\r\n    const size = useWindowSize();\r\n    const [error, setError] = useState(false);\r\n    const [selectedFriends, setSelectedFriends] = useState([]);\r\n    const [errorName, setErrorName] = useState(false);\r\n    const [errorSearch, setErrorSearch] = useState(false);\r\n    const [buttonsDisabled, setButtonsDisabled] = useState(true);\r\n    const newName = useRef(null);\r\n    const errorMsgs = useRef([]);\r\n    const [passwordOpened, setPasswordOpened] = useState(false);\r\n    const [convPassword, setConvPassword] = useState(\"\");\r\n   // const [backgroundImage, setBackgroundImage] = useState(\"\");\r\n    const dispatch = useDispatch();\r\n    const friends = useSelector(selectFriends);\r\n    const wide = size.width > 768;\r\n    const checkInput = () => {\r\n        let passing = true;\r\n        //First check if name is okay\r\n        if(regex.conversationName.test(conversationName) === false){\r\n            errorMsgs.current.push(\"Invalid Conversation Name\");\r\n            setErrorName(true);\r\n            passing = false;\r\n        }\r\n        //Next check if name already exists\r\n        if(conversations.filter(conv => conv.conversationName === conversationName).length === 1){\r\n            errorMsgs.current.push(\"Conversation with that name already exists\");\r\n            setErrorName(true);\r\n            passing = false;\r\n        }\r\n        if(passing === true){\r\n            //check each friend and if tag if it exists in friends list\r\n            for(let friendTag of selectedFriends){\r\n                //if friends list doesnt include a friend with the tagname\r\n                if(!friends.some(fr => fr.tagName === friendTag)){\r\n                    errorMsgs.current.push(`Friend with tagname ${friendTag} isn't in your friends list`);\r\n                    passing = false;\r\n                    break;\r\n                }\r\n            }\r\n            //check if users are already in a conversation with you\r\n            //Deep compare the users array, filtering out self (JSON.stringify works, no functions are declared just data?)\r\n            for(let conv of conversations) {\r\n                const otherUsers = (conv.users.filter(user => user.id !== account.id)).map(user => { return user.tagName });\r\n                if(otherUsers && otherUsers.length > 0 && JSON.stringify(otherUsers) === JSON.stringify(selectedFriends)){\r\n                    errorMsgs.current.push(`Chat named \"${conv.conversationName}\" with selected friends exists`);\r\n                    passing = false;\r\n                    break;\r\n                } \r\n            }\r\n        }\r\n        if(!passing) setError(true);\r\n        return passing;\r\n    }\r\n    const handleSetConvPassword = (value) => {\r\n        convPassword.split(\"\").join(\"\");\r\n        setConvPassword(value);\r\n    }\r\n    // const handleSetBackgroundImage = (value) => {\r\n    //     setBackgroundImage(value);\r\n    // }\r\n    const submit = () => {\r\n        errorMsgs.current = [];\r\n        setError(false);\r\n        setErrorName(false);\r\n        setErrorSearch(false);\r\n        if(!checkInput()){\r\n            console.log(\"Errors: \", errorMsgs);\r\n            return;\r\n        } \r\n        console.log(\"Creating new conversation and sending invites to users from friends list. Users: \", selectedFriends);\r\n        for(let user of selectedFriends){\r\n            if(notificationSocket){\r\n                notificationSocket.emit('sendInvite', { sender: account, tagName: user, conversationName: conversationName }, () => {\r\n                    console.log(\"Successfully emitted send invite to user with tagname\", user);\r\n                });\r\n            }\r\n        }\r\n        toast.info(`Successfully sent out conversation invites!`,  { position: \"top-center\", hideProgressBar: true, pauseOnHover: true});\r\n    }\r\n    useEffect(() => {\r\n        if(newName && newName.current){\r\n            newName.current.focus();\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if(size.width > 768) {\r\n            dispatch(setTopbarMessage((<span>New Conversation</span>)));\r\n        } else {\r\n            dispatch(setTopbarMessage((<span>New Conversation</span>)));\r\n        }\r\n    }, [size.width]);\r\n\r\n    return (\r\n        <Container className=\"h-100 w-100\" fluid  style={{ margin: \"auto\", paddingLeft: (wide) ?  \"240px\" : \"20px\" }}>\r\n            <Row>\r\n                <Col className=\"mx-auto text-center\" style={{ opacity: 0.8, borderRadius: \"10px\", backgroundColor: \"#191919\", maxWidth: \"600px\" }}>\r\n                    <Container fluid>       \r\n                        <Row className=\"mt-2 mb-2\">\r\n                        <EnterChatName \r\n                            setConversationName={setConversationName} \r\n                            errorName={errorName}\r\n                        />\r\n                        </Row>\r\n                        <Row className=\"mt-2 mb-2 pb-2\">\r\n                            <SelectFriendsListView \r\n                                errorSearch={errorSearch} \r\n                                selectedFriends={selectedFriends}\r\n                                setSelectedFriends={setSelectedFriends}\r\n                                setErrorSearch={setErrorSearch}\r\n                                setError={setError}\r\n                                errorMsgs={errorMsgs}\r\n                                setButtonsDisabled={setButtonsDisabled}\r\n                            />\r\n                        </Row>\r\n                        <Row className=\"pt-3\">\r\n                            <Modal\r\n                                open={passwordOpened}\r\n                                onClose={() => setPasswordOpened(false)}\r\n                                aria-labelledby=\"simple-modal-title\"\r\n                                aria-describedby=\"simple-modal-description\"\r\n                            >\r\n                                <PasswordModalBody handleSetConvPassword={handleSetConvPassword} ></PasswordModalBody>\r\n                            </Modal>\r\n                            <Col className=\"mx-auto\">\r\n                                <Button \r\n                                    onClick={ () => setPasswordOpened(true) } \r\n                                    disabled={buttonsDisabled} \r\n                                    className=\"rounded-pill p-2 mx-auto\" \r\n                                    variant=\"outline-info\" \r\n                                    size=\"lg\"\r\n                                    style={{ opacity: (buttonsDisabled) ? 0.5 : 1.0, maxWidth: '200px', marginTop: \"20px\" }}\r\n                                    >\r\n                                    Set&nbsp;Password&nbsp;<EnhancedEncryptionIcon style={{ width: 25, height: 25 }}></EnhancedEncryptionIcon>\r\n                                </Button>\r\n                            </Col>\r\n                        </Row>\r\n                        <Row>\r\n                            <Col className=\"mx-auto\">\r\n                                <Button \r\n                                    onClick={ () => submit()} \r\n                                    disabled={buttonsDisabled} \r\n                                    className=\"rounded-pill p-2 mx-auto\" \r\n                                    variant=\"outline-success\" \r\n                                    size=\"lg\"\r\n                                    style={{ opacity: (buttonsDisabled) ? 0.5 : 1.0, maxWidth: '200px', marginTop: \"20px\" }}\r\n                                    >\r\n                                    Sent Chat Invites <SendIcon style={{ width: 25, height: 25 }}></SendIcon>\r\n                                </Button>\r\n                            </Col>\r\n                        </Row>\r\n                        <Row className=\"pt-2 mt-2\">\r\n                            <Col>\r\n                                <ul>\r\n                                    {(error) ?\r\n                                        errorMsgs.current.map(el => (<li key={el} className=\"text-danger text-small\">{el}</li>)) : \"\" }\r\n                                </ul>\r\n                            </Col>\r\n                        </Row>\r\n                    </Container>\r\n                </Col>\r\n            </Row>\r\n        </Container>)\r\n}\r\n\r\nEnterChatName.propTypes = {\r\n    setConversationName: PropTypes.func,\r\n    errorName: PropTypes.bool\r\n}\r\n","import React from 'react'; \r\nimport { Container } from 'react-bootstrap';\r\nimport NewConversation from '../components/newConversation/NewConversation';\r\nimport Sidebar from '../components/sidebar/Sidebar';\r\nexport default function NewConversationScreen(){\r\n  return (\r\n    <div className=\"w-100 h-100\">\r\n      <Sidebar></Sidebar>\r\n      <Container fluid className=\"w-100 h-100\">\r\n        <NewConversation></NewConversation>\r\n      </Container>\r\n    </div>\r\n  )\r\n}","import React from 'react';\r\nimport { Row, Col, Container } from 'react-bootstrap';\r\nimport { Typography } from '@material-ui/core';\r\nimport './settings-modal.css';\r\n\r\nexport default function About() {\r\n    return (\r\n        <div className=\"settings-modal\">\r\n            <Container fluid>\r\n                <Row>\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <h5 className=\"text-danger\">About Project Zed</h5>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"pt-2 pb-2\">\r\n                    <Col className=\"mx-auto text-center text-white\" xs=\"12\">\r\n                    <Typography>\r\n                            Blah blah blah this is my open source version of realtime e2e encrypted messaging.\r\n                            Email me at jakestevens081@gmail.com for questions. \r\n                            www.github.com/jakesteve28\r\n                            Wanna contribute to this? Email me!\r\n                    </Typography>\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n        </div>\r\n    )\r\n}","import React, { useState, useRef } from 'react';\r\nimport { Row, Col, Container, InputGroup, FormControl, Button } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport regex from '../../util/regex';\r\nimport './settings-modal.css';\r\n\r\nexport default function ChangeTagname({ logoutAccount }) {\r\n    const [newTagname, setNewTagname] = useState(\"\");\r\n    const [tagNameError, setTagnameError] = useState(false);\r\n    const errorMsgs = useRef([]);\r\n\r\n    const checkInput = () => {\r\n        let passing = true; \r\n        if(regex.tagName.test(newTagname) === false) {\r\n            console.log(\"Error: new tagname failed regex test\");\r\n            errorMsgs.current.push(\"Error: new tagname failed regex test\");\r\n            passing = false;\r\n        }\r\n        if(!passing) setTagnameError(true);\r\n        return passing;\r\n    }\r\n\r\n    const submit = () => {\r\n        errorMsgs.current = []\r\n        setTagnameError(false);\r\n        if(!checkInput()){\r\n            return; \r\n        } else {\r\n            alert(\"Tagname changed successfully?\");\r\n            logoutAccount();\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"settings-modal\">\r\n            <Container fluid>\r\n                <Row>\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <h3>Change Tagname</h3>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"mb-2\">\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <span className=\"text-warning\">Note that this is permanent, will require a logout, and will automatically update your friends lists.</span>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"pt-2 pb-2 mb-1\">\r\n                    <Col className=\"mx-auto text-center text-white\" xs=\"12\">\r\n                        <InputGroup>\r\n                          <FormControl\r\n                            style={{marginLeft: \"auto\", maxWidth: \"300px\", marginRight: \"auto\", color: \"white\", opacity: 0.87, minWidth: \"200px\", minHeight: '50px', backgroundColor: \"#212121\", border: 'none' }}\r\n                            placeholder=\"Enter desired Tagname\"\r\n                            aria-label=\"Enter desired Tagname\"\r\n                            aria-describedby=\"basic-addon1\"\r\n                            className={(tagNameError) ? \"change-tagname-input error-placeholder\" : \"change-tagname-input\"}\r\n                            onChange={(e) => { setNewTagname(e.target.value) }}\r\n                          />\r\n                        </InputGroup>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"mb-2\">\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <span className=\"text-muted font-italic\">Must be 8-24 letters, numbers, dashes or underscores</span>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"pt-2 mt-2\">\r\n                    <Col className=\"text-center\">\r\n                        <Button onClick={() => submit()} variant=\"outline-success\" size=\"lg\" style={{ padding: \"10px\"}}>Submit</Button>\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nChangeTagname.propTypes = {\r\n    logoutAccount: PropTypes.func\r\n}","import React from 'react';\r\nimport { Row, Col, Container, Button } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport './settings-modal.css';\r\nimport { Typography } from '@material-ui/core';\r\nimport { DeleteForever } from '@material-ui/icons';\r\n\r\nexport default function DeleteAccount({ logoutAccount }) {\r\n    const submit = () => {\r\n        alert(\"You're going to be logged out now...\");\r\n        logoutAccount();\r\n    }\r\n    return (\r\n        <div className=\"settings-modal\">\r\n            <Container fluid>\r\n                <Row>\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <h5>Delete Account</h5>\r\n                    </Col>\r\n                </Row>\r\n                <Row>\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\"> \r\n                        <Typography className=\"text-warning\">\r\n                            Note that this action is PERMANENT. \r\n                            Once clicked, your encrypted account info, \r\n                            all encrypted messages, encrypted chats, \r\n                            and associated encrypted metadata will be killed. \r\n                            Your username and email will be flagged \r\n                            and not allowed for re-application. If more than \r\n                            three deletes come from your IP/user agent, \r\n                            your IP will be flagged and not allowed for re-application.\r\n                            If your account is flagged, reported, or disabled for suspicious content, \r\n                            encrypted data will be warehoused as applicable by the law.\r\n                        </Typography>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"pt-2 mt-2\">\r\n                    <Col className=\"text-center\">\r\n                        <Button onClick={() => submit()} variant=\"outline-danger\" size=\"lg\">DELETE ACCOUNT <DeleteForever></DeleteForever></Button>\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nDeleteAccount.propTypes = {\r\n    logoutAccount: PropTypes.func\r\n}","import React from 'react';\r\nimport { Row, Col, Container } from 'react-bootstrap';\r\nimport './settings-modal.css';\r\nimport { Typography } from '@material-ui/core';\r\n\r\nexport default function PrivacySecurityDisclaimer() {\r\n    return (\r\n        <div className=\"settings-modal\">\r\n            <Container fluid>\r\n                <Row>\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <h5>Privacy and Security Disclaimers</h5>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"pt-2 pb-2\">\r\n                    <Col className=\"mx-auto text-center text-white\" xs=\"12\">\r\n                    <Typography>\r\n                            Blah blah blah TODO \r\n                    </Typography>\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\nimport { Row, Col, Container, Button } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport './settings-modal.css';\r\nimport { Typography } from '@material-ui/core';\r\n\r\nexport default function ResetPW({ logoutAccount }) {\r\n    const submit = () => {\r\n        alert(\"You're going to be logged out now...\");\r\n        logoutAccount();\r\n    }\r\n    return (\r\n        <div className=\"settings-modal\">\r\n            <Container fluid>\r\n                <Row>\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <h5>Reset Password</h5>\r\n                    </Col>\r\n                </Row>\r\n                <Row>\r\n                    <Col className=\"mx-auto text-center pt-1 pb-3\">\r\n                        <Typography className=\"text-warning\">Note that this action will log and lock you out, and then send a reset link to your account email.</Typography>\r\n                    </Col>\r\n                </Row>\r\n                <Row className=\"pt-2 mt-5\">\r\n                    <Col className=\"text-center\">\r\n                        <Button onClick={() => submit()} variant=\"outline-danger\" size=\"lg\">Reset Password</Button>\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nResetPW.propTypes = {\r\n    logoutAccount: PropTypes.func\r\n}","import React, { useEffect, useState } from 'react';\r\nimport {  Container, Row, Col, Button } from 'react-bootstrap';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport useWindowSize from '../../util/windowSize';\r\nimport DeleteForeverIcon from '@material-ui/icons/DeleteForever';\r\nimport TransferWithinAStationIcon from '@material-ui/icons/TransferWithinAStation';\r\nimport LockIcon from '@material-ui/icons/Lock';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport SecurityIcon from '@material-ui/icons/Security';\r\nimport About from '../modals/About';\r\nimport ChangeTagname from '../modals/ChangeTagname';\r\nimport DeleteAccount from '../modals/DeleteAccount';\r\nimport PrivacySecurityDisclaimer from '../modals/Privacy.Security.Disclaimer';\r\nimport ResetPW from '../modals/ResetPW';\r\nimport { Modal } from '@material-ui/core';\r\nimport {\r\n    selectAccount,\r\n    logout,\r\n    clearAccount\r\n} from '../../store/slices/accountSettingsSlice';\r\nimport { clearAuth } from '../../store/slices/authSlice';\r\nimport { clearConversations } from '../../store/slices/conversationsSlice';\r\nimport { clearInvites } from '../../store/slices/inviteSlice';\r\nimport { clearFriends } from '../../store/slices/friendsSlice';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setTopbarMessage } from '../../store/slices/uiSlice';\r\n\r\nexport default function Settings(){\r\n    const account = useSelector(selectAccount);\r\n    const dispatch = useDispatch();\r\n    const size = useWindowSize();\r\n    const wide = size.width > 768;\r\n    const [aboutOpened, setAboutOpened] = useState(false);\r\n    const [deleteAccOpened, setDeleteAccOpened] = useState(false);\r\n    const [privacyOpened, setPrivacyOpened] = useState(false);\r\n    const [resetPWOpened, setResetPWOpened] = useState(false);\r\n    const [changeTagnameOpened, setChangeTagnameOpened] = useState(false);\r\n\r\n    const logoutAccount = async () => {\r\n        await fetch(\"http://localhost:3000/api/auth/logout\", {\r\n            credentials: \"include\"\r\n        });\r\n        dispatch(logout());\r\n        dispatch(clearAccount());\r\n        dispatch(clearAuth());\r\n        dispatch(clearConversations());\r\n        dispatch(clearInvites());\r\n        dispatch(clearFriends());\r\n        console.log(\"Successfully logged out\");\r\n    }\r\n\r\n    const resetPassword = () => {\r\n        setResetPWOpened(true);\r\n    }\r\n\r\n    const changeTagname = () => {\r\n        setChangeTagnameOpened(true);\r\n    }\r\n\r\n    const deleteAccount = () => {\r\n        setDeleteAccOpened(true);\r\n    }\r\n\r\n    const aboutPage = () => {\r\n        setAboutOpened(true);\r\n    }\r\n\r\n    const privacyDisclaimer = () => {\r\n        setPrivacyOpened(true);\r\n    }\r\n    useEffect(() => {\r\n        if(size.width > 768) {\r\n            dispatch(setTopbarMessage((<span><SettingsIcon></SettingsIcon>&nbsp;Account Settings | @{account.tagName}</span>)));\r\n        } else {\r\n            dispatch(setTopbarMessage((<span><SettingsIcon></SettingsIcon> <span className=\"text-primary\">@{account.tagName}</span></span>)));\r\n        }\r\n    }, [size.width]);\r\n    return (\r\n        \r\n        <Container className=\"h-100 w-100\" fluid  style={{ margin: \"auto\", paddingLeft: (wide) ?  \"240px\" : \"0px\" }}>\r\n            <Row className=\"pt-3\">\r\n                <Modal\r\n                    open={aboutOpened}\r\n                    onClose={() => setAboutOpened(false)}\r\n                    aria-labelledby=\"simple-modal-title\"\r\n                    aria-describedby=\"simple-modal-description\"\r\n                >\r\n                    <About></About>\r\n                </Modal>\r\n                <Modal\r\n                    open={changeTagnameOpened}\r\n                    onClose={() => setChangeTagnameOpened(false)}\r\n                    aria-labelledby=\"simple-modal-title\"\r\n                    aria-describedby=\"simple-modal-description\"\r\n                >\r\n                    <ChangeTagname logoutAccount={logoutAccount}></ChangeTagname>\r\n                </Modal>\r\n                <Modal\r\n                    open={deleteAccOpened}\r\n                    onClose={() => setDeleteAccOpened(false)}\r\n                    aria-labelledby=\"simple-modal-title\"\r\n                    aria-describedby=\"simple-modal-description\"\r\n                >\r\n                    <DeleteAccount logoutAccount={logoutAccount}></DeleteAccount>\r\n                </Modal>\r\n                <Modal\r\n                    open={privacyOpened}\r\n                    onClose={() => setPrivacyOpened(false)}\r\n                    aria-labelledby=\"simple-modal-title\"\r\n                    aria-describedby=\"simple-modal-description\"\r\n                >\r\n                    <PrivacySecurityDisclaimer></PrivacySecurityDisclaimer>\r\n                </Modal>\r\n                <Modal\r\n                    open={resetPWOpened}\r\n                    onClose={() => setResetPWOpened(false)}\r\n                    aria-labelledby=\"simple-modal-title\"\r\n                    aria-describedby=\"simple-modal-description\"\r\n                >\r\n                    <ResetPW logoutAccount={logoutAccount}></ResetPW>\r\n                </Modal>\r\n            </Row>\r\n            <Row>\r\n                <Col className=\"mx-auto p-5\" xs=\"8\" style={{ opacity: 0.8, borderRadius: \"10px\", backgroundColor: \"#191919\", maxWidth: \"500px\" }}>\r\n                    <Container fluid>       \r\n                        <Row className=\"mb-2\">\r\n                            <Col className=\"pb-4 text-center lead mx-auto border-bottom border-dark\" xs=\"8\" style={{ opacity: 0.87, color: \"#EEEEEE\", fontSize: \"16pt\"}}>\r\n                                Your Account\r\n                            </Col>           \r\n                        </Row>  \r\n                        <Row className=\"mb-2 mt-1\">\r\n                            <Col className=\"p-2 text-center\" style={{ color: \"#EEEEEE\", opacity: 0.9, fontSize: \"14pt\" }}>\r\n                                <span className=\"text-muted font-italic\">Email:</span>&nbsp;&nbsp;&nbsp;{account.email} \r\n                            </Col>\r\n                        </Row>\r\n                        <Row className=\"p-2\">\r\n                            <Col className=\"text-center justify-content-around\">\r\n                                <Button onClick={() => resetPassword()} className=\"p-3 m-2 account-button\" variant=\"dark\" style={{ border: \"none\", backgroundColor: \"#202020\", padding: \"15px\", minWidth: \"150px\", maxWidth: \"150px\", minHeight: \"125px\", maxHeight: \"125px\" }} >Reset Password  <LockIcon></LockIcon></Button>\r\n                                <Button onClick={() => changeTagname()} className=\"p-3 m-2 account-button\" variant=\"dark\" style={{ border: \"none\", backgroundColor: \"#202020\", padding: \"15px\", minWidth: \"150px\", maxWidth: \"150px\", minHeight: \"125px\", maxHeight: \"125px\" }} >Change Tagname <TransferWithinAStationIcon></TransferWithinAStationIcon></Button>\r\n                                <Button onClick={() => aboutPage()} className=\"p-3 m-2 account-button\" variant=\"dark\" style={{ border: \"none\", backgroundColor: \"#202020\", padding: \"15px\", minWidth: \"150px\", maxWidth: \"150px\", minHeight: \"125px\", maxHeight: \"125px\" }} >About <InfoIcon></InfoIcon></Button>\r\n                                <Button onClick={() => privacyDisclaimer()} className=\"p-3 m-2 account-button text-warning\" variant=\"dark\" style={{ border: \"none\", backgroundColor: \"#202020\", padding: \"15px\",  minWidth: \"150px\", maxWidth: \"150px\", minHeight: \"125px\", maxHeight: \"125px\" }} >Privacy / Security Disclaimer <SecurityIcon></SecurityIcon></Button>\r\n                                <Button onClick={() => deleteAccount()} className=\"p-3 m-2 account-button text-danger\" variant=\"dark\" style={{ border: \"none\", backgroundColor: \"#202020\", padding: \"15px\", maxWidth: \"150px\", minHeight: \"125px\", maxHeight: \"125px\" }} >Delete Account <DeleteForeverIcon></DeleteForeverIcon></Button>\r\n                            </Col> \r\n                        </Row>\r\n                    </Container>\r\n                </Col>\r\n            </Row>\r\n        </Container>\r\n      )   \r\n}\r\n","import React from 'react'; \r\nimport Settings from '../components/settings/Settings';\r\nexport default function SettingScreen(){\r\n    return (\r\n      <div className=\"w-100 h-100\">\r\n        <Settings></Settings>\r\n      </div>\r\n    )\r\n  }","import React, { useState } from 'react';\nimport { Switch, Route, useHistory } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport GuardedRoute from './components/loginScreen/loginGuard';\nimport LoginComponent from './modules/login';\nimport ForgotPW from './modules/forgotPassword';\nimport CreateAcc from './modules/createAccount';\nimport Home from './modules/home';\nimport NewConv from './modules/newConversation'; \nimport SettingScr from './modules/settings';\nimport {\n  selectRefreshExpire, \n  setRefreshExpire\n} from './store/store'; \nimport { logout, clearAccount, selectAccount } from './store/slices/accountSettingsSlice'; \nimport { clearAuth } from './store/slices/authSlice';\nimport { clearConversations } from './store/slices/conversationsSlice'; \nimport { clearInvites } from './store/slices/inviteSlice';\nimport { clearFriends } from './store/slices/friendsSlice';\nimport 'react-toastify/dist/ReactToastify.css';\nimport 'react-pro-sidebar/dist/css/styles.css';\nimport './App.css';\nimport './index.css';\n\nexport default function App() {\n  const account = useSelector(selectAccount);\n  const dispatch = useDispatch(); \n  const refreshExpire = useSelector(selectRefreshExpire); \n  const now = Date.now(); \n  const history = useHistory();\n  const [refreshing, setRefreshing] = useState(false);\n\n  const logoutAccount = async () => {\n    try {\n      await fetch(\"http://localhost:3000/api/auth/logout\", {\n        credentials: \"include\"\n      });\n    } catch(err) {\n      console.log(\"Error while requesting logout, cookie is not cleared from browser. Clearing store and logging out\", err.message); \n    }\n    dispatch(logout());\n    dispatch(clearAccount());\n    dispatch(clearAuth());\n    dispatch(clearConversations());\n    dispatch(clearInvites());\n    dispatch(clearFriends());\n    history.push('/login');\n  }\n\n  const refreshToken = async () => {\n    let refreshResult = null;\n    try {\n      refreshResult = await fetch(\"http://localhost:3000/api/auth/refresh\", {\n        credentials: \"include\"\n      });\n    } catch(err) {\n      console.log(\"Error: fetching refresh token unauthorized, please login\"); \n      setRefreshing(false);\n      return false;\n    }\n    const { successful } = await refreshResult.json(); \n    if(account.loggedIn && successful === true){\n      console.success(\"Refresh token fetch successful\"); \n      dispatch(setRefreshExpire(now + 900000)); \n      setRefreshing(false); \n      return true;\n    } else {\n      console.error(\"Not logged in, not going to attempt refresh. Logging out.\")\n      console.error(\"Refresh token fetch failed. Logging out\"); \n      await logoutAccount();\n      setRefreshing(false); \n      return false;\n    }\n  }\n  if(refreshExpire !== -1 && refreshExpire <= now) {\n    if(!refreshing) {\n      setRefreshing(true);\n      refreshToken();\n    }\n  }\n\n  return (\n    <Switch>\n      <Route path=\"/login\" component={LoginComponent}></Route>\n      <Route path=\"/forgotPassword\" component={ForgotPW}></Route>\n      <Route path=\"/createAccount\" component={CreateAcc}></Route>\n      <GuardedRoute path=\"/home\" component={Home} auth={account.loggedIn}></GuardedRoute>\n      <GuardedRoute path=\"/newConversation\" component={NewConv} auth={account.loggedIn}></GuardedRoute>\n      <GuardedRoute path=\"/settings\" component={SettingScr} auth={account.loggedIn}></GuardedRoute>\n      <GuardedRoute path=\"/\" component={Home} auth={account.loggedIn}></GuardedRoute>\n    </Switch>\n  )\n}","import React from 'react';\r\nimport { Dropdown} from 'react-bootstrap';\r\nimport { Link } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport {\r\n  logout,\r\n  clearAccount\r\n} from '../../store/slices/accountSettingsSlice';\r\nimport {\r\n  clearConversations\r\n} from '../../store/slices/conversationsSlice';\r\nimport {\r\n  clearFriends\r\n} from '../../store/slices/friendsSlice';\r\nimport { clearAuth } from '../../store/slices/authSlice';\r\nimport { clearInvites } from '../../store/slices/inviteSlice';\r\nimport AccountBoxIcon from '@material-ui/icons/AccountBox';\r\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport '../topbar/topbar.css';\r\n\r\nexport default function SettingsDropdown(){\r\n    const dispatch = useDispatch();\r\n    const logoutAccount = async () => {\r\n        await fetch(\"http://localhost:3000/api/auth/logout\", {\r\n          credentials: \"include\"\r\n        });\r\n        dispatch(logout());\r\n        dispatch(clearAccount());\r\n        dispatch(clearAuth());\r\n        dispatch(clearConversations());\r\n        dispatch(clearInvites());\r\n        dispatch(clearFriends());\r\n        console.log(\"Successfully logged out\");\r\n    }\r\n    return (\r\n        <Dropdown className=\"topbar-dropdown\" style={{ backgroundColor: \"#191919\", position: \"relative\", maxWidth: \"100px\", opacity: 0.9 }}>              \r\n            <Dropdown.Toggle className=\"dropdown-toggle text-white\" style={{ border:\" none\", backgroundColor: \"#191919\"}} as=\"button\" id=\"dropdown-custom-2\"><MoreVertIcon></MoreVertIcon></Dropdown.Toggle>\r\n            <Dropdown.Menu className=\"dropdown-menu-custom-bg-settings\" style={{ backgroundColor: \"#191919\", maxWidth: \"100px\" }}>\r\n                <Dropdown.Item  className=\"text-white text-center dropdown-item-settings\" style={{ backgroundColor: \"#404040\", padding: \"15px\" }} as=\"button\" onClick={() => document.querySelector(\"#accountSettings\").click()}><Link id=\"accountSettings\" as=\"button\" style={{ textDecoration: 'none', color: \"#AAAAAA\" }} to=\"/settings\">Account&nbsp;<AccountBoxIcon></AccountBoxIcon></Link></Dropdown.Item>\r\n                <Dropdown.Item  className=\"text-white text-center dropdown-item-settings\" style={{ backgroundColor: \"#404040\", padding: \"15px\"}} as=\"button\" onClick={() => { logoutAccount() }}><Link style={{ textDecoration: 'none', color: \"#AAAAAA\" }} to=\"/login\">Logout&nbsp;<ExitToAppIcon></ExitToAppIcon></Link></Dropdown.Item>\r\n            </Dropdown.Menu>\r\n        </Dropdown>\r\n    )\r\n}\r\n\r\n","import React from 'react';\r\nimport { Row, Col, Button, Container } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport { \r\n    setView,\r\n    setShowConvList, \r\n    setCurrentConversation\r\n} from '../../store/slices/conversationsSlice'; \r\nimport { setTopbarMessage } from '../../store/slices/uiSlice';\r\nimport { chatSocket } from '../socket/chatSocket';\r\nimport useWindowSize from '../../util/windowSize';\r\nimport ForumIcon from '@material-ui/icons/Forum';\r\nimport './listitems.css';\r\nimport '../topbar/topbar.css';\r\n\r\nexport default function FriendListItem({ \r\n        account, \r\n        currentConversation, \r\n        isOnline, \r\n        tagName, \r\n        conversations, \r\n        history, \r\n        dispatch \r\n    }){\r\n    const size = useWindowSize();\r\n    const friendAction = () => {\r\n        if(conversations.length > 0){\r\n            for(let conv of conversations) {\r\n                //Navigate to the first conversation containing them\r\n                if(conv.pending === false){\r\n                    if(location.pathname !== '/home'){\r\n                        history.push('/home');\r\n                    }\r\n                    if(currentConversation.conversationName === conv.conversationName){\r\n                        dispatch(setView(false)); \r\n                        dispatch(setShowConvList(false));\r\n                        break; \r\n                    }\r\n                    if(conv && conv.conversationName !== '' && size.width > 768 && (currentConversation.conversationName !== conv.conversationName)){\r\n                        dispatch(setTopbarMessage(conv.conversationName));\r\n                    }  \r\n                    if(conv && conv.conversationName !== '' && size.width <= 768 && (currentConversation.conversationName !== conv.conversationName)) {\r\n                        dispatch(setTopbarMessage(\"\")); \r\n                    }\r\n                    dispatch(setView(false))\r\n                    dispatch(setCurrentConversation({ conversation: conv }));\r\n                    dispatch(setShowConvList(false));\r\n                    if(chatSocket){\r\n                        chatSocket.emit('setCurrentConversation', { user: account, conversationId: conv.id }, \r\n                        () => console.log(\"Emitted setCurrentConversation successfully\"));\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            if(location.pathname){\r\n                history.push('/newConversation');\r\n            }\r\n        }\r\n    }\r\n    return (\r\n        <Container className=\"friend-list-item-row\" fluid>\r\n            <Row className=\"p-3\">\r\n                <Col xs=\"8\" className={`${(isOnline) ? \"text-success\" : \"text-danger\"} py-auto font-italic text-sm text-center my-auto`} style={{ opacity: 0.67 }}>\r\n                    <span className=\"\">@{tagName}</span>\r\n                </Col>\r\n                <Col xs=\"4\" className=\"text-left\">\r\n                    <Button className=\"dropdown-toggle text-white hidden-dropdown-friend-list-item\" variant=\"dark\" style={{ maxWidth: \"50px\", border: \"none\", backgroundColor: \"#303030\"}} onClick={() => friendAction()}><ForumIcon></ForumIcon></Button>\r\n                </Col>\r\n            </Row>\r\n        </Container>\r\n    )\r\n}\r\n\r\nFriendListItem.propTypes = {\r\n    account: PropTypes.object,\r\n    currentConversation: PropTypes.object,\r\n    isOnline: PropTypes.bool,\r\n    tagName: PropTypes.string, \r\n    conversations: PropTypes.arrayOf(PropTypes.object),\r\n    history: PropTypes.object, \r\n    dispatch: PropTypes.object\r\n}","import React, { useState, useRef } from 'react';\r\nimport { Button, Container, Row, Dropdown, Col, FormControl, InputGroup } from 'react-bootstrap';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { SearchOutlined } from '@material-ui/icons';\r\nimport FriendListItem from '../listItems/Friend.js';\r\nimport PersonAddIcon from '@material-ui/icons/PersonAdd';\r\nimport GroupIcon from '@material-ui/icons/Group';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport PeopleAltIcon from '@material-ui/icons/PeopleAlt';\r\nimport {\r\n  selectAccount\r\n} from '../../store/slices/accountSettingsSlice';\r\nimport {\r\n  selectCurrentConversation,\r\n  selectConversations\r\n} from '../../store/slices/conversationsSlice';\r\nimport {\r\n  selectFriends\r\n} from '../../store/slices/friendsSlice';\r\nimport regex from '../../util/regex'\r\nimport { notificationSocket } from '../socket/notificationSocket';\r\nimport '../topbar/topbar.css';\r\n\r\nexport default function FriendsDropdown(){\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n    const account = useSelector(selectAccount);\r\n    const friends = useSelector(selectFriends);\r\n    const conversations = useSelector(selectConversations);\r\n    const [addFriendInput, setAddFriendInput] = useState(\"\");\r\n    const [searchFriendInput, setSearchFriendInput] = useState(\"\");\r\n    const [error, setError] = useState(false);\r\n    const [filteredFriends, setFilteredFriends] = useState(null);\r\n    const [searchError, setSearchError] = useState(false);\r\n    const [addError, setAddError] = useState(false);\r\n    const errorMsgs = useRef([]);\r\n    const currentConversation = useSelector(selectCurrentConversation);\r\n    \r\n    const checkInput = () => {\r\n      let passing = true;\r\n      errorMsgs.current = []\r\n      if(regex.tagNameSearch.test(searchFriendInput) === false){\r\n        passing = false;\r\n        errorMsgs.current.push(\"Invalid friend name\");\r\n      }\r\n      if(account.tagName === searchFriendInput){\r\n        passing = false;\r\n        errorMsgs.current.push(\"Cannot search/send self\");\r\n      }\r\n      if(!passing) setError(true);\r\n      return passing;\r\n    }\r\n\r\n    const checkAddFriendInput = () => {\r\n      let passing = true;\r\n      errorMsgs.current = []\r\n      if(regex.tagName.test(addFriendInput) === false){\r\n        passing = false;\r\n        errorMsgs.current.push(\"Invalid tagname. Try 8-24 letters, numbers, dashes, underscores\");\r\n      }\r\n      if(friends.filter(friend => friend.tagName === addFriendInput).length > 0) {\r\n        passing = false;\r\n        errorMsgs.current.push(\"Friend already exists\");\r\n      }\r\n      if(!passing) setError(true);\r\n      return passing;\r\n    }\r\n\r\n    const searchFriends = () => {\r\n      setError(false);\r\n      if(!errorMsgs.current || Array.isArray(errorMsgs.current) === false || errorMsgs.current.length !== 0){\r\n        errorMsgs.current = []\r\n      }\r\n      setSearchError(false);\r\n      if(checkInput() === false){\r\n        console.log(\"Error searching friend's list, invalid tag name!\");\r\n        setSearchError(true);\r\n        return;\r\n      }\r\n      console.log(`Filtering friend's list by tagname | ${addFriendInput}`);\r\n      if(friends.length > 1){\r\n        setFilteredFriends(friends.filter(friend => friend.tagName.includes(searchFriendInput) ||\r\n                                          searchFriendInput.includes(friend.tagName))); \r\n      }\r\n    }\r\n\r\n    const sendFriendRequest = async () => {\r\n      setError(false);\r\n      if(!errorMsgs.current || Array.isArray(errorMsgs.current) === false || errorMsgs.current.length !== 0){\r\n        errorMsgs.current = []\r\n      }\r\n      setAddError(false);\r\n      if(checkAddFriendInput() === false){\r\n        console.log(\"Error cannot send friend request\", errorMsgs);\r\n        setAddError(true)\r\n        return;\r\n      }\r\n      if(account && notificationSocket){\r\n          notificationSocket.emit('sendFriendRequest', {\r\n            senderId: account.id,\r\n            recipientId: addFriendInput\r\n          }, () => {\r\n            console.log(`Friend request sent to user @${addFriendInput}`);\r\n          });\r\n        } else {\r\n          console.log(\"Error sending friend request, not connected to notifications socket\");\r\n      }\r\n    }\r\n\r\n  return (\r\n    <Dropdown className=\"ml-3 p-1\" style={{ backgroundColor: \"#191919\" }} >\r\n      <Tooltip title=\"Friends List\">\r\n        <Dropdown.Toggle as=\"button\" style={{ border: \"none\", color: \"white\", backgroundColor: \"#191919\" }} className=\"top-dropdown-button font-weight-bold rounded-pill ml-2\">\r\n            <PeopleAltIcon></PeopleAltIcon>\r\n        </Dropdown.Toggle>\r\n      </Tooltip>\r\n      <Dropdown.Menu style={{ backgroundColor: \"#191919\", minWidth: \"325px\"}} className=\"dropdown-menu-custom-bg\">\r\n      <Dropdown.ItemText className=\"text-center font-weight-bold lead mb-1\" style={{ backgroundColor: \"#191919\", opacity: 0.9, color: \"#AAAAAA\" }}><GroupIcon></GroupIcon>&nbsp;&nbsp;Friends</Dropdown.ItemText>\r\n        <Container fluid className=\"h-100\" style={{ backgroundColor: \"#191919\", minWidth: \"325px\", paddingTop: \"20px\"}}>\r\n          <Row className=\"m-1\">\r\n            <Col xs=\"10\">\r\n                <InputGroup>\r\n                  <FormControl\r\n                    style={{marginLeft: \"auto\", maxWidth: \"250px\", marginRight: \"auto\", color: \"white\", opacity: 0.87, minWidth: \"200px\", minHeight: '50px', backgroundColor: \"#202020\", border: 'none' }}\r\n                    placeholder=\"Add Friend By Tagname\"\r\n                    aria-label=\"Add Friend By Tagname\"\r\n                    aria-describedby=\"basic-addon1\"\r\n                    className={(addError) ? \"search-friend-bar error-placeholder\" : \"search-friend-bar\"}\r\n                    onChange={(e) => { setAddFriendInput(e.target.value) }}\r\n                  />\r\n              </InputGroup>\r\n            </Col>\r\n            <Col xs=\"2\">\r\n              <Button variant=\"dark\" className=\"mr-3 pr-2\" style={{ display: \"block\", marginRight: \"auto\", marginLeft: \"-15px\", backgroundColor: \"#191919\", border: \"none\", color: \"#555555\" }} onClick={() => sendFriendRequest() } disabled={(addFriendInput.length < 8)}><PersonAddIcon className={(addError) ? \"error-icon\" : \"\"} style={{ height: 30, width: 30, color: \"#AAAAAA\" }}></PersonAddIcon></Button>\r\n            </Col>\r\n          </Row> \r\n          <Row className=\"m-1 mt-2 mb-2 mb-1 pb-3\">\r\n              <Col xs=\"10\">\r\n                  <InputGroup>\r\n                    <FormControl\r\n                      style={{marginLeft: \"auto\", maxWidth: \"250px\", marginRight: \"auto\", color: \"white\", opacity: 0.87, minWidth: \"200px\", minHeight: '50px', backgroundColor: \"#202020\", border: 'none' }}\r\n                      placeholder=\"Search Friends...\"\r\n                      aria-label=\"Search Friends...\"\r\n                      aria-describedby=\"basic-addon1\"\r\n                      className={(searchError) ? \"search-friend-bar error-placeholder\" : \"search-friend-bar\"}\r\n                      onChange={(e) => { setSearchFriendInput(e.target.value) }}\r\n                    />\r\n                </InputGroup>\r\n              </Col>\r\n              <Col xs=\"2\">\r\n                <Button variant=\"dark\" style={{  display: \"block\", marginRight: \"auto\", marginLeft: \"-15px\", backgroundColor: \"#191919\", border: \"none\", color: \"#555555\" }} onClick={() => searchFriends() }><SearchOutlined className={(searchError) ? \"error-icon\" : \"\"} style={{ height: 30, width: 30, color: \"#AAAAAA\" }}></SearchOutlined></Button>\r\n              </Col>\r\n            </Row> \r\n            <Row style={{ maxWidth: \"250px\", minWidth: \"250px\", overflowY: \"scroll\", marginRight: \"auto\", marginLeft: \"15px\"}} className=\"mt-1 pb-1\">\r\n              <Col style={{ maxHeight: \"190px\" }}>\r\n              {\r\n                (Array.isArray(filteredFriends)) ?\r\n                    filteredFriends.map((el) => {\r\n                      const convsWithFriend = []\r\n                      if(conversations && Array.isArray(conversations)) {\r\n                        for(let conv of conversations) {\r\n                            if(conv.users && Array.isArray(conv.users)) {\r\n                              for(let user of conv.users) {\r\n                                  if(user.tagName === el.tagName) {\r\n                                      convsWithFriend.push(conv);\r\n                                      break;\r\n                                  }\r\n                              }\r\n                            }\r\n                        }\r\n                      }\r\n                      if(el && el.tagName){\r\n                        return (\r\n                          <Row key={el.tagName} style={{ maxHeight: \"65px\" , backgroundColor: \"#505050\"}} className=\"friend-topbar\">\r\n                            <FriendListItem \r\n                              account={account} \r\n                              currentConversation={currentConversation} \r\n                              history={history} \r\n                              dispatch={dispatch} \r\n                              conversations={convsWithFriend} \r\n                              key={el.tagName} \r\n                              tagName={el.tagName} \r\n                              isOnline={el.isOnline}>\r\n                            </FriendListItem>\r\n                          </Row>\r\n                        )\r\n                      } else return null;                          \r\n                    })\r\n                :\r\n                  friends.map((el) => {\r\n                    if(el && el.tagName){\r\n                      const convsWithFriend = []\r\n                      if(conversations && Array.isArray(conversations)) {\r\n                          for(let conv of conversations) {\r\n                            if(conv.users && Array.isArray(conv.users)) {\r\n                              for(let user of conv.users) {\r\n                                  if(user.tagName === el.tagName) {\r\n                                      convsWithFriend.push(conv);\r\n                                      break;\r\n                                  }\r\n                              }\r\n                            }\r\n                          }\r\n                      }\r\n                      return (\r\n                          <Row key={el.tagName} style={{ maxHeight: \"65px\" , backgroundColor: \"#505050\"}} className=\"friend-topbar\">\r\n                            <FriendListItem \r\n                              account={account} \r\n                              currentConversation={currentConversation} \r\n                              history={history} \r\n                              dispatch={dispatch} \r\n                              conversations={convsWithFriend} \r\n                              key={el.tagName} \r\n                              tagName={el.tagName} \r\n                              isOnline={el.isOnline}>\r\n                            </FriendListItem>\r\n                          </Row>\r\n                      )\r\n                    } else return null;                          \r\n                  })\r\n                }\r\n              </Col>\r\n            </Row>  \r\n        </Container>\r\n        { (error) ? (\r\n        <Container fluid className=\"text-left lead\" style={{ opacity: 0.9 }}>\r\n          <Row className=\"font-italic text-danger\" style={{ margin: \"20px\", borderBottom: \"1px solid red\", opacity: 0.87 }}>\r\n              Errors:\r\n          </Row>  \r\n        <Row>\r\n          <ul>\r\n            {errorMsgs.current.map(el => (<li className=\"text-danger text-small\" key={el}>{el}</li>))}\r\n          </ul>\r\n        </Row>\r\n        </Container>\r\n        ) : \"\" }\r\n      </Dropdown.Menu>\r\n    </Dropdown>\r\n  );\r\n}","import React from 'react';\r\nimport { Row, Col, Button } from 'react-bootstrap';\r\nimport { useSelector } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport GroupAddOutlinedIcon from '@material-ui/icons/GroupAddOutlined';\r\nimport NotInterestedOutlinedIcon from '@material-ui/icons/NotInterestedOutlined';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport { selectAccount } from '../../store/slices/accountSettingsSlice';\r\nimport { notificationSocket } from '../socket/notificationSocket';\r\nimport './listitems.css';\r\nimport '../topbar/topbar.css';\r\n\r\nexport function FriendRequestListItem({ requestId, tagName }){\r\n    const account = useSelector(selectAccount);\r\n    const acceptFriendRequest = () => {\r\n        if(notificationSocket){\r\n            console.log(\"Emitted acceptFriendRequest\");\r\n            notificationSocket.emit(\"acceptFriendRequest\", {\r\n                friendRequestId: requestId \r\n            }, () => {\r\n                console.log(\"Successfully emitted accept friend request\");\r\n            });\r\n        }\r\n    }\r\n    return (tagName === account.tagName) ? \"\" : (\r\n        <Row className=\"friend-request-list-item p-2\">\r\n            <Col className=\"text-small text-center my-auto\" style={{ opacity: 0.67 }}>\r\n                Friend request from @{tagName}\r\n            </Col>\r\n            <Col xs=\"5\" className=\"text-center p-2\"  style={{ opacity: 0.67 }}>\r\n                <Button className=\"button-bg mb-1 rounded-pill\" style={{ border: \"none\", color: \"#97fa93\", backgroundColor: \"#191919\", opacity: 0.9 }} onClick={() => { acceptFriendRequest() }}>\r\n                    <Tooltip title=\"Accept\">\r\n                        <GroupAddOutlinedIcon></GroupAddOutlinedIcon>\r\n                    </Tooltip>\r\n                </Button> \r\n                <Button className=\"button-bg rounded-pill\" style={{ border: \"none\", color: \"#bf2700\", backgroundColor: \"#191919\" }} onClick={() => alert(\"Decline friend request\")}>\r\n                    <Tooltip title=\"Decline\">\r\n                        <NotInterestedOutlinedIcon></NotInterestedOutlinedIcon>\r\n                    </Tooltip>\r\n                </Button>\r\n            </Col> \r\n        </Row>\r\n    )\r\n}\r\n\r\nFriendRequestListItem.propTypes = {\r\n    requestId: PropTypes.string, \r\n    tagName: PropTypes.string\r\n}","import React, {useEffect, useState } from 'react';\r\nimport { Row, Col, Button } from 'react-bootstrap';\r\nimport { useSelector } from 'react-redux';\r\nimport { selectConversations } from '../../store/slices/conversationsSlice';\r\nimport DeleteOutlineIcon from '@material-ui/icons/DeleteOutline';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport PropTypes from 'prop-types';\r\nimport './listitems.css';\r\nimport '../topbar/topbar.css';\r\nexport function AcceptedInviteListItem({ sender }){\r\n    const conversations = useSelector(selectConversations);\r\n    const [tag, setTag] = useState(\"\");\r\n    useEffect(() => {\r\n        let friend;\r\n        if(conversations && Array.isArray(conversations)) {\r\n            for(let conv of conversations){\r\n                for(let user of conv.users){\r\n                    if(user.id === sender){\r\n                        friend = JSON.parse(JSON.stringify(user));\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if(friend.tagName)\r\n            setTag(friend.tagName);\r\n    }, []);\r\n    const deleteItem = () => {\r\n        alert(\"Todo\")\r\n    }\r\n    return (\r\n        <Row className=\"p-3 accepted-list-item\">\r\n            <Col className=\"text-small text-center my-auto\" style={{ opacity: 0.67 }}>\r\n                Chat with {`${tag}`.length > 10 ? `${tag}`.substring(0,7) + \"...\" : `${tag}`}\r\n            </Col>\r\n            <Col xs=\"5\" className=\"text-center pr-2\"  style={{ opacity: 0.67 }}>\r\n                <Button onClick={() => deleteItem()} className=\"btn-sm mb-1 rounded-pill button-bg\"  style={{ border: \"none\", backgroundColor: \"#191919\", opacity: 0.9 }}>\r\n                    <Tooltip title=\"Delete\">\r\n                        <DeleteOutlineIcon></DeleteOutlineIcon>\r\n                    </Tooltip>\r\n                </Button> \r\n            </Col>  \r\n        </Row>\r\n    )\r\n}\r\nAcceptedInviteListItem.propTypes = {\r\n    sender: PropTypes.string\r\n}","import React from 'react';\r\nimport { Row, Col, Button } from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport { notificationSocket } from '../socket/notificationSocket';\r\nimport './listitems.css';\r\nimport '../topbar/topbar.css';\r\nexport function ReceivedInviteListItem({ sender, inviteId, convId }){\r\n    const sendAccept = () => {\r\n        if(notificationSocket){\r\n            console.log(`Attempting to emit acceptInvite event to server for invite with id ${inviteId}`)\r\n            notificationSocket.emit('acceptInvite', { inviteId: inviteId, conversationId: convId}, () => {\r\n                console.log(`Successfully emitted acceptInvite event to server for invite with id ${inviteId}`)\r\n            });\r\n        }\r\n    }\r\n    return (\r\n        <Row className=\"p-3 invite-hover\">\r\n            <Col className=\"text-small text-muted text-center my-auto\" style={{ opacity: 0.67 }}>\r\n                Chat with {`${sender}`.length > 10 ? `${sender}`.substring(0,7) + '...' : `${sender}` }\r\n            </Col>\r\n\r\n            <Col xs=\"5\" className=\"text-center\"  style={{ opacity: 0.67 }}>\r\n                <Button  className=\"btn-sm mb-1 rounded-pill\" style={{ border: \"none\", color: \"#97fa93\", backgroundColor: \"#191919\", opacity: 0.9 }} onClick={() => { sendAccept() }}>Accept</Button> \r\n                <Button className=\"btn-sm rounded-pill\" style={{ border: \"none\", color: \"#bf2700\", backgroundColor: \"#191919\" }}>Decline</Button>\r\n            </Col>  \r\n        </Row>\r\n    )\r\n}\r\n\r\nReceivedInviteListItem.propTypes = {\r\n    sender: PropTypes.string, \r\n    inviteId: PropTypes.string, \r\n    convId: PropTypes.string\r\n}","import React from 'react';\r\nimport { Container, Dropdown, Tabs, Tab } from 'react-bootstrap';\r\nimport { useSelector } from 'react-redux';\r\nimport { Badge } from '@material-ui/core';\r\nimport {\r\n  selectAccount\r\n} from '../../store/slices/accountSettingsSlice';\r\nimport {\r\n  selectFriendRequests\r\n} from '../../store/slices/friendsSlice';\r\nimport { selectReceived, acceptedInvites } from '../../store/slices/inviteSlice';\r\nimport { FriendRequestListItem } from '../listItems/FriendRequest';\r\nimport { AcceptedInviteListItem } from '../listItems/AcceptedInvite';\r\nimport { ReceivedInviteListItem } from '../listItems/ReceivedInvite';\r\nimport NotificationsIcon from '@material-ui/icons/Notifications';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport '../topbar/topbar.css'\r\n\r\nexport default function NotificationsDropdown() {\r\n    const receivedInvites = useSelector(selectReceived);\r\n    const friendRequests = useSelector(selectFriendRequests);\r\n    const _acceptedInvites = useSelector(acceptedInvites);\r\n    const account = useSelector(selectAccount);\r\n    return (\r\n      <Dropdown className=\"ml-3 p-1 topbar-dropdown\" style={{ backgroundColor: \"#191919\", opacity: 0.95 }} >\r\n          <Tooltip title=\"Notifications\">\r\n            <Dropdown.Toggle as=\"button\" style={{ border: \"none\", color: \"white\", backgroundColor: \"#191919\" }} className=\"top-dropdown-button font-weight-bold rounded-pill ml-2\">\r\n              {\r\n                (receivedInvites.length >= 1 || friendRequests.length >= 1) \r\n                ? \r\n                <Badge color=\"default\" overlap=\"circle\" badgeContent=\" \" variant=\"dot\">\r\n                  <NotificationsIcon></NotificationsIcon>\r\n                </Badge> \r\n                : \r\n                <NotificationsIcon></NotificationsIcon>\r\n              }\r\n            </Dropdown.Toggle>    \r\n          </Tooltip>   \r\n          <Dropdown.Menu className=\"dropdown-menu-custom-bg\" style={{ backgroundColor: \"#191919\", minWidth: \"350px\" }}>\r\n            <Dropdown.ItemText className=\"text-center font-weight-bold lead p-3 pb-2\" style={{ opacity: 0.9, color: \"#AAAAAA\" }}><NotificationsIcon></NotificationsIcon>&nbsp;&nbsp;Notifications</Dropdown.ItemText>\r\n            <Container fluid style={{ maxHeight: \"250px\", minHeight: \"250px\", minWidth: \"250px\", overflowY: \"scroll\"}}>\r\n            <Tabs className=\"tabs-notifications\" defaultActiveKey=\"received\" id=\"uncontrolled-tab-example\">\r\n              <Tab className=\"tab-notifications\" eventKey=\"received\" title=\"Received\">\r\n                {friendRequests.filter(map => map.recipientId === account.id).map((el) => {\r\n                  if(el && el.accepted === false && el.cancelled === false && el.sender.id !== account.id){\r\n                    return (\r\n                      <FriendRequestListItem requestId={el.id} recipientId={el.recipientId} sender={el.sender} tagName={el.sender.tagName} key={`${el.id}`}></FriendRequestListItem>\r\n                    )\r\n                  } else return null;                         \r\n                })}\r\n                {receivedInvites.map((el) => {\r\n                  return (\r\n                    <ReceivedInviteListItem sender={(el.sender) ? el.sender : `${el.senderId}`} key={`${Math.random()}`} convId={`${el.conversationId}`} inviteId={`${el.id}`}></ReceivedInviteListItem>\r\n                  )\r\n                })}\r\n              </Tab>\r\n              <Tab eventKey=\"accepted\" title=\"Accepted\">\r\n                {_acceptedInvites.map((el) => {\r\n                    return (\r\n                      <AcceptedInviteListItem sender={`${el.senderId}`} key={`${Math.random()}`} convId={`${el.conversationId}`} inviteId={`${el.id}`}></AcceptedInviteListItem>\r\n                    )\r\n                  })\r\n                }\r\n              </Tab>\r\n            </Tabs>        \r\n            </Container>            \r\n          </Dropdown.Menu>\r\n      </Dropdown>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport { Button, Container, Row } from 'react-bootstrap';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport useWindowSize from '../../util/windowSize';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport { useLocation } from 'react-router-dom'\r\nimport ForumIcon from '@material-ui/icons/Forum';\r\nimport {\r\n  selectAccount,\r\n} from '../../store/slices/accountSettingsSlice';\r\nimport {\r\n  selectView,\r\n  selectShowConvList,\r\n  setShowConvList,\r\n  setView\r\n} from '../../store/slices/conversationsSlice';\r\nimport SettingsDropdown from '../dropdowns/Settings';\r\nimport FriendsDropdown from '../dropdowns/Friends';\r\nimport NotificationsDropdown from '../dropdowns/Notifications';\r\nimport { selectTopbarMessage } from '../../store/slices/uiSlice';\r\nimport './topbar.css'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n      display: 'flex',\r\n      flexGrow: 1,\r\n      backgroundColor: \"#191919\",\r\n      height: \"100%\",\r\n      opacity: 0.87\r\n    },\r\n    appBar: {\r\n      zIndex: theme.zIndex.drawer + 1,\r\n      backgroundColor:\"#191919\"\r\n    },\r\n    menuButton: {\r\n      marginRight: theme.spacing(2),\r\n    },\r\n    title: {\r\n      flexGrow: 1,\r\n      color: \"white\"\r\n    },\r\n    menu : {\r\n      backgroundColor: \"#404040\"\r\n    }\r\n}));\r\n\r\nfunction StartChatButton(){\r\n  const view = useSelector(selectView);\r\n  const showConvList = useSelector(selectShowConvList);\r\n  const dispatch = useDispatch()\r\n  return (\r\n    <div>\r\n      <Link id=\"startChat\" style={{ display: \"none\" }} to=\"/newConversation\"></Link>\r\n      <Button onClick={async () => { \r\n          if(showConvList){\r\n            dispatch(setShowConvList(false));\r\n            //Hides the sidebar\r\n          }\r\n          if(view){\r\n            dispatch(setView(false));\r\n            //Sets the default view to false\r\n          }\r\n          document.getElementById(\"startChat\").click(); \r\n        }} variant=\"primary\" className=\"rounded-pill mx-auto my-form-control-button\" style={{ opacity: 0.75, boxShadow: \"black 5px 5px \" }}>\r\n        <ForumIcon></ForumIcon> Start chat\r\n      </Button>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default function TopBar(){\r\n    const size = useWindowSize()\r\n    const classes = useStyles();\r\n    const account = useSelector(selectAccount);\r\n    const dispatch = useDispatch();\r\n    const screenSmall = size.width < 768;\r\n    const showConv = useSelector(selectShowConvList);\r\n    const location = useLocation();\r\n    const topbarMessage = useSelector(selectTopbarMessage);\r\n    return (\r\n        <CssBaseline>\r\n        <AppBar position=\"fixed\"  className={classes.appBar}>\r\n            <Toolbar>\r\n            <IconButton edge=\"start\" className={classes.menuButton} color=\"inherit\" aria-label=\"menu\">\r\n            </IconButton>\r\n            <Typography component={'span'} className={classes.title}>\r\n               <Container fluid>\r\n                  <Row className=\"text-center\">\r\n                    {\r\n                      (account.loggedIn && screenSmall && !showConv) ?\r\n                        (\r\n                          <Button style={{backgroundColor: \"#191919\", border: \"none\"}} onClick={ () => {  dispatch(setShowConvList(!showConv)) }}><ArrowBackIcon></ArrowBackIcon></Button>\r\n                        )\r\n                      : \"\"\r\n                    }   \r\n                    {\r\n                      (account.loggedIn) ? \r\n                          (\r\n                            <div>\r\n                              <StartChatButton></StartChatButton>\r\n                              <NotificationsDropdown></NotificationsDropdown>\r\n                              <FriendsDropdown></FriendsDropdown>              \r\n                            </div>\r\n                       )\r\n                      : \"\"\r\n                    }\r\n                  </Row>\r\n               </Container>\r\n            </Typography>\r\n\r\n            {\r\n                (size.width > 768)\r\n               ?\r\n                <Typography component={'span'} variant=\"h4\" className={classes.title}>\r\n                    <span style={{ opacity: 0.67 }} className=\"text-white lead\">{topbarMessage}</span>\r\n                </Typography> \r\n                :  \"\"\r\n            }\r\n            \r\n            \r\n            {\r\n              (account.loggedIn === false && location.pathname !== \"/login\") ? (<Link className=\"rounded-pill btn btn-outline-primary mr-5 rounded-pill\" style={{ opacity: 0.67 }} renderas={Button} to=\"/login\">\r\n              Login\r\n            </Link>) : \"\"\r\n            }\r\n            {(account.loggedIn) ? (\r\n              <SettingsDropdown></SettingsDropdown>\r\n            ) : \"\"}\r\n            </Toolbar>\r\n        </AppBar>\r\n        </CssBaseline>\r\n    )\r\n}","import React, { Suspense } from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport store from './store/store'\nimport { Provider } from 'react-redux';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport TopBar from './components/topbar/TopBar';\nimport NotificationSocket from './components/socket/notificationSocket';\nReactDOM.render(\n  <div className=\"base-div\" style={{backgroundColor: \"#191919\"}}>\n    <React.StrictMode>\n      <Provider store={store}>\n        <Router basename='/client/'>\n          <Suspense fallback={null}>\n            <TopBar></TopBar>\n            <NotificationSocket></NotificationSocket>\n            <App />\n          </Suspense>\n        </Router>\n      </Provider>\n    </React.StrictMode>\n  </div>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}