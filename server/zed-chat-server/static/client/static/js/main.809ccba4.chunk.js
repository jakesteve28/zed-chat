(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{108:function(e,t,a){},111:function(e,t,a){},126:function(e,t,a){},159:function(e,t,a){e.exports=a(206)},171:function(e,t,a){},173:function(e,t,a){},196:function(e,t){},200:function(e,t,a){},201:function(e,t,a){},202:function(e,t,a){},205:function(e,t,a){},206:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(11),c=a.n(o),s=(a(108),a(8)),i=a.n(s),l=a(16),d=a(2),u=a(22),m=a(4),f=a(151),g=function(e){var t=e.component,a=e.auth,n=Object(f.a)(e,["component","auth"]);return r.a.createElement(u.b,Object.assign({},n,{render:function(e){return!0===a?r.a.createElement(t,e):r.a.createElement(u.a,{to:"/login"})}}))},p=a(17),v=a(40),b=a(241),h=a(242),E=a(243),y=a(244),x=a(245),N=a(266),w=a(129),O=a(24),j=a(25),k=a(105),C=Object(j.b)({name:"conversations",initialState:{conversations:[],currentConversation:{messages:[],joined:!1,typing:!1,id:0},defaultView:!0,showConvList:!1},reducers:{clearConversations:function(e){e.conversations=[],e.currentConversation={messages:[],joined:!1,typing:!1,id:0},e.defaultView=!0,e.showConvList=!1},addConversation:function(e,t){e.conversations.filter((function(e){return e.id===t.payload.conversation.id})).length>0?console.log("Error: cannot add conversation because one already exists in store"):e.conversations.push(t.payload.conversation)},removeConversation:function(e,t){e.conversations=e.conversations.filter((function(e){return e.id!==t.payload.id}))},setCurrentConversation:function(e,t){e.conversations.filter((function(e){return e.id===t.payload.conversation.id})).length<1?console.log("Error: cannot set current conversation to a conversation that doesn't exist in the store"):e.currentConversation=t.payload.conversation},addMessage:function(e,t){var a,n=Object(k.a)(e.conversations,(function(){})),r=Object(p.a)(n);try{for(r.s();!(a=r.n()).done;){var o=a.value;if(o.id===t.payload.conversation.id){if(!Array.isArray(o.messages)){console.log("Messages don't exist yet"),o.messages=[],o.messages.push(t.payload.message),o.numberOfMessages<o.messages.length&&(o.numberOfMessages=o.messages.length);break}if(o.messages.filter((function(e){return e.id===t.payload.message.id})).length>0){console.log("Error: Cannot add message because it already exists in the state!");break}if(o.id===e.currentConversation.id){Array.isArray(e.currentConversation.messages)&&e.currentConversation.messages||(e.currentConversation.messages=[]),e.currentConversation.messages.push(t.payload.message),e.currentConversation.numberOfMessages<e.currentConversation.messages.length&&(e.currentConversation.numberOfMessages=e.currentConversation.messages.length);break}if(Array.isArray(o.messages)){o.messages.push(t.payload.message),o.numberOfMessages<o.messages.length&&(o.numberOfMessages=o.messages.length);break}}}}catch(c){r.e(c)}finally{r.f()}e.conversations=Object(k.a)(n,(function(){}))},removeMessage:function(e,t){var a=t.payload,n=a.conversationId,r=a.messageId;e.currentConversation===n&&(e.currentConversation.messages=e.currentConversation.messages.filter((function(e){return e.id!==r})));var o,c=Object(p.a)(null===e||void 0===e?void 0:e.conversations);try{for(c.s();!(o=c.n()).done;){var s=o.value;s.id===n&&(s.messages=s.messages.filter((function(e){return e.id!==r})))}}catch(i){c.e(i)}finally{c.f()}},setJoined:function(e,t){e.currentConversation.joined=t.payload},setRead:function(e,t){var a=e.conversations.filter((function(e){return e.id===t.payload.convId}))[0];if(a){var n=a.messages.filter((function(e){return e.id===t.payload.messageId}))[0];n&&(n.read=!0)}},setTyping:function(e,t){e.currentConversation.typing=t.payload},setView:function(e,t){e.defaultView=t.payload},setShowConvList:function(e,t){e.showConvList=t.payload},sortMessages:function(e){e.currentConversation.messages.length>1&&e.currentConversation.messages.sort((function(e,t){return Date.parse(e.createdAt)-Date.parse(t.createdAt)}))},pinMessage:function(e,t){var a,n=Object(p.a)(e.conversations);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(t.payload.conversation.id===r.id){var o,c=Object(p.a)(r.messages);try{for(c.s();!(o=c.n()).done;){var s=o.value;s.id===t.payload.id&&(s.pinned=t.payload.pinned)}}catch(i){c.e(i)}finally{c.f()}}}}catch(i){n.e(i)}finally{n.f()}},batchAddMessages:function(e,t){var a,n=t.payload,r=n.messages,o=n.conversationId,c=Object(p.a)(r);try{for(c.s();!(a=c.n()).done;){var s=a.value;s.conversation.id===e.currentConversation.id&&e.currentConversation.id===o&&(e.currentConversation.messages.push(s),e.currentConversation.numberOfMessages<e.currentConversation.messages.length&&(e.currentConversation.numberOfMessages=e.currentConversation.messages.length))}}catch(i){c.e(i)}finally{c.f()}}}}),S=C.actions,I=S.batchAddMessages,A=(S.removeMessage,S.sortMessages),R=S.setShowConvList,q=S.clearConversations,H=S.setView,D=S.setTyping,M=S.setRead,T=(S.setJoined,S.addMessage),W=S.setCurrentConversation,P=S.addConversation,F=S.removeConversation,B=S.pinMessage,L=function(e){return e.conversations.conversations},z=function(e){return e.conversations.currentConversation},J=function(e){return e.conversations.defaultView},U=function(e){return e.conversations.showConvList},Z=C.reducer,Y=Object(j.b)({name:"account",initialState:{email:"",tagName:"",loggedIn:!1,id:""},reducers:{clearAccount:function(e){e.email="",e.tagName="",e.loggedIn=!1,e.id=""},setEmail:function(e,t){e.email=t.payload},setTagName:function(e,t){e.tagName=t.payload},login:function(e){e.loggedIn=!0},logout:function(e){e.loggedIn=!1},setId:function(e,t){e.id=t.payload}}}),$=Y.actions,V=$.clearAccount,_=$.setId,K=$.setEmail,G=$.setTagName,X=$.login,Q=$.logout,ee=function(e){return{id:e.account.id,email:e.account.email,tagName:e.account.tagName,loggedIn:e.account.loggedIn}},te=Y.reducer,ae=Object(j.b)({name:"invite",initialState:{sentInvites:[],receivedInvites:[],acceptedInvites:[]},reducers:{clearInvites:function(e){e.sentInvites=[],e.receivedInvites=[],e.acceptedInvites=[]},addSentInvite:function(e,t){e.sentInvites.push(t.payload)},addReceivedInvite:function(e,t){e.receivedInvites.push(t.payload)},removeSentInvite:function(e,t){e.sentInvites=e.sentInvites.filter((function(e){return e.id!==t.payload}))},removeReceivedInvite:function(e,t){e.receivedInvites=e.receivedInvites.filter((function(e){return e.id!==t.payload}))},addAcceptedInvite:function(e,t){e.acceptedInvites.push(t.payload)}}}),ne=ae.actions,re=ne.clearInvites,oe=ne.addSentInvite,ce=ne.addReceivedInvite,se=(ne.removeSentInvite,ne.removeReceivedInvite,ne.addAcceptedInvite),ie=function(e){return e.invite.sentInvites},le=function(e){return e.invite.receivedInvites},de=function(e){return e.invite.acceptedInvites},ue=ae.reducer,me=Object(j.b)({name:"friends",initialState:{friends:[],friendRequests:[]},reducers:{clearFriends:function(e){e.friendRequests=[],e.friends=[]},addFriend:function(e,t){e.friends.filter((function(e){return e.id===t.payload.id||e.tagName===t.payload.tagName})).length>0||(t.payload.password&&delete t.payload.password,e.friends=[].concat(Object(v.a)(e.friends),[t.payload]))},removeFriend:function(e,t){e.friends=e.friends.filter((function(e){return e.id!==t.payload}))},addFriendRequest:function(e,t){e.friendRequests.filter((function(e){return e.id===t.payload.id})).length>0||(e.friendRequests=[].concat(Object(v.a)(e.friendRequests),[t.payload]))},removeFriendRequest:function(e,t){e.friendRequests=e.friendRequests.filter((function(e){return e.id!==t.payload}))},declineRequest:function(e,t){var a=e.friendRequests.filter((function(e){return e.id===t.payload}))[0];a&&(a.cancelled=!0)},acceptRequest:function(e,t){var a=e.friendRequests.filter((function(e){return e.id===t.payload}))[0];a&&(a.accepted=!0)}}}),fe=me.actions,ge=fe.clearFriends,pe=fe.addFriend,ve=fe.removeFriend,be=fe.addFriendRequest,he=(fe.removeFriendRequest,fe.declineRequest),Ee=fe.acceptRequest,ye=function(e){return e.friends.friends},xe=function(e){return e.friends.friendRequests},Ne=me.reducer,we="hidden",Oe="show",je="full",ke=Object(j.b)({name:"ui",initialState:{sidebarState:"hidden",topbarMessage:"",accountBackground:"",backgroundColor:"#191919",backgroundTint:"transparent",conversationBackground:"mthood"},reducers:{setSidebarState:function(e,t){switch(t.payload){case t.payload===we&&e.sidebarState!==we:e.sidebarState=we;break;case t.payload===Oe&&e.sidebarState!==Oe:e.sidebarState=Oe;break;case t.payload===je&&e.sidebarState!==je:e.sidebarState=je;break;default:e.sidebarState=Oe}},setTopbarMessage:function(e,t){e.topbarMessage=t.payload},setDefaultBackground:function(e,t){e.defaultBackground=t.payload},setColor:function(e,t){e.backgroundColor=t.payload},setTint:function(e,t){e.backgroundTint=t.payload},setConversationBackground:function(e,t){e.conversationBackground=t.payload}}}),Ce=ke.actions,Se=(Ce.setSidebarState,Ce.setTopbarMessage),Ie=(Ce.setDefaultBackground,Ce.setColor,Ce.setTint,Ce.setConversationBackground,function(e){return e.ui.topbarMessage}),Ae=ke.reducer,Re=Object(j.b)({name:"auth",initialState:{username:"",token:""},reducers:{setUserName:function(e,t){e.username=t.payload},setToken:function(e,t){e.token=t.payload},clearAuth:function(e){e.username="",e.token=""}}}),qe=Re.actions,He=qe.clearAuth,De=(qe.setUserName,qe.setToken,Re.reducer),Me=Object(j.b)({name:"globals",initialState:{devHost:"http://localhost:3000",prodHost:"http://localhost:3000",testHost:"http://localhost:3000",metadata:"",api:"http://localhost:3000",refreshExpire:-1},reducers:{setMetadata:function(e,t){e.metadata=t.payload},setRefreshExpire:function(e,t){e.refreshExpire=t.payload}}}),Te=Me.actions,We=(Te.setMetadata,Te.setRefreshExpire),Pe=function(e){return e.globals.prodHost},Fe=function(e){return e.globals.refreshExpire},Be=Me.reducer,Le=Object(j.a)({reducer:{auth:De,conversations:Z,account:te,invite:ue,friends:Ne,globals:Be,ui:Ae}}),ze={tagNameSearch:/^([a-zA-Z0-9_-]){1,20}$/,tagName:/^([a-zA-Z0-9_-]){8,20}$/,password:/^([a-zA-Z0-9\_\-\$\#\%\^\&\*\(\)]){8,32}$/,email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,firstName:/^([A-Z]){1}([a-zA-Z]){1,32}$/,lastName:/^([A-Z]){1}([a-zA-Z]){1,32}$/,messageBody:/^(.){1,200}$/,conversationName:/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]){4,64}$/},Je=(a(171),function(){var e=Object(l.a)(i.a.mark((function e(t,a){var n,r,o,c,s,l,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:3000/api/auth/login",{body:JSON.stringify({tagName:"".concat(t),password:"".concat(a)}),headers:{"content-type":"application/json"},method:"POST"});case 3:return n=e.sent,e.next=6,n.json();case 6:if(r=e.sent,o=r.statusCode,c=r.id,s=r.user,l=r.invites,d=r.refreshToken,401!==o&&400!==o){e.next=11;break}return console.log("Error: Unauthorized, invalid credentials"),e.abrupt("return",!1);case 11:if(500!==o){e.next=14;break}return console.log("Error: Server error while attempting login!"),e.abrupt("return",!1);case 14:return!0===d&&console.log("Refresh token successfully set and will timeout in 15 mins or "+Date.now()+9e5),console.log("Successfully logging in user",s.tagName),e.abrupt("return",{user:s,id:c,invites:l,refreshToken:d});case 19:return e.prev=19,e.t0=e.catch(0),console.log("Error: Unable to login. Please refresh.",e.t0),e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t,a){return e.apply(this,arguments)}}()),Ue=function(e,t,a){return!!(e&&t&&(null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.tagName)&&Array.isArray(null===t||void 0===t?void 0:t.conversations)&&Array.isArray(null===t||void 0===t?void 0:t.friends)&&Array.isArray(null===t||void 0===t?void 0:t.friendRequests)&&Array.isArray(a))};var Ze=function(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),s=Object(d.a)(c,2),f=s[0],g=s[1],j=Object(n.useState)(!1),k=Object(d.a)(j,2),C=k[0],S=k[1],I=Object(n.useState)(!1),A=Object(d.a)(I,2),R=A[0],q=A[1],H=Object(n.useState)([]),D=Object(d.a)(H,2),M=D[0],T=D[1],W=Object(m.b)(),F=Object(m.c)(ee),B=Object(n.useState)(!1),L=Object(d.a)(B,2),z=L[0],J=L[1],U=Object(n.useState)(!1),Z=Object(d.a)(U,2),Y=Z[0],$=Z[1],V=Object(n.useRef)(null);Object(n.useEffect)((function(){V.current&&V.current.focus()}),[]),Object(n.useEffect)(Object(l.a)(i.a.mark((function e(){var t,a,n,r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!1!==Y){e.next=22;break}return $(!0),e.next=5,fetch("http://localhost:3000/api/auth/refreshAccount",{credentials:"include"});case 5:if(!(t=e.sent)){e.next=22;break}return e.next=9,t.json();case 9:if(401===(null===(a=e.sent)||void 0===a?void 0:a.statusCode)&&(console.log("No valid refresh token. User must login"),S(!0),J(!1),$(!1)),n=a.id,r=a.user,o=a.invites,!0===a.refreshToken&&W(We(Date.now()+875e3)),!1!==Ue(n,r,o)){e.next=17;break}return J(!1),$(!1),e.abrupt("return");case 17:ae({user:r,invites:o}),W(X()),console.log("Successfully logged in user "+(null===r||void 0===r?void 0:r.tagName)),J(!1),$(!1);case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(0),console.log("No valid refresh token. User must login",e.t0),S(!0);case 28:case"end":return e.stop()}}),e,null,[[0,24]])}))),[]);var Q=function(){var e=!0;return!1===ze.tagName.test(a)&&(T(["Tag name must be 8-24 characters"].concat(Object(v.a)(M))),e=!1),!1===ze.password.test(f)&&(T(["Password must be 8-32 characters"].concat(Object(v.a)(M))),e=!1),e||q(!0),e};Object(n.useEffect)((function(){W(Se(""))}),[]);var te=function(){var e=Object(l.a)(i.a.mark((function e(){var t,n,r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q(!1),T([]),J(!0),Q()){e.next=7;break}return console.log("Invalid form field inputs",M),J(!1),e.abrupt("return");case 7:return e.next=9,Je(a,f);case 9:if(!1!==(t=e.sent)){e.next=15;break}return q(!0),J(!1),T(["Invalid Credentials"].concat(Object(v.a)(M))),e.abrupt("return");case 15:if(n=t.id,r=t.user,o=t.invites,!0===t.refreshToken&&W(We(Date.now()+875e3)),!1!==Ue(n,r,o)){e.next=22;break}return q(!0),J(!1),T(["Invalid Credentials"].concat(Object(v.a)(M))),e.abrupt("return");case 22:ae({user:r,invites:o}),W(X()),console.log("Successfully logged in user "+(null===r||void 0===r?void 0:r.tagName)),J(!1);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(e){var t=e.user,a=e.invites;if(W(K(null===t||void 0===t?void 0:t.email)),W(G(null===t||void 0===t?void 0:t.tagName)),W(_(null===t||void 0===t?void 0:t.id)),t.conversations.map((function(e){!0!==e.pending&&W(P({conversation:e}))})),t.friends.map((function(e){W(pe(e))})),t.friendRequests&&Array.isArray(null===t||void 0===t?void 0:t.friendRequests)){var n,r=Object(p.a)(null===t||void 0===t?void 0:t.friendRequests);try{for(r.s();!(n=r.n()).done;){var o=n.value;(null===o||void 0===o?void 0:o.recipientId)===(null===t||void 0===t?void 0:t.id)&&W(be(o))}}catch(l){r.e(l)}finally{r.f()}}if(a&&Array.isArray(a)){var c,s=Object(p.a)(a);try{for(s.s();!(c=s.n()).done;){var i=c.value;!0===(null===i||void 0===i?void 0:i.accepted)?W(se(i)):W(ce(i))}}catch(l){s.e(l)}finally{s.f()}}};return(null===F||void 0===F?void 0:F.loggedIn)?r.a.createElement(u.a,{to:"/home"}):r.a.createElement(b.a,{className:"h-100 w-100",fluid:!0},r.a.createElement(h.a,{className:"p-3 mt-5 text-white lead text-center"},r.a.createElement(E.a,{className:"p-3 text-center, mx-auto pt-5 mt-5 shadow",style:{borderRadius:"15px",backgroundColor:"#191919",opacity:.6,maxWidth:"500px"}},r.a.createElement("h2",{className:"text-white",style:{opacity:.8,marginBottom:"35px"}},"Welcome to ",r.a.createElement("span",{className:"text-danger"},"Project Zed")),r.a.createElement("h6",{className:"text-muted font-italic",style:{marginBottom:"35px"}},"Secured by you, for you"),Y?r.a.createElement(b.a,{fluid:!0,className:"text-center"},r.a.createElement(h.a,{className:"text-center pb-2"},r.a.createElement(E.a,{className:"text-center"},r.a.createElement("h6",null,"Welcome Back!"))),r.a.createElement(h.a,{className:"text-center pb-2"},r.a.createElement(E.a,{className:"text-center"},r.a.createElement("span",{className:"text-muted"},"Logging Back In!"))),r.a.createElement(h.a,{className:"text-center pt-4 pb-2"},r.a.createElement(E.a,null,r.a.createElement(y.a,{animation:"border",className:"mb-4",style:{height:100,width:100},variant:"success"})))):r.a.createElement("div",null,r.a.createElement(x.a,{className:"mb-5 mt-3"},r.a.createElement(N.a,{style:{marginLeft:"auto",marginRight:"auto",color:"white",opacity:.87,maxWidth:"400px",minHeight:"50px",border:"none",backgroundColor:"#404040"},placeholder:"@Tagname","aria-label":"@Tagname","aria-describedby":"basic-addon1",onKeyPress:function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,te();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onChange:function(e){return o(e.target.value)},ref:V})),r.a.createElement(x.a,{className:"mb-5"},r.a.createElement(N.a,{style:{marginLeft:"auto",marginRight:"auto",color:"white",opacity:.87,maxWidth:"400px",minHeight:"50px",border:"none",backgroundColor:"#404040"},type:"password",placeholder:"Password","aria-label":"Password","aria-describedby":"basic-addon1",onKeyPress:function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,te();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onChange:function(e){return g(e.target.value)}})),r.a.createElement(b.a,{fluid:!0,className:"border-top border-dark pt-2"},r.a.createElement(h.a,{className:"mt-3"},r.a.createElement(E.a,null,r.a.createElement(w.a,{style:{marginRight:30,backgroundColor:"#191919",color:"white",opacity:.87,border:"none"},variant:"dark",className:"mx-auto button-outline-black",onClick:function(){return document.getElementById("link-create-account").click()}},r.a.createElement(O.b,{id:"link-create-account",style:{textDecoration:"none",color:"white"},to:"/createAccount"},"Create\xa0Account")))),r.a.createElement(h.a,{className:"mt-3"},r.a.createElement(E.a,null,r.a.createElement(w.a,{style:{color:"white",backgroundColor:"#191919",opacity:.87,border:"none"},variant:"dark",className:"mx-auto button-outline-black ",onClick:function(){return document.getElementById("link-forgot-password").click()}},r.a.createElement(O.b,{id:"link-forgot-password",style:{textDecoration:"none",color:"white"},to:"/forgotPassword"},"Forgot\xa0Password?")))),r.a.createElement(h.a,{className:"mt-3 mb-2"},r.a.createElement(E.a,null,z?r.a.createElement(y.a,{animation:"border",className:"mb-4",style:{height:60,width:60},variant:"success"}):r.a.createElement(w.a,{onClick:te,size:"lg",className:"rounded-pill mb-4 mx-auto",variant:"outline-success",style:{opacity:.8,maxWidth:"200px",marginTop:"20px"},block:!0,disabled:!C},"Login"))),r.a.createElement(h.a,{className:"mt-3 mb-3"},R?r.a.createElement(E.a,{className:"text-center"},r.a.createElement("ul",null,M.map((function(e){return r.a.createElement("li",{key:e,className:"text-danger text-center lead font-italic"},e)})))):"",z?r.a.createElement(E.a,{className:"text-center"},r.a.createElement("span",{className:"text-success lead font-italic font-weight-bolder",style:{opacity:1,fontSize:"15pt"}},"Logging in...")):""))))))};a(173);function Ye(){return r.a.createElement("div",{key:"login-screen-div",className:"w-100 h-100"},r.a.createElement(Ze,null))}a(111);function $e(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),s=Object(d.a)(c,2),i=s[0],l=s[1],u=Object(n.useState)(!1),f=Object(d.a)(u,2),g=f[0],p=f[1],v=Object(n.useState)([]),y=Object(d.a)(v,2),O=y[0],j=y[1],k=Object(n.useState)(!1),C=Object(d.a)(k,2),S=C[0],I=C[1],A=Object(n.useState)(!1),R=Object(d.a)(A,2),q=R[0],H=R[1],D=Object(m.b)();return Object(n.useEffect)((function(){D(Se(""))}),[]),r.a.createElement(b.a,{className:"h-100 w-100 pb-5",fluid:!0},r.a.createElement(h.a,{className:"p-3 mt-5 text-white lead text-center"},r.a.createElement(E.a,{className:"p-3 text-center, mx-auto pt-5 mt-5 shadow",style:{borderRadius:"15px",backgroundColor:"#191919",opacity:.6,maxWidth:"500px"}},r.a.createElement("h4",{className:"text-white",style:{opacity:.8,marginBottom:"35px"}},"Forgotten Password"),r.a.createElement(x.a,{className:"mb-5 mt-3"},r.a.createElement(N.a,{style:{marginLeft:"auto",marginRight:"auto",color:"white",opacity:.87,maxWidth:"400px",minHeight:"50px",border:"none",backgroundColor:"#404040"},placeholder:"Enter Your Tagname","aria-label":"Enter Your Tagname","aria-describedby":"basic-addon1",className:q?"form-control-error":"form-control-normal",onChange:function(e){l(e.target.value)}})),r.a.createElement(x.a,{className:"mb-5 mt-3"},r.a.createElement(N.a,{style:{marginLeft:"auto",marginRight:"auto",color:"white",opacity:.87,maxWidth:"400px",minHeight:"50px",border:"none",backgroundColor:"#404040"},placeholder:"Enter Your Email","aria-label":"Enter Your Email","aria-describedby":"basic-addon1",className:S?"form-control-error":"form-control-normal",onChange:function(e){return o(e.target.value)}})),r.a.createElement(w.a,{onClick:function(){I(!1),H(!1),j([]),p(!1),function(){var e=!0,t=[];return!1===ze.email.test(a)&&(t.push("Invalid Email Address!"),I(!0),e=!1),!1===ze.tagName.test(i)&&(t.push("Tag name must be 8-24 characters"),H(!0),e=!1),e||(j(t),p(!0)),e}()?console.log("Sending forgot password request for user @".concat(i," with email ").concat(a)):console.log("Error with data submission: ",O)},size:"lg",className:"rounded-pill mb-4 mx-auto",variant:"outline-success",style:{opacity:.8,maxWidth:"200px"},block:!0},"Reset Password"),r.a.createElement(b.a,{fluid:!0,style:{opacity:1.2}},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-left"},r.a.createElement("ul",{style:{listStyleType:"none",marginRight:"auto",marginLeft:"auto",paddingRight:"30px"}},g?r.a.createElement("li",null,r.a.createElement("h6",{className:"border-bottom pb-2 border-danger text-danger font-weight-bold"},"Errors")):"",g?O.map((function(e){return r.a.createElement("li",{key:e,className:"font-italic lead text-danger"},e)})):"")))))))}function Ve(){return r.a.createElement("div",{className:"w-100 h-100"},r.a.createElement($e,null))}var _e=function(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),s=Object(d.a)(c,2),f=s[0],g=s[1],p=Object(n.useState)(""),v=Object(d.a)(p,2),y=v[0],O=v[1],j=Object(n.useState)(""),k=Object(d.a)(j,2),C=k[0],S=k[1],I=Object(n.useState)(!1),A=Object(d.a)(I,2),R=A[0],q=A[1],H=Object(n.useState)(!1),D=Object(d.a)(H,2),M=D[0],T=D[1],W=Object(n.useState)([]),P=Object(d.a)(W,2),F=P[0],B=P[1],L=Object(n.useState)(!1),z=Object(d.a)(L,2),J=z[0],U=z[1],Z=Object(n.useState)(!1),Y=Object(d.a)(Z,2),$=Y[0],V=Y[1],_=Object(n.useState)(!1),K=Object(d.a)(_,2),G=K[0],X=K[1],Q=Object(n.useState)(!1),ee=Object(d.a)(Q,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(!1),re=Object(d.a)(ne,2),oe=re[0],ce=re[1],se=Object(m.b)(),ie=function(){var e=!0,t=[];return y!==C&&(t.push("Passwords don't match"),U(!0),e=!1),!1===ze.tagName.test(a)&&(t.push("Invalid Tagname"),V(!0),e=!1),!1===ze.email.test(f)&&(t.push("Invalid Email"),X(!0),e=!1),!1===ze.password.test(y)&&(t.push("Invalid Password. Must be 10-32 characters and digits."),ae(!0),e=!1),!1===ze.password.test(C)&&(t.push("Invalid Second Password. Must be 10-32 characters and digits."),B(t),ae(!0),e=!1),e||(T(!0),B(t)),e},le=function(){var e=Object(l.a)(i.a.mark((function e(){var t,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T(!1),U(!1),V(!1),X(!1),ae(!1),ce(!1),ie()){e.next=5;break}return console.log("Error with data submission: ",F),e.abrupt("return");case 5:return t={email:f,password:y,session:0,tagName:a},e.next=8,fetch("http://localhost:3000/api/users/",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});case 8:return n=e.sent,e.next=11,n.json();case 11:r=e.sent,console.log(r),q(!0);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){se(Se(""))}),[]),R?r.a.createElement(u.a,{to:"/login"}):r.a.createElement(b.a,{className:"h-100 w-100",fluid:!0},r.a.createElement(h.a,{className:"p-3 mt-5 text-white lead text-center"},r.a.createElement(E.a,{className:"p-3 text-center, mx-auto pt-5 mt-5 shadow",style:{borderRadius:"15px",backgroundColor:"#191919",opacity:.6,maxWidth:"500px"}},r.a.createElement("h4",{className:"text-white",style:{opacity:.8,marginBottom:"55px"}},"Enter your account information"),r.a.createElement(x.a,{className:"mb-5 mt-3"},r.a.createElement(N.a,{style:{marginLeft:"auto",marginRight:"auto",color:"white",opacity:.87,maxWidth:"400px",minHeight:"50px",border:"none",backgroundColor:"#404040"},placeholder:"Email Address","aria-label":"Email Address","aria-describedby":"basic-addon1",onChange:function(e){return g(e.target.value)},className:G?"form-control-error":"form-control-normal"})),r.a.createElement(x.a,{className:"mb-5 mt-3"},r.a.createElement(N.a,{style:{marginLeft:"auto",marginRight:"auto",color:"white",opacity:.87,maxWidth:"400px",minHeight:"50px",border:"none",backgroundColor:"#404040"},placeholder:"Desired Tag Name","aria-label":"Desired Tag Name","aria-describedby":"basic-addon1",onChange:function(e){return o(e.target.value)},className:$?"form-control-error":"form-control-normal"})),r.a.createElement(x.a,{className:"mb-5 mt-3"},r.a.createElement(N.a,{style:{marginLeft:"auto",marginRight:"auto",color:"white",opacity:.87,maxWidth:"400px",minHeight:"50px",border:"none",backgroundColor:"#404040"},type:"password",placeholder:"Desired Password","aria-label":"Desired Password","aria-describedby":"basic-addon1",onChange:function(e){return O(e.target.value)},className:te||J?"form-control-error":"form-control-normal"})),r.a.createElement(x.a,{className:"mb-5 mt-3"},r.a.createElement(N.a,{style:{marginLeft:"auto",marginRight:"auto",color:"white",opacity:.87,maxWidth:"400px",minHeight:"50px",border:"none",backgroundColor:"#404040"},type:"password",placeholder:"Confirm Password","aria-label":"Confirm Password","aria-describedby":"basic-addon1",onChange:function(e){return S(e.target.value)},className:oe||J?"form-control-error":"form-control-normal"})),r.a.createElement(w.a,{onClick:le,size:"lg",className:"rounded-pill mb-4 mx-auto",variant:"outline-success",style:{opacity:.8,maxWidth:"200px"},block:!0},"Sign Up"),r.a.createElement(b.a,{fluid:!0,style:{opacity:1.2}},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-left"},r.a.createElement("ul",{style:{listStyleType:"none",marginRight:"auto",marginLeft:"auto",paddingRight:"30px"}},M?r.a.createElement("li",null,r.a.createElement("h6",{className:"border-bottom pb-2 border-danger text-danger font-weight-bold"},"Errors")):"",M?F.map((function(e){return r.a.createElement("li",{key:e,className:"font-italic lead text-danger"},e)})):"")))))))};function Ke(){return r.a.createElement("div",{className:"w-100 h-100"},r.a.createElement(_e,null))}var Ge=a(80),Xe=a.n(Ge),Qe=a(28),et=null,tt={connectSuccess:"connectSuccess",connectError:"connectError",delivered:"delivered",deliveryError:"deliveryError",readReceipt:"readReceipt",typing:"typing",listening:"listening",unlistened:"unlistened",unlistenError:"unlistenError",currentConversationUpdate:"currentConversationUpdate",setCurrentConversationError:"setCurrentConversationError",refreshSuccess:"refreshSuccess",refreshError:"refreshError",messagePinned:"messagePinned",messagePinnedError:"messagePinnedError"},at={connect:"connect",disconnect:"disconnect",chatToServer:"chatToServer",readMessage:"readMessage",typing:"typing",listen:"listen",unlisten:"unlisten",setCurrentConversation:"setCurrentConversation",pinMessage:"pinMessage"};function nt(){var e=Object(m.c)(ee),t=Object(m.c)(z),a=Object(m.c)(L),o=Object(m.b)(),c=Object(m.c)(Pe),s=Object(m.c)(ye);return Object(n.useEffect)((function(){if(t&&t.id&&e&&"0"!==t.id){console.log("Setting up chat socket"),et=Xe()("".concat(c,"/chat"),{transportOptions:{polling:{extraHeaders:{credentials:"include"}}},forceNew:!0}),console.log("Setting up chat socket event listeners and listening to rooms"),console.log("Setting up listeners"),et.on(tt.listening,(function(e){console.log("Successfully listening on room with ID ".concat(e.room))})),et.on(tt.connectSuccess,(function(e){console.log("Connected to socket.io server successfully with client id ".concat(e.socketId))})),et.on(tt.connectError,(function(e){console.log("Error: Cannot connect to socket.io server | ".concat(e.message))})),et.on(tt.delivered,(function(a){console.log("Handle message | ".concat(a.message.id," | delivered")),e.id!==a.message.user.id&&a.message.conversation.id!==t.id&&Qe.a.info("Message received from: ".concat(a.message.user.tagName),{position:"top-center",hideProgressBar:!0,pauseOnHover:!0}),a.message.id&&a.message.body&&a.message.createdAt&&(console.log("Adding message to state ... | ".concat(a.message.id)),o(T({message:a.message,conversation:a.message.conversation})))})),et.on(tt.deliveryError,(function(){console.log("Error: server error while marking message as delivered")})),et.on(tt.readReceipt,(function(e){console.log("Handle message | ".concat(e.message.id," | read receipt")),e.message.id&&e.message.body&&e.message.createdAt&&(console.log("Adding message read receipt to state ... | ".concat(e.message.id)),o(M({messageId:e.message.id,convId:e.message.conversation.id})))})),et.on(tt.typing,(function(a){if(console.log("Handle typing event conversation | ".concat(a.conv)),a.conv&&a.user){if(a.user.id===e.id)return;t.id===a.conv&&o(D(a.typing||!1))}})),et.on(tt.unlistened,(function(e){console.log("Handle unlisten event for conversation | ".concat(e.room))})),et.on(tt.unlistenError,(function(e){console.log("Error: unlisten event error for conversation | ".concat(e.msg))})),et.on(tt.currentConversationUpdate,(function(e){if(console.log("Handle current conversation update event for user | ".concat(e.user.tagName)),e.user){var t=s.filter((function(t){return t.id===e.user.id}))[0];t&&(console.log("Handle set current conversation for friend @".concat(e.user.tagName)),t=e.user)}})),et.on(tt.setCurrentConversationError,(function(e){console.log("Error: set current conversation event error | ".concat(e.msg))})),et.on(tt.refreshSuccess,(function(e){console.log("Handle success refresh socket client ID with server ".concat(e.clientId))})),et.on(tt.refreshError,(function(e){console.log("Handle error for refresh socket client ID with server error ".concat(e.msg))})),et.on(tt.messagePinned,(function(e){console.log("Handle message pinned from server",e),o(B(e.message))})),et.on(tt.messagePinnedError,(function(e){console.log("Handle message pinned error from server",e)})),function(n){if(console.log("Listening to all rooms",a),a&&Array.isArray(a)){var r,o=Object(p.a)(a);try{for(o.s();!(r=o.n()).done;){var c=r.value;c&&c.id&&!1===c.pending&&(console.log("listening to conversation",c),n.emit(at.listen,{room:c.id,user:e.id}))}}catch(s){o.e(s)}finally{o.f()}}else n.emit(at.listen,{room:t.id,user:e.id})}(et),et.emit("refresh",{userId:e.id,refresh:!0})}else et=null;return function(){et&&(Object.keys(tt).map((function(e){return et.off(e)})),et.close(),et=null)}}),[t.id]),r.a.createElement(r.a.Fragment,null)}var rt,ot=a(246);function ct(){var e=Object(n.useState)({width:void 0,height:void 0}),t=Object(d.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){function e(){r({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),a}function st(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],o=t[1],c=Object(m.c)(ee),s=Object(m.c)(z),u=Object(n.useRef)(null),f=Object(n.useState)(null),g=Object(d.a)(f,2),p=g[0],b=g[1],O=ct(),j=Object(n.useState)(!1),k=Object(d.a)(j,2),C=k[0],S=k[1],I=Object(n.useState)([]),A=Object(d.a)(I,2),R=A[0],q=A[1],H=Object(n.useState)(!1),D=Object(d.a)(H,2),M=D[0],T=D[1],W=function(){var e=!0;return!1===ze.messageBody.test(a)&&(q(["Invalid message body. Must be 1-200 characters."].concat(Object(v.a)(R))),e=!1),e||S(!0),e},P=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W()){e.next=3;break}return console.log("Error with sending message",R),e.abrupt("return");case 3:console.log("Send message ",a),et?(et.emit("chatToServer",{sender:c.tagName,room:s.id,body:"".concat(a)}),T(!0),u.current.value=""):(S(!0),q(["Corrupted chat socket. Please refresh."]),console.log("Corrupted chat socket. Please refresh."));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(e){et&&c&&s?et.emit("typing",{sender:c.tagName,room:s.id,typing:e}):console.log("Error: no conversation to send typing to! Please refresh")};return Object(n.useEffect)((function(){et&&u&&s&&c&&(u.current.onkeypress=function(){void 0!==rt&&clearTimeout(rt),rt=setTimeout((function(){console.log("typing done"),b(!1),F(!1)}),1e3)})}),[s.id]),Object(n.useEffect)((function(){s.messages&&Array.isArray(s.messages)&&T(!1)}),[s.messages]),r.a.createElement("div",null,r.a.createElement(h.a,{className:"w-100 text-center",style:{position:"fixed",bottom:40,left:50}},O.width>768?r.a.createElement(E.a,{style:{minWidth:"240px",maxWidth:"240px"}}):"",r.a.createElement(E.a,{className:"mx-auto",style:{paddingRight:"15px",paddingLeft:O.width>768?"2%":"5%"}},C?r.a.createElement("div",{className:"text-danger lead",style:{opacity:.7}},R):"",r.a.createElement(x.a,{className:"pb-3 mx-auto"},r.a.createElement(N.a,{style:{backgroundColor:"#404040",color:"white",border:"none"},placeholder:"Enter a Message","aria-label":"Enter a Message","aria-describedby":"basic-addon2",className:"rounded-pill p-4",ref:u,onKeyPress:function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,P();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onChange:function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:et&&!p&&(b(!0),F(!0),console.log("Typing started")),o(t.target.value);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),r.a.createElement(x.a.Append,null,M?r.a.createElement(y.a,{className:"m-2 p-2",size:"lg",variant:"info",animation:"border"}):r.a.createElement(w.a,{onClick:Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:case"end":return e.stop()}}),e)}))),className:"ml-1 rounded-pill text-right",variant:"outline-secondary",style:{border:"none",backgroundColor:"#404040",color:"#02a5ff"},id:"basic-addon2"},r.a.createElement(ot.a,{style:{color:"white",opacity:"0.87"}}))))),r.a.createElement(E.a,{xs:"1"})))}var it=a(249),lt=a(261),dt=a(56),ut=a.n(dt),mt=a(135),ft=a.n(mt),gt=a(57),pt=a.n(gt);a(29);function vt(e){var t=e.sentByMe,a=e.deleteMessage,n=e.pinMessage;return r.a.createElement(lt.a,{className:t?"msg-dropdown message-dropdown-sender light-hover":"msg-dropdown message-dropdown-received light-hover",drop:t?"left":"right"},r.a.createElement(lt.a.Toggle,{as:w.a,variant:"dark",className:"message-menu-button"},r.a.createElement(ut.a,null)),r.a.createElement(lt.a.Menu,{style:{backgroundColor:"#222222",minWidth:"80px"},className:"my-dropdown-message shadow text-white text-center"},r.a.createElement(lt.a.Item,{className:"text-white shadow dropdown-item-message",as:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),n&&n()}},"Pin\xa0",r.a.createElement(ft.a,null)),t?r.a.createElement(lt.a.Item,{className:"text-white shadow dropdown-item-message",as:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),a&&a()}},"Delete\xa0",r.a.createElement(pt.a,null)):""))}a(200);var bt=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ht=function(e){var t=new Date(Date.parse(e));return{hour:t.getHours(),min:t.getMinutes(),pm:t.getHours()>12,day:t.getTime()<Date.now()-864e5?bt[t.getDay()]:"",minsAgo:(Date.now()-t)/1e3/60}};function Et(e){var t=e.message,a=e.isBottom,o=ht(t.createdAt),c=Object(n.useState)(!1),s=Object(d.a)(c,2),i=s[0],l=s[1],u=ct();return r.a.createElement(b.a,{key:Math.random(),className:"mt-2 mb-2",style:{marginTop:"auto",minHeight:"80px"},fluid:!0},r.a.createElement(h.a,{onMouseLeave:function(){return l(!1)}},r.a.createElement(E.a,{xs:"12",className:"text-right pr-2"},r.a.createElement(b.a,{fluid:!0,className:u.width>768?"pr-5":""},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"text-right message-me-column",onMouseEnter:function(){l(!0)}},r.a.createElement(it.a,{className:"p-2 m-1 text-white text-left message-from-me message-column",style:{borderRadius:"18px 18px 5px 18px",display:"block",backgroundColor:"#3266a8",wordWrap:"break-word"}},t.body)),r.a.createElement(E.a,{xs:"1",style:{maxWidth:"20px"},className:"text-right"},i?r.a.createElement(vt,{sentByMe:!0,pinMessage:function(){alert("message pinned")},deleteMessage:function(){alert("message del")}}):""))))),i||a?r.a.createElement(h.a,{style:{opacity:.8}},r.a.createElement(E.a,{xs:"12",className:"text-right pr-3"},r.a.createElement(b.a,{fluid:!0,className:u.width>768?"pr-5":""},r.a.createElement(h.a,null,r.a.createElement(E.a,{xs:u.width>768?"8":"6",className:"text-center"}),r.a.createElement(E.a,{className:"text-right"},r.a.createElement("span",{style:{opacity:.7,fontSize:"10pt"},className:"font-italic text-left text-white text-small"},"".concat(!0===t.read?"Read - ":" Delivered - "),o.minsAgo<60?"".concat(o.minsAgo.toFixed()>0?o.minsAgo.toFixed()+" mins ago":"Now"):"".concat(o.day?o.day+", ":"Today, ").concat(o.hour,":").concat(o.min<10?"0"+o.min:o.min).concat(o.pm?"PM":"AM"))))))):"")}function yt(e){var t=e.message,a=ht(t.createdAt),o=Object(n.useState)(!1),c=Object(d.a)(o,2),s=c[0],i=c[1];return r.a.createElement(b.a,{key:Math.random(),className:"mt-2 mb-2 p-1",style:{marginTop:"auto",minHeight:"80px"},fluid:!0},r.a.createElement(h.a,{onMouseLeave:function(){return i(!1)}},r.a.createElement(E.a,{xs:"12",className:"text-left"},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,null,r.a.createElement(E.a,{xs:"1",style:{maxWidth:"20px"},className:"text-left"},s?r.a.createElement(vt,{pinMessage:function(){alert("message pinned")},sentByMe:!1}):""),r.a.createElement(E.a,{className:"text-left message-me-column",onMouseEnter:function(){i(!0)}},r.a.createElement(it.a,{className:"p-2 m-1 text-white text-left message-from-other message-column",style:{borderRadius:"5px 18px 18px 18px",display:"block",backgroundColor:"#1E3D64",wordWrap:"break-word"}},t.body)))))),r.a.createElement(h.a,{style:{opacity:.8,maxHeight:"10px"}},r.a.createElement(E.a,{xs:"9",className:"text-left pl-4 pt-2",style:{opacity:.7}},r.a.createElement("span",{className:"font-italic text-left text-white"},r.a.createElement("span",{style:{opacity:.7,fontSize:"10pt"},className:"text-white text-small"},"@".concat(t.user.tagName," ")),a.minsAgo<60?"- ".concat(a.minsAgo.toFixed()>0?a.minsAgo.toFixed()+" mins ago":"Now"):"- ".concat(a.day?a.day+", ":"Today, ").concat(a.hour,":").concat(a.min<10?"0"+a.min:a.min," ").concat(a.pm?"PM":"AM"))),r.a.createElement(E.a,{xs:"3",className:"text-center"})))}function xt(e){var t=e.message,a=e.isBottom,n=Object(m.c)(ee);return t.user.id===n.id?r.a.createElement(Et,{message:t,isBottom:a}):r.a.createElement(yt,{message:t})}a(201),a(126);function Nt(e){var t=e.defaultView,a=Object(n.useState)(!1),o=Object(d.a)(a,2),c=o[0],s=o[1],u=Object(n.useState)([]),f=Object(d.a)(u,2),g=f[0],p=f[1],v=Object(n.useState)(!1),x=Object(d.a)(v,2),N=x[0],w=x[1],O=Object(m.c)(z),j=ct(),k=Object(n.useRef)(),C=Object(m.b)();O||(O={});var S=j.height-j.height/8;isNaN(S)&&(S=window.innerHeight-window.innerHeight/8);var R=function(){var e=Object(l.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Requesting more messages for conversation "+O.id),e.next=3,fetch("http://localhost:3000/api/conversation/messages/range/?"+new URLSearchParams({id:O.id,beforeDate:O.messages[0].createdAt,number:25}),{headers:{credentials:"include"}});case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,Array.isArray(a)&&(console.log(a),C(I({messages:a,conversationId:O.id})));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(l.a)(i.a.mark((function e(){var t,a,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k.current){e.next=8;break}if(!((null===(t=k.current)||void 0===t?void 0:t.scrollTop)<=100&&!0!==N)){e.next=8;break}if(!((null===(a=O)||void 0===a||null===(n=a.messages)||void 0===n?void 0:n.length)<(null===(r=O)||void 0===r?void 0:r.numberOfMessages))){e.next=8;break}if(!1!==N){e.next=8;break}return w(!0),e.next=7,R();case 7:w(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){O&&O.messages&&(C(A()),p(O.messages)),k&&k.current&&!1===N&&(k.current.scrollTop=k.current.scrollHeight)}),[O.messages]),Object(n.useEffect)((function(){k&&k.current&&!1===N&&(k.current.scrollTop=k.current.scrollHeight)}),[g]),Object(n.useEffect)((function(){O&&void 0!==O.typing&&(console.log("Typing"),s(O.typing))}),[O.typing]),t?r.a.createElement(h.a,null,r.a.createElement(E.a,{xs:"3"}),r.a.createElement(E.a,{className:"mt-5 lead",style:{opacity:.87,color:"#404040"}},r.a.createElement("span",{style:{marginTop:"auto"}},"Click a conversation")),r.a.createElement(E.a,{xs:"3"})):r.a.createElement(h.a,{className:"w-100",style:{marginTop:75}},j.width>768?r.a.createElement(E.a,{style:{minWidth:"240px",maxWidth:"240px"}}):"",r.a.createElement(E.a,{style:{paddingLeft:j.width>768?"0%":"3%"}},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,{style:{height:S}},r.a.createElement(E.a,{ref:k,onScroll:q,className:"ul",style:{bottom:150,paddingBottom:50,paddingTop:100,height:S-10,overflowY:"scroll",position:"fixed",paddingLeft:"20px",paddingRight:"85px",width:j.width>768?j.width-240:j.width,maxWidth:j.width>768?j.width-240:j.width}},g.map((function(e,t){return r.a.createElement(h.a,{key:e.id+"row",className:"messages-list-item"},r.a.createElement(xt,{key:e.id,message:e,isBottom:t>=g.length-1}))})))),c||N?r.a.createElement(h.a,null,r.a.createElement(b.a,{key:Math.random(),style:{position:"fixed",bottom:120},className:"typing-list-item-container",fluid:!0},r.a.createElement(h.a,{className:"mt-1 mb-1"},r.a.createElement(E.a,{xs:"1"}),r.a.createElement(E.a,{xs:"9",className:"text-left"},r.a.createElement("div",{className:"p-2 m-1 text-white typing-list-item",style:{borderRadius:"18px",display:"inline-block",whiteSpace:"nowrap",backgroundColor:"#1E3D64"}},N?r.a.createElement("span",null,r.a.createElement("span",{className:"font-italic text-muted",style:{fontSize:"18pt"}},"Loading Messages"),"\xa0\xa0",r.a.createElement(y.a,{animation:"grow",size:"lg"})):"",c?r.a.createElement("span",null,r.a.createElement(y.a,{animation:"grow",size:"lg"}),r.a.createElement(y.a,{animation:"grow",size:"lg"}),r.a.createElement(y.a,{animation:"grow",size:"lg"})):"")),r.a.createElement(E.a,{xs:"3",className:"text-center"})),r.a.createElement(h.a,{className:"",style:{marginTop:-10}},r.a.createElement(E.a,{xs:"9",className:"text-left pl-4"},r.a.createElement("span",{className:"font-italic text-left text-muted"})),r.a.createElement(E.a,{xs:"3",className:"text-center"})))):"")))}function wt(){var e=ct(),t=Object(m.c)(J);return t?r.a.createElement(b.a,{fluid:!0}):r.a.createElement(b.a,{className:"pl-3",style:{minHeight:e.height,height:e.height},fluid:!0},r.a.createElement(h.a,{style:{minHeight:e.height-150,height:e.height-150,paddingBottom:"auto"}},r.a.createElement(Nt,{defaultView:t,style:{minHeight:e.height,height:e.height}})),r.a.createElement(h.a,{style:{minHeight:20}}),r.a.createElement(h.a,{className:"pb-2"},r.a.createElement(st,null)),r.a.createElement(h.a,{style:{minHeight:20}}))}var Ot=a(265),jt=a(252),kt=a(250),Ct=a(253),St=a(267),It=a(254),At=a(264);a(52);function Rt(e){var t=e.conversation,a=e.selectConversation,n=e.deleteConversation,o=e.selected,c=e.minWidth,s=e.buttonMargin;return r.a.createElement(St.a,{onClick:function(){return a(t)},key:t.id,className:o?"sidebar-list-item light-selected":"sidebar-list-item light-hover",style:{backgroundColor:"#222222"}},r.a.createElement(b.a,{fluid:!0,style:{backgroundColor:"#222222"},className:o?"light-selected":"light-hover"},r.a.createElement(h.a,{style:{backgroundColor:"#222222"},className:o?"light-selected":"light-hover"},r.a.createElement(E.a,{className:o?"conv-info light-selected":"conv-info light-hover",style:{minWidth:c}},r.a.createElement(b.a,{fluid:!0,className:o?"light-selected":"light-hover"},r.a.createElement(h.a,{className:"font-italic text-primary",style:{fontSize:"11pt",minWidth:c}},t.conversationName),r.a.createElement(h.a,{className:"w-100",style:{fontSize:"9pt"}},r.a.createElement("div",{className:"ml-1 d-block text-truncate"},t.messages[0].body)),r.a.createElement(h.a,{className:"lead w-100 mt-1",style:{fontSize:"8pt"}},r.a.createElement("div",{className:"ml-1 d-block font-italic"},new Date(Date.parse(t.createdAt)).toLocaleString("en-US"))))),r.a.createElement(E.a,{className:o?"hide-conv-info text-right light-selected":"hide-conv-info text-right light-hover",style:{backgroundColor:"#222222",marginLeft:s}},r.a.createElement(b.a,{className:o?"light-selected":"light-hover",style:{backgroundColor:"#222222"},fluid:!0},r.a.createElement(lt.a,{className:o?"light-selected":"light-hover",style:{backgroundColor:"#222222",marginLeft:"-20px"}},r.a.createElement(lt.a.Toggle,{className:"dropdown-toggle-conv-info text-white",style:{border:" none",backgroundColor:"#222222"},as:w.a,variant:"dark",id:"dropdown-custom-components"},r.a.createElement(ut.a,null)),r.a.createElement(lt.a.Menu,{style:{backgroundColor:"#222222"},className:"my-dropdown shadow text-white text-center"},r.a.createElement(lt.a.Item,{className:"text-white shadow conv-dropdown p-2",as:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),n&&n(t.id)}},"Delete\xa0",r.a.createElement(pt.a,null)))))))))}var qt=Object(kt.a)((function(){return{animate_in:{width:0,visibility:"invisible",flexShrink:0,animationName:"fadeout",animationDuration:"1s"},animate_out:{width:"200px",flexShrink:0,animationName:"fadeout",animationDuration:"1s"},"@keyframes fadeout":{"0%":{width:"25%"},"100%":{width:0,display:"none",opacity:1}},"@keyframes fadein":{"0%":{width:0,opacity:0},"100%":{width:"25%",opacity:1}},narrowPaper:{minWidth:"240px",maxWidth:"240px",backgroundColor:"#222222",opacity:.8},hidePaper:{backgroundColor:"#222222",width:"0%"},fullDrawerPaper:{width:"100%",backgroundColor:"#222222"},drawerContainer:{backgroundColor:"#222222",color:"white",paddingRight:"20px",overflowX:"hide"}}}));function Ht(){var e=ct(),t=qt(),a=e.width<768,o=Object(m.c)(L),c=Object(n.useState)([]),s=Object(d.a)(c,2),i=s[0],l=s[1],f=Object(m.b)(),g=Object(m.c)(U),p=Object(m.c)(ee),v=Object(n.useState)(""),h=Object(d.a)(v,2),E=h[0],y=h[1],O=Object(u.g)(),j=Object(u.h)(),k=Object(m.c)(z),C=Object(n.useState)(!1),S=Object(d.a)(C,2),I=S[0],A=S[1],q=Object(n.useState)(!1),D=Object(d.a)(q,2),M=D[0],T=D[1],P=Object(n.useState)(!1),B=Object(d.a)(P,2),J=B[0],Z=B[1],Y=function(t){if(!t.pending)return console.log("Setting current conversation...",t),console.log(O,j),Z(!1),"/home"!==j.pathname&&O.push("/home"),k.conversationName===t.conversationName?(f(H(!1)),void f(R(!1))):(t&&""!==t.conversationName&&e.width>768&&k.conversationName!==t.conversationName&&f(Se(t.conversationName)),t&&""!==t.conversationName&&e.width<=768&&k.conversationName!==t.conversationName&&f(Se("")),f(H(!1)),f(W({conversation:t})),et&&et.emit("setCurrentConversation",{user:p,conversationId:t.id},(function(){return console.log("Emitted setCurrentConversation successfully")})),void f(R(!1)));console.log("Conversation is pending invite accept",t)},$=function(e){console.log("Deleting Conversation "+e),k&&k.id===e&&(f(R(!0)),f(Se("")),Z(!0)),f(F({id:e}))};Array.isArray(o)&&o.length>1&&(o=o.filter((function(e,t,a){return a.indexOf(e)===t})));var V=function(e,t,a){return(e||t)&&a?"450px":e&&!a?"0px":"200px"}(a,J,g),_=function(e,t){return e&&t?"150px":e&&!t?"0px":"-5px"}(a,g);return r.a.createElement(Ot.a,{variant:"permanent",classes:{paper:(a||J)&&g?t.fullDrawerPaper:a&&!g?t.hidePaper:t.narrowPaper}},r.a.createElement(jt.a,null),r.a.createElement("div",{className:t.drawerContainer},r.a.createElement(Ct.a,{style:{opacity:.8}},r.a.createElement(St.a,{style:{maxWidth:"500px",maxHeight:"120px"},className:"text-small text-center mx-auto",selected:!1,key:"sidebar-search"},r.a.createElement(b.a,{fluid:!0},r.a.createElement(x.a,{className:"mx-auto"},r.a.createElement(N.a,{style:{textAlign:"center"},placeholder:"Search","aria-label":"Search","aria-describedby":"basic-addon1",onChange:function(e){return y(e.target.value)},className:"mx-auto lead form-control-custom",autoComplete:"new-password"}),r.a.createElement(x.a.Append,{style:{maxWidth:"30px"}},r.a.createElement(At.a,{title:"Search Chat Names"},r.a.createElement(w.a,{variant:"dark",onClick:function(){return function(){if(T(!1),E.length>4){if(!1===ze.conversationName.test(E))return console.log("Input failed for searching a conversation name"),void T(!0);var e=o.filter((function(e){return e.conversationName.includes(E)||E.includes(e.conversationName)}));e.length>0?(l(e),A(!0)):T(!0)}else T(!0)}()},className:"custom-sidebar-search-button",style:{backgroundColor:"#404040",border:"none"}},r.a.createElement(It.a,{className:M?"error-icon":"",style:{color:"#EEEEEE"}}))),I?r.a.createElement(At.a,{title:"Exit Search"},r.a.createElement(w.a,{variant:"dark",onClick:function(){return A(!1)},className:"custom-sidebar-search-button",style:{backgroundColor:"#404040",border:"none"}},"X")):"")))),I?i.map((function(e){return!0===e.pending?"":r.a.createElement(Rt,{conversation:e,selectConversation:Y,deleteConversation:$,buttonMargin:_,selected:k.conversationName===e.conversationName,minWidth:V,key:e.id})})):o.map((function(e){return!0===e.pending?"":r.a.createElement(Rt,{conversation:e,selectConversation:Y,deleteConversation:$,buttonMargin:_,selected:k.conversationName===e.conversationName,minWidth:V,key:e.id})})))))}function Dt(){return Object(m.c)(U)?r.a.createElement(Ht,null):r.a.createElement("div",{className:"w-100 h-100"},r.a.createElement(nt,null),r.a.createElement(Ht,null),r.a.createElement(b.a,{fluid:!0,className:"w-100 h-100"},r.a.createElement(wt,{className:"w-100 h-100"})))}var Mt=a(88),Tt=a.n(Mt),Wt=a(137),Pt=a.n(Wt),Ft=null,Bt={received:{connectSuccess:"connectSuccess",connectError:"connectError",inviteReceived:"inviteReceived",inviteSent:"inviteSent",inviteSentError:"inviteSentError",acceptedInvite:"acceptedInvite",acceptInviteError:"acceptInviteError",friendRequestSent:"friendRequestSent",friendRequestSentError:"friendRequestSentError",friendRequestDeclined:"friendRequestDeclined",friendRequestDeclinedError:"friendRequestDeclinedError",friendAdded:"friendAdded",acceptFriendRequestError:"acceptFriendRequestError",friendRemoved:"friendRemoved",friendRemovedError:"friendRemovedError",refreshNotificationSuccess:"refreshNotificationSuccess"},sent:{connect:"connect",disconnect:"disconnect",sendInvite:"sendInvite",acceptInvite:"acceptInvite",sendFriendRequest:"sendFriendRequest",declineFriendRequest:"declineFriendRequest",acceptFriendRequest:"acceptFriendRequest",removeFriend:"removeFriend"}},Lt=function(e,t){var a=!1;if(t&&Array.isArray(t)){var n,r=Object(p.a)(t);try{for(r.s();!(n=r.n()).done;){if(n.value.id===e){a=!0;break}}}catch(o){r.e(o)}finally{r.f()}}return a},zt=function(e,t){return Lt(e,t)},Jt=function(e,t){return Lt(e,t)},Ut=function(e,t){return Lt(e,t)};function Zt(){var e=Object(m.c)(ee),t=Object(m.b)(),a=Object(m.c)(L),r=Object(m.c)(Pe),o=Object(m.c)(ie),c=Object(m.c)(le),s=Object(m.c)(ye),i=Object(m.c)(xe);return Object(n.useEffect)((function(){console.log("Attemping to establish notifications socket");if(!0===e.loggedIn)try{return console.log("Attemping connection to notifications socket gateway"),function(e,t,a,n,r,o,c,s){e.on(Bt.received.connectSuccess,(function(e){console.log("Successfully connected to notifications namespace with client ID | ".concat(e.clientId))})),e.on(Bt.received.connectError,(function(e){console.log("Error: cannot connect to notifications namespace... error from server | ".concat(e.err))})),e.on(Bt.received.inviteReceived,(function(e){try{if(console.log("Handle invite received from user @".concat(e.user.tagName)),zt(e.invite.id,s))return void console.log("Error: Invite already received with ID | ".concat(e.invite.id," |"));e.invite.recipientId===a.id&&e.conv&&o&&0===o.filter((function(t){return t.id===e.invite.conversationId})).length&&(t(P({conversation:e.conv})),e.invite.sender=e.user,t(ce(e.invite)),console.log("Handle invite received successfully from user @".concat(e.user.tagName," for new conversation ").concat(e.conv.id)),Qe.a.info("Invite received from: @".concat(e.invite.user.tagName),{position:"top-center",hideProgressBar:!0,pauseOnHover:!0}))}catch(n){console.log("Error: Handle invite received error | ".concat(n))}})),e.on(Bt.received.inviteSent,(function(e){try{if(console.log("Handle invite successfully sent event for conversation ".concat(e.conv.id)),zt(e.invite.id,c))return void console.log("Error: Invite already sent with ID | ".concat(e.invite.id," |"));if(!(e&&e.conv&&e.invite))throw"Error: Invite sent data received from the server is malformed | ".concat(e);t(oe(e.invite)),console.log("Invite | ".concat(e.invite.id," | for conversation | ").concat(e.conv.id," | saved and successfully added to state")),Qe.a.info("Invite successfully sent!",{position:"top-center",hideProgressBar:!0,pauseOnHover:!0})}catch(a){console.log("Error with sending invite from server",a)}})),e.on(Bt.received.inviteSentError,(function(e){console.log("Handle invite sent error from server | ".concat(e.msg))})),e.on(Bt.received.acceptedInvite,(function(e){if(console.log("Handle conversation invite accepted by user ID | ".concat(e.invite.recipientId)),e.conv&&e.invite&&e.invite.senderId===a.id){console.log("Setting conversation with ID | ".concat(e.conv.id," | to not pending for sender")),t(F({id:e.conv.id})),t(P({conversation:e.conv}));var r=n.filter((function(t){return t.id===e.invite.recipientId}))[0];r?Qe.a.info("Conversation Invite accepted by @".concat(r.tagName),{position:"top-center",hideProgressBar:!0,pauseOnHover:!0}):console.log("Error: friend with ID | ".concat(e.invite.senderId," | does not exist, cannot accept conversation!"),e.invite,n)}else if(e.conv&&e.invite&&e.invite.recipientId===a.id){console.log("Setting conversation with ID | ".concat(e.conv.id," | to not pending")),t(P({conversation:e.conv}));var o=n.filter((function(t){return t.id===e.invite.senderId}))[0];o?Qe.a.info("Conversation Invite accepted by @".concat(o.tagName),{position:"top-center",hideProgressBar:!0,pauseOnHover:!0}):console.log("Error: friend with ID | ".concat(e.invite.senderId," | does not exist, cannot accept conversation!"),e.invite,n)}else console.log("Error: accepted invite data from server incorrectly formatted!",e)})),e.on(Bt.received.acceptInviteError,(function(e){console.log("Handle accept invite error from server | ".concat(e.msg))})),e.on(Bt.received.friendRequestSent,(function(e){if(console.log("Handle friend request sent event"),e&&e.friendRequest){var r=e.friendRequest.recipientId,o=e.friendRequest.sender.id;return r===a.id?Jt(o,n)?void console.log("Error: Cannot receive a friend request from user that is already in friend's list!",e.friendRequest.sender,n):(t(be(e.friendRequest)),Qe.a.info("Friend request received from user @".concat(e.friendRequest.sender.tagName),{position:"top-center",hideProgressBar:!0,pauseOnHover:!0}),void console.log("Successfully received friend request with ID | ".concat(e.friendRequest.id," | and added to state"))):o===a.id?Jt(r,n)?void console.log("Error: Cannot send a friend request to a user that is already in friend's list!",e.friendRequest.recipientId,n):(t(be(e.friendRequest)),Qe.a.info("Successfully sent friend request to ".concat(e.friendRequest.recipientId),{position:"top-center",hideProgressBar:!0,pauseOnHover:!0}),void console.log("Successfully sent friend request with ID | ".concat(e.friendRequest.id," | and added to state"))):void console.log("Error: Friend request object does not contain a user with ID equal to this account!",e.friendRequest)}console.log("Error: malformed friend request sent event message object! ".concat(e))})),e.on(Bt.received.friendRequestSentError,(function(e){console.log("Error: friend request sent server error | ".concat(e.msg)),Qe.a.warning("Server error: friend request not sent! ".concat(e.err),{position:"top-center",hideProgressBar:!0,pauseOnHover:!0})})),e.on(Bt.received.friendRequestDeclined,(function(e){if(console.log("Handle friend request declined event"),e&&e.friendRequest){var o=e.friendRequest.recipientId,c=e.friendRequest.sender.id;return!1===Ut(e.friendRequest.id,r)?void console.log("Error: cannot mark a friend request as declined if it does not exist! Request with ID: ".concat(e.friendRequest.id)):o===a.id?(Jt(c,n)&&(console.log("Friend exists in state. Declining new friend request will result in deleted friendship."),t(ve(c))),t(he(e.friendRequest.id)),void console.log("Successfully marked friend request with ID | ".concat(e.friendRequest.id," | as declined in state"),r)):c===a.id?(Jt(o,n)&&(console.log("Friend exists in state. Declined friend request will result in deleted friendship."),t(ve(o))),t(he(e.friendRequest.id)),Qe.a.warning("Friend request declined",{position:"top-center",hideProgressBar:!0,pauseOnHover:!0}),void console.log("Successfully marked friend request with ID | ".concat(e.friendRequest.id," | as declined in state"),r)):void console.log("Error: cannot mark friend request as declined. Current user is not friend request sender or recipient")}console.log("Error: cannot mark friend request as declined. Malformed message object from the server")})),e.on(Bt.received.friendRequestDeclinedError,(function(e){console.log("Error: server error while declining friend request ".concat(e.msg))})),e.on(Bt.received.friendAdded,(function(e){if(console.log("Handle friend added event"),e&&e.friendRequest&&e.acceptor){var o=e.friendRequest.id,c=e.friendRequest.sender,s=e.acceptor,i=s.id;return Ut(o,r)?(console.log("Marking request with ID | ".concat(o," | as accepted in the state")),t(Ee(o)),i===a.id?Jt(c.id,n)?void console.log("Error: cannot add new friend that already exists",n,c):(console.log("Adding new friend @".concat(c.tagName," to friend's list"),c),void t(pe(c))):c.id===a.id?Jt(i,n)?void console.log("Error: cannot add new friend that already exists",n,s):(console.log("Adding new friend @".concat(s.tagName," to friend's list"),s),void t(pe(s))):void console.log("Error: Friend request sender and recipient do not have IDs associated with current user",e.friendRequest,a.id)):void console.log("Error: Friend Request with ID | ".concat(o," | does not exist, cannot mark as accepted and add friend from it"))}console.log("Error: received friend request object from server is malformed",e)})),e.on(Bt.received.acceptFriendRequestError,(function(e){console.log("Error: server error while accept friend request action performed ".concat(e.msg))})),e.on(Bt.received.friendRemoved,(function(e){if(console.log("Handle friend removed event"),e&&e.exFriend1&&e.exFriend2){var r=e.exFriend1,o=e.exFriend2;if(r===a.id){if(Jt(o,n)){var c=n.filter((function(e){return e.id===o}))[0];return console.log("Removing friend from friend's list",c),void t(ve(o))}return void console.log("Error: friend with ID | ".concat(o," | does not exist in friend's list, cannot remove"))}if(o===a.id){if(Jt(r,n)){var s=n.filter((function(e){return e.id===r}))[0];return console.log("Removing friend from friend's list",s),void t(ve(r))}return void console.log("Error: friend with ID | ".concat(r," | does not exist in friend's list, cannot remove"))}console.log("Error: remove friend event does not have IDs associated with the current user or user's friend list",n,e)}else console.log("Error: remove friend event handler received a malformed message object from server",e)})),e.on(Bt.received.friendRemovedError,(function(e){console.log("Error: Friend removed server error | ".concat(e.msg))})),e.on(Bt.received.refreshNotificationSuccess,(function(e){console.log("Successfully refreshed notification socket and set client ID to ".concat(e.clientId))}))}(Ft=Xe()("".concat(r,"/notifications"),{transportOptions:{polling:{extraHeaders:{credentials:"include"}}},forceNew:!0}),t,e,s,i,a,o,c),Ft.emit("refreshNotificationSocket",{userId:e.id}),console.log("Successfully setup notifications socket"),function(){!function(e){if(null==e||!e)return!0;for(var t in Bt.received)e.off(Bt.received[t])}(Ft)}}catch(n){console.log("Error establishing notifications notificationSocket",n)}return function(){Ft&&(Object.keys(Bt.received).map((function(e){return Ft.off(e)})),Ft.close(),Ft=null)}}),[null===e||void 0===e?void 0:e.loggedIn]),null}var Yt=a(263);a(202);function $t(e){var t=e.handleSetConvPassword,a=Object(n.useState)(""),o=Object(d.a)(a,2),c=o[0],s=o[1],i=Object(n.useState)(!1),l=Object(d.a)(i,2),u=l[0],m=l[1],f=Object(n.useRef)([]),g=Object(n.useRef)(null),p=function(){m(!1),f.current=[],function(){var e=!0;return!1===ze.password.test(c)&&(e=!1,f.current.push("Invalid Password. Must be 8-32 characters")),e||m(!0),e}()?t(c):console.log("Error with password",f)};return Object(n.useEffect)((function(){null!=g.current&&g.current.focus()}),[g]),r.a.createElement("div",{className:"modal-password-set"},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,{className:"pt-2 pb-3"},r.a.createElement(E.a,{className:"mx-auto text-center pt-3"},r.a.createElement(Tt.a,{style:{width:42,height:42}}))),r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement("h5",null,"Set Password"))),r.a.createElement(h.a,{className:"pt-2 pb-2"},r.a.createElement(E.a,{style:{borderBottom:"1px solid #303030"},className:"mx-auto text-center",xs:"10"},r.a.createElement(x.a,{className:"mb-3 mt-2 mx-auto"},r.a.createElement(N.a,{style:{fontSize:"18pt",textAlign:"center",color:"white",minHeight:"50px",border:"none",minWidth:"80%",backgroundColor:"#252525"},placeholder:"Enter Password",type:"password","aria-label":"Enter Password","aria-describedby":"basic-addon1",onChange:function(e){s(e.target.value)},className:u?"mx-auto lead form-control-red":"mx-auto lead form-control-custom",ref:g,autoComplete:"new-password",name:"setPWNewConv"})))),r.a.createElement(h.a,{className:"pt-3 mt-2"},r.a.createElement(E.a,{className:"mx-auto text-center",xs:"10"},r.a.createElement(w.a,{onClick:function(){return p()},variant:"outline-success",size:"lg",style:{backgroundColor:"#252525",marginLeft:"auto",marginRight:"auto"},className:"p-3 rounded-pill"},"Set Password")))))}function Vt(e){var t=e.tagName,a=e.onCheck,o=Object(n.useState)(!1),c=Object(d.a)(o,2),s=c[0],i=c[1];return Object(n.useEffect)((function(){a(t,s)}),[s]),r.a.createElement(h.a,{className:"p-2"},r.a.createElement(E.a,{className:"text-center justify-content-around"},r.a.createElement(w.a,{onClick:function(){i(!s)},className:s?"p-3 m-2 account-button-checked":"p-3 m-2 account-button",variant:"dark",style:{border:"none",backgroundColor:"#202020",padding:"15px",minWidth:"150px",maxWidth:"150px",minHeight:"125px",maxHeight:"125px"}},"@",t)))}function _t(e){var t=e.errorSearch,a=e.selectedFriends,o=e.setSelectedFriends,c=e.setErrorSearch,s=e.setError,i=e.errorMsgs,l=e.setButtonsDisabled,u=Object(m.c)(ye),f=Object(n.useState)(""),g=Object(d.a)(f,2),p=g[0],v=g[1],y=Object(n.useState)([]),O=Object(d.a)(y,2),j=O[0],k=O[1];Object(n.useEffect)((function(){k(JSON.parse(JSON.stringify(u)))}),[u]),Object(n.useEffect)((function(){a.length<1?(l(!0),console.log("Buttons disabled")):(l(!1),console.log("Buttons enabled"))}),[a]);var C=function(e,t){var n=JSON.parse(JSON.stringify(a));return t?a.length>0?a.filter((function(t){return t===e})).length>1?void 0:(n.push(e),void o(n)):void o([e]):a.length>0?a.filter((function(t){return t===e})).length>0?void o(a.filter((function(t){return t!==e}))):void 0:void o([])};return r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,{className:"pb-3"},r.a.createElement(E.a,{xs:"2"}),r.a.createElement(E.a,{xs:"8",className:"border-bottom border-dark",style:{maxWidth:"450px"}},r.a.createElement(x.a,{className:"mb-3 mt-2 mx-auto"},r.a.createElement(N.a,{style:{textAlign:"center",fontSize:"18pt",color:"#EEEEEE",opacity:.8,minHeight:"50px",border:"none",backgroundColor:"#191919"},placeholder:"Search friends","aria-label":"Search friends","aria-describedby":"basic-addon1",onChange:function(e){return v(e.target.value)},className:t?"mx-auto lead form-control-red font-italic":"mx-auto lead form-control-custom font-italic",value:p,autoComplete:"new-password"}))),r.a.createElement(E.a,{xs:"2",style:{maxWidth:"50px"}},r.a.createElement(w.a,{onClick:function(){!function(){if(c(!1),s(!1),i.current=[],!1===ze.tagName.test(p))return c(!0),s(!0),v(""),void i.current.push("Invalid tagname for search");k(j.filter((function(e){return e.tagName.includes(p)||p.includes(e.tagName)})))}()},variant:"dark",style:{marginTop:"10px",display:"block",backgroundColor:"#191919",border:"none"}},r.a.createElement("span",{className:"text-primary text-lg-center"},r.a.createElement(It.a,{style:{color:"#BBBBBB",height:35,width:35,cursor:"pointer"}}))))),r.a.createElement(h.a,{className:"mb-2"},r.a.createElement(E.a,{className:"mx-auto"},r.a.createElement("span",{className:"font-italic text-small",style:{color:"dodgerblue"}},"Select Friends For Chat"))),r.a.createElement(h.a,null,r.a.createElement(E.a,{xs:"2"}),r.a.createElement(E.a,{xs:"8",style:{maxWidth:"500px"}},r.a.createElement(b.a,{fluid:!0,style:{minHeight:"225px",overflowY:"scroll",backgroundColor:"#191919"}},j&&j.length>0?j.map((function(e){return r.a.createElement(Vt,{key:e.id,id:e.id,tagName:e.tagName,onCheck:C})})):r.a.createElement(h.a,{className:"mb-4"},r.a.createElement(E.a,{className:"mx-auto text-center text-muted font-italic pt-5"},"No friends available! Add a friend!")))),r.a.createElement(E.a,{xs:"2"})))}function Kt(e){var t=e.setConversationName,a=e.errorName,o=Object(n.useRef)(null);return Object(n.useEffect)((function(){o.current&&o.current.focus()}),[o.current]),r.a.createElement(b.a,{fluid:!0,style:{maxWidth:"500px"}},r.a.createElement(x.a,{className:"mt-2 mx-auto"},r.a.createElement(N.a,{style:{textAlign:"center",fontSize:"22pt",color:"#d9534f",minHeight:"50px",border:"none",backgroundColor:"#191919"},placeholder:"Enter Chat Name","aria-label":"Enter Chat Name","aria-describedby":"basic-addon1",onChange:function(e){return t(e.target.value)},className:a?"mx-auto lead form-control-red":"mx-auto lead form-control-custom",autoComplete:"new-password",name:"setNameNewConv",ref:o})))}function Gt(){var e=Object(m.c)(L),t=Object(m.c)(ee),a=Object(n.useState)(""),o=Object(d.a)(a,2),c=o[0],s=o[1],i=ct(),l=Object(n.useState)(!1),u=Object(d.a)(l,2),f=u[0],g=u[1],v=Object(n.useState)([]),y=Object(d.a)(v,2),x=y[0],N=y[1],O=Object(n.useState)(!1),j=Object(d.a)(O,2),k=j[0],C=j[1],S=Object(n.useState)(!1),I=Object(d.a)(S,2),A=I[0],R=I[1],q=Object(n.useState)(!0),H=Object(d.a)(q,2),D=H[0],M=H[1],T=Object(n.useRef)(null),W=Object(n.useRef)([]),P=Object(n.useState)(!1),F=Object(d.a)(P,2),B=F[0],z=F[1],J=Object(n.useState)(""),U=Object(d.a)(J,2),Z=U[0],Y=U[1],$=Object(m.b)(),V=Object(m.c)(ye),_=i.width>768,K=function(){if(W.current=[],g(!1),C(!1),R(!1),function(){var a=!0;if(!1===ze.conversationName.test(c)&&(W.current.push("Invalid Conversation Name"),C(!0),a=!1),1===e.filter((function(e){return e.conversationName===c})).length&&(W.current.push("Conversation with that name already exists"),C(!0),a=!1),!0===a){var n,r=Object(p.a)(x);try{var o=function(){var e=n.value;if(!V.some((function(t){return t.tagName===e})))return W.current.push("Friend with tagname ".concat(e," isn't in your friends list")),a=!1,"break"};for(r.s();!(n=r.n()).done;){if("break"===o())break}}catch(u){r.e(u)}finally{r.f()}var s,i=Object(p.a)(e);try{for(i.s();!(s=i.n()).done;){var l=s.value,d=l.users.filter((function(e){return e.id!==t.id})).map((function(e){return e.tagName}));if(d&&d.length>0&&JSON.stringify(d)===JSON.stringify(x)){W.current.push('Chat named "'.concat(l.conversationName,'" with selected friends exists')),a=!1;break}}}catch(u){i.e(u)}finally{i.f()}}return a||g(!0),a}()){console.log("Creating new conversation and sending invites to users from friends list. Users: ",x);var a,n=Object(p.a)(x);try{var r=function(){var e=a.value;Ft&&Ft.emit("sendInvite",{sender:t,tagName:e,conversationName:c},(function(){console.log("Successfully emitted send invite to user with tagname",e)}))};for(n.s();!(a=n.n()).done;)r()}catch(o){n.e(o)}finally{n.f()}Qe.a.info("Successfully sent out conversation invites!",{position:"top-center",hideProgressBar:!0,pauseOnHover:!0})}else console.log("Errors: ",W)};return Object(n.useEffect)((function(){T&&T.current&&T.current.focus()}),[]),Object(n.useEffect)((function(){i.width,$(Se(r.a.createElement("span",null,"New Conversation")))}),[i.width]),r.a.createElement(b.a,{className:"h-100 w-100",fluid:!0,style:{margin:"auto",paddingLeft:_?"240px":"20px"}},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center",style:{opacity:.8,borderRadius:"10px",backgroundColor:"#191919",maxWidth:"600px"}},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,{className:"mt-2 mb-2"},r.a.createElement(Kt,{setConversationName:s,errorName:k})),r.a.createElement(h.a,{className:"mt-2 mb-2 pb-2"},r.a.createElement(_t,{errorSearch:A,selectedFriends:x,setSelectedFriends:N,setErrorSearch:R,setError:g,errorMsgs:W,setButtonsDisabled:M})),r.a.createElement(h.a,{className:"pt-3"},r.a.createElement(Yt.a,{open:B,onClose:function(){return z(!1)},"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement($t,{handleSetConvPassword:function(e){Z.split("").join(""),Y(e)}})),r.a.createElement(E.a,{className:"mx-auto"},r.a.createElement(w.a,{onClick:function(){return z(!0)},disabled:D,className:"rounded-pill p-2 mx-auto",variant:"outline-info",size:"lg",style:{opacity:D?.5:1,maxWidth:"200px",marginTop:"20px"}},"Set\xa0Password\xa0",r.a.createElement(Tt.a,{style:{width:25,height:25}})))),r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto"},r.a.createElement(w.a,{onClick:function(){return K()},disabled:D,className:"rounded-pill p-2 mx-auto",variant:"outline-success",size:"lg",style:{opacity:D?.5:1,maxWidth:"200px",marginTop:"20px"}},"Sent Chat Invites ",r.a.createElement(Pt.a,{style:{width:25,height:25}})))),r.a.createElement(h.a,{className:"pt-2 mt-2"},r.a.createElement(E.a,null,r.a.createElement("ul",null,f?W.current.map((function(e){return r.a.createElement("li",{key:e,className:"text-danger text-small"},e)})):"")))))))}function Xt(){return r.a.createElement("div",{className:"w-100 h-100"},r.a.createElement(Ht,null),r.a.createElement(b.a,{fluid:!0,className:"w-100 h-100"},r.a.createElement(Gt,null)))}var Qt=a(106),ea=a.n(Qt),ta=a(142),aa=a.n(ta),na=a(139),ra=a.n(na),oa=a(138),ca=a.n(oa),sa=a(140),ia=a.n(sa),la=a(141),da=a.n(la);a(65);function ua(){return r.a.createElement("div",{className:"settings-modal"},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement("h5",{className:"text-danger"},"About Project Zed"))),r.a.createElement(h.a,{className:"pt-2 pb-2"},r.a.createElement(E.a,{className:"mx-auto text-center text-white",xs:"12"},r.a.createElement(it.a,null,"Blah blah blah this is my open source version of realtime e2e encrypted messaging. Email me at jakestevens081@gmail.com for questions. www.github.com/jakesteve28 Wanna contribute to this? Email me!")))))}function ma(e){var t=e.logoutAccount,a=Object(n.useState)(""),o=Object(d.a)(a,2),c=o[0],s=o[1],i=Object(n.useState)(!1),l=Object(d.a)(i,2),u=l[0],m=l[1],f=Object(n.useRef)([]),g=function(){f.current=[],m(!1),function(){var e=!0;return!1===ze.tagName.test(c)&&(console.log("Error: new tagname failed regex test"),f.current.push("Error: new tagname failed regex test"),e=!1),e||m(!0),e}()&&(alert("Tagname changed successfully?"),t())};return r.a.createElement("div",{className:"settings-modal"},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement("h3",null,"Change Tagname"))),r.a.createElement(h.a,{className:"mb-2"},r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement("span",{className:"text-warning"},"Note that this is permanent, will require a logout, and will automatically update your friends lists."))),r.a.createElement(h.a,{className:"pt-2 pb-2 mb-1"},r.a.createElement(E.a,{className:"mx-auto text-center text-white",xs:"12"},r.a.createElement(x.a,null,r.a.createElement(N.a,{style:{marginLeft:"auto",maxWidth:"300px",marginRight:"auto",color:"white",opacity:.87,minWidth:"200px",minHeight:"50px",backgroundColor:"#212121",border:"none"},placeholder:"Enter desired Tagname","aria-label":"Enter desired Tagname","aria-describedby":"basic-addon1",className:u?"change-tagname-input error-placeholder":"change-tagname-input",onChange:function(e){s(e.target.value)}})))),r.a.createElement(h.a,{className:"mb-2"},r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement("span",{className:"text-muted font-italic"},"Must be 8-24 letters, numbers, dashes or underscores"))),r.a.createElement(h.a,{className:"pt-2 mt-2"},r.a.createElement(E.a,{className:"text-center"},r.a.createElement(w.a,{onClick:function(){return g()},variant:"outline-success",size:"lg",style:{padding:"10px"}},"Submit")))))}var fa=a(255);function ga(e){var t=e.logoutAccount;return r.a.createElement("div",{className:"settings-modal"},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement("h5",null,"Delete Account"))),r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement(it.a,{className:"text-warning"},"Note that this action is PERMANENT. Once clicked, your encrypted account info, all encrypted messages, encrypted chats, and associated encrypted metadata will be killed. Your username and email will be flagged and not allowed for re-application. If more than three deletes come from your IP/user agent, your IP will be flagged and not allowed for re-application. If your account is flagged, reported, or disabled for suspicious content, encrypted data will be warehoused as applicable by the law."))),r.a.createElement(h.a,{className:"pt-2 mt-2"},r.a.createElement(E.a,{className:"text-center"},r.a.createElement(w.a,{onClick:function(){return alert("You're going to be logged out now..."),void t()},variant:"outline-danger",size:"lg"},"DELETE ACCOUNT ",r.a.createElement(fa.a,null))))))}function pa(){return r.a.createElement("div",{className:"settings-modal"},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement("h5",null,"Privacy and Security Disclaimers"))),r.a.createElement(h.a,{className:"pt-2 pb-2"},r.a.createElement(E.a,{className:"mx-auto text-center text-white",xs:"12"},r.a.createElement(it.a,null,"Blah blah blah TODO")))))}function va(e){var t=e.logoutAccount;return r.a.createElement("div",{className:"settings-modal"},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement("h5",null,"Reset Password"))),r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto text-center pt-1 pb-3"},r.a.createElement(it.a,{className:"text-warning"},"Note that this action will log and lock you out, and then send a reset link to your account email."))),r.a.createElement(h.a,{className:"pt-2 mt-5"},r.a.createElement(E.a,{className:"text-center"},r.a.createElement(w.a,{onClick:function(){return alert("You're going to be logged out now..."),void t()},variant:"outline-danger",size:"lg"},"Reset Password")))))}function ba(){var e=Object(m.c)(ee),t=Object(m.b)(),a=ct(),o=a.width>768,c=Object(n.useState)(!1),s=Object(d.a)(c,2),u=s[0],f=s[1],g=Object(n.useState)(!1),p=Object(d.a)(g,2),v=p[0],y=p[1],x=Object(n.useState)(!1),N=Object(d.a)(x,2),O=N[0],j=N[1],k=Object(n.useState)(!1),C=Object(d.a)(k,2),S=C[0],I=C[1],A=Object(n.useState)(!1),R=Object(d.a)(A,2),H=R[0],D=R[1],M=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3000/api/auth/logout",{credentials:"include"});case 2:t(Q()),t(V()),t(He()),t(q()),t(re()),t(ge()),console.log("Successfully logged out");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){a.width>768?t(Se(r.a.createElement("span",null,r.a.createElement(ea.a,null),"\xa0Account Settings | @",e.tagName))):t(Se(r.a.createElement("span",null,r.a.createElement(ea.a,null)," ",r.a.createElement("span",{className:"text-primary"},"@",e.tagName))))}),[a.width]),r.a.createElement(b.a,{className:"h-100 w-100",fluid:!0,style:{margin:"auto",paddingLeft:o?"240px":"0px"}},r.a.createElement(h.a,{className:"pt-3"},r.a.createElement(Yt.a,{open:u,onClose:function(){return f(!1)},"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement(ua,null)),r.a.createElement(Yt.a,{open:H,onClose:function(){return D(!1)},"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement(ma,{logoutAccount:M})),r.a.createElement(Yt.a,{open:v,onClose:function(){return y(!1)},"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement(ga,{logoutAccount:M})),r.a.createElement(Yt.a,{open:O,onClose:function(){return j(!1)},"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement(pa,null)),r.a.createElement(Yt.a,{open:S,onClose:function(){return I(!1)},"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement(va,{logoutAccount:M}))),r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mx-auto p-5",xs:"8",style:{opacity:.8,borderRadius:"10px",backgroundColor:"#191919",maxWidth:"500px"}},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,{className:"mb-2"},r.a.createElement(E.a,{className:"pb-4 text-center lead mx-auto border-bottom border-dark",xs:"8",style:{opacity:.87,color:"#EEEEEE",fontSize:"16pt"}},"Your Account")),r.a.createElement(h.a,{className:"mb-2 mt-1"},r.a.createElement(E.a,{className:"p-2 text-center",style:{color:"#EEEEEE",opacity:.9,fontSize:"14pt"}},r.a.createElement("span",{className:"text-muted font-italic"},"Email:"),"\xa0\xa0\xa0",e.email)),r.a.createElement(h.a,{className:"p-2"},r.a.createElement(E.a,{className:"text-center justify-content-around"},r.a.createElement(w.a,{onClick:function(){I(!0)},className:"p-3 m-2 account-button",variant:"dark",style:{border:"none",backgroundColor:"#202020",padding:"15px",minWidth:"150px",maxWidth:"150px",minHeight:"125px",maxHeight:"125px"}},"Reset Password  ",r.a.createElement(ca.a,null)),r.a.createElement(w.a,{onClick:function(){D(!0)},className:"p-3 m-2 account-button",variant:"dark",style:{border:"none",backgroundColor:"#202020",padding:"15px",minWidth:"150px",maxWidth:"150px",minHeight:"125px",maxHeight:"125px"}},"Change Tagname ",r.a.createElement(ra.a,null)),r.a.createElement(w.a,{onClick:function(){f(!0)},className:"p-3 m-2 account-button",variant:"dark",style:{border:"none",backgroundColor:"#202020",padding:"15px",minWidth:"150px",maxWidth:"150px",minHeight:"125px",maxHeight:"125px"}},"About ",r.a.createElement(ia.a,null)),r.a.createElement(w.a,{onClick:function(){j(!0)},className:"p-3 m-2 account-button text-warning",variant:"dark",style:{border:"none",backgroundColor:"#202020",padding:"15px",minWidth:"150px",maxWidth:"150px",minHeight:"125px",maxHeight:"125px"}},"Privacy / Security Disclaimer ",r.a.createElement(da.a,null)),r.a.createElement(w.a,{onClick:function(){y(!0)},className:"p-3 m-2 account-button text-danger",variant:"dark",style:{border:"none",backgroundColor:"#202020",padding:"15px",maxWidth:"150px",minHeight:"125px",maxHeight:"125px"}},"Delete Account ",r.a.createElement(aa.a,null))))))))}function ha(){return r.a.createElement("div",{className:"w-100 h-100"},r.a.createElement(ba,null))}a(203),a(204),a(205);function Ea(){var e=Object(m.c)(ee),t=Object(m.b)(),a=Object(m.c)(Fe),o=Date.now(),c=Object(u.g)(),s=Object(n.useState)(!1),f=Object(d.a)(s,2),p=f[0],v=f[1],b=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:3000/api/auth/logout",{credentials:"include"});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Error while requesting logout, cookie is not cleared from browser. Clearing store and logging out",e.t0.message);case 8:t(Q()),t(V()),t(He()),t(q()),t(re()),t(ge()),c.push("/login");case 15:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var a=Object(l.a)(i.a.mark((function a(){var n,r,c;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=null,a.prev=1,a.next=4,fetch("http://localhost:3000/api/auth/refresh",{credentials:"include"});case 4:n=a.sent,a.next=12;break;case 7:return a.prev=7,a.t0=a.catch(1),console.log("Error: fetching refresh token unauthorized, please login"),v(!1),a.abrupt("return",!1);case 12:return a.next=14,n.json();case 14:if(r=a.sent,c=r.successful,!e.loggedIn||!0!==c){a.next=23;break}return console.success("Refresh token fetch successful"),t(We(o+9e5)),v(!1),a.abrupt("return",!0);case 23:return console.error("Not logged in, not going to attempt refresh. Logging out."),console.error("Refresh token fetch failed. Logging out"),a.next=27,b();case 27:return v(!1),a.abrupt("return",!1);case 29:case"end":return a.stop()}}),a,null,[[1,7]])})));return function(){return a.apply(this,arguments)}}();return-1!==a&&a<=o&&(p||(v(!0),h())),r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/login",component:Ye}),r.a.createElement(u.b,{path:"/forgotPassword",component:Ve}),r.a.createElement(u.b,{path:"/createAccount",component:Ke}),r.a.createElement(g,{path:"/home",component:Dt,auth:e.loggedIn}),r.a.createElement(g,{path:"/newConversation",component:Xt,auth:e.loggedIn}),r.a.createElement(g,{path:"/settings",component:ha,auth:e.loggedIn}),r.a.createElement(g,{path:"/",component:Dt,auth:e.loggedIn}))}var ya=a(259),xa=a(258),Na=a(260),wa=a(150),Oa=a.n(wa),ja=a(89),ka=a.n(ja),Ca=a(143),Sa=a.n(Ca),Ia=a(144),Aa=a.n(Ia);function Ra(){var e=Object(m.b)(),t=function(){var t=Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://localhost:3000/api/auth/logout",{credentials:"include"});case 2:e(Q()),e(V()),e(He()),e(q()),e(re()),e(ge()),console.log("Successfully logged out");case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement(lt.a,{className:"topbar-dropdown",style:{backgroundColor:"#191919",position:"relative",maxWidth:"100px",opacity:.9}},r.a.createElement(lt.a.Toggle,{className:"dropdown-toggle text-white",style:{border:" none",backgroundColor:"#191919"},as:"button",id:"dropdown-custom-2"},r.a.createElement(ut.a,null)),r.a.createElement(lt.a.Menu,{className:"dropdown-menu-custom-bg-settings",style:{backgroundColor:"#191919",maxWidth:"100px"}},r.a.createElement(lt.a.Item,{className:"text-white text-center dropdown-item-settings",style:{backgroundColor:"#404040",padding:"15px"},as:"button",onClick:function(){return document.querySelector("#accountSettings").click()}},r.a.createElement(O.b,{id:"accountSettings",as:"button",style:{textDecoration:"none",color:"#AAAAAA"},to:"/settings"},"Account\xa0",r.a.createElement(Sa.a,null))),r.a.createElement(lt.a.Item,{className:"text-white text-center dropdown-item-settings",style:{backgroundColor:"#404040",padding:"15px"},as:"button",onClick:function(){t()}},r.a.createElement(O.b,{style:{textDecoration:"none",color:"#AAAAAA"},to:"/login"},"Logout\xa0",r.a.createElement(Aa.a,null)))))}function qa(e){var t=e.account,a=e.currentConversation,n=e.isOnline,o=e.tagName,c=e.conversations,s=e.history,i=e.dispatch,l=ct();return r.a.createElement(b.a,{className:"friend-list-item-row",fluid:!0},r.a.createElement(h.a,{className:"p-3"},r.a.createElement(E.a,{xs:"8",className:"".concat(n?"text-success":"text-danger"," py-auto font-italic text-sm text-center my-auto"),style:{opacity:.67}},r.a.createElement("span",{className:""},"@",o)),r.a.createElement(E.a,{xs:"4",className:"text-left"},r.a.createElement(w.a,{className:"dropdown-toggle text-white hidden-dropdown-friend-list-item",variant:"dark",style:{maxWidth:"50px",border:"none",backgroundColor:"#303030"},onClick:function(){return function(){if(c.length>0){var e,n=Object(p.a)(c);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!1===r.pending){if("/home"!==location.pathname&&s.push("/home"),a.conversationName===r.conversationName){i(H(!1)),i(R(!1));break}r&&""!==r.conversationName&&l.width>768&&a.conversationName!==r.conversationName&&i(Se(r.conversationName)),r&&""!==r.conversationName&&l.width<=768&&a.conversationName!==r.conversationName&&i(Se("")),i(H(!1)),i(W({conversation:r})),i(R(!1)),et&&et.emit("setCurrentConversation",{user:t,conversationId:r.id},(function(){return console.log("Emitted setCurrentConversation successfully")}));break}}}catch(o){n.e(o)}finally{n.f()}}else location.pathname&&s.push("/newConversation")}()}},r.a.createElement(ka.a,null)))))}var Ha=a(147),Da=a.n(Ha),Ma=a(146),Ta=a.n(Ma),Wa=a(145),Pa=a.n(Wa);function Fa(){var e=Object(m.b)(),t=Object(u.g)(),a=Object(m.c)(ee),o=Object(m.c)(ye),c=Object(m.c)(L),s=Object(n.useState)(""),f=Object(d.a)(s,2),g=f[0],v=f[1],y=Object(n.useState)(""),O=Object(d.a)(y,2),j=O[0],k=O[1],C=Object(n.useState)(!1),S=Object(d.a)(C,2),I=S[0],A=S[1],R=Object(n.useState)(null),q=Object(d.a)(R,2),H=q[0],D=q[1],M=Object(n.useState)(!1),T=Object(d.a)(M,2),W=T[0],P=T[1],F=Object(n.useState)(!1),B=Object(d.a)(F,2),J=B[0],U=B[1],Z=Object(n.useRef)([]),Y=Object(m.c)(z),$=function(){var e=!0;return Z.current=[],!1===ze.tagName.test(g)&&(e=!1,Z.current.push("Invalid tagname. Try 8-24 letters, numbers, dashes, underscores")),o.filter((function(e){return e.tagName===g})).length>0&&(e=!1,Z.current.push("Friend already exists")),e||A(!0),e},V=function(){if(A(!1),Z.current&&!1!==Array.isArray(Z.current)&&0===Z.current.length||(Z.current=[]),P(!1),!1===function(){var e=!0;return Z.current=[],!1===ze.tagNameSearch.test(j)&&(e=!1,Z.current.push("Invalid friend name")),a.tagName===j&&(e=!1,Z.current.push("Cannot search/send self")),e||A(!0),e}())return console.log("Error searching friend's list, invalid tag name!"),void P(!0);console.log("Filtering friend's list by tagname | ".concat(g)),o.length>1&&D(o.filter((function(e){return e.tagName.includes(j)||j.includes(e.tagName)})))},_=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(!1),Z.current&&!1!==Array.isArray(Z.current)&&0===Z.current.length||(Z.current=[]),U(!1),!1!==$()){e.next=7;break}return console.log("Error cannot send friend request",Z),U(!0),e.abrupt("return");case 7:a&&Ft?Ft.emit("sendFriendRequest",{senderId:a.id,recipientId:g},(function(){console.log("Friend request sent to user @".concat(g))})):console.log("Error sending friend request, not connected to notifications socket");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(lt.a,{className:"ml-3 p-1",style:{backgroundColor:"#191919"}},r.a.createElement(At.a,{title:"Friends List"},r.a.createElement(lt.a.Toggle,{as:"button",style:{border:"none",color:"white",backgroundColor:"#191919"},className:"top-dropdown-button font-weight-bold rounded-pill ml-2"},r.a.createElement(Pa.a,null))),r.a.createElement(lt.a.Menu,{style:{backgroundColor:"#191919",minWidth:"325px"},className:"dropdown-menu-custom-bg"},r.a.createElement(lt.a.ItemText,{className:"text-center font-weight-bold lead mb-1",style:{backgroundColor:"#191919",opacity:.9,color:"#AAAAAA"}},r.a.createElement(Ta.a,null),"\xa0\xa0Friends"),r.a.createElement(b.a,{fluid:!0,className:"h-100",style:{backgroundColor:"#191919",minWidth:"325px",paddingTop:"20px"}},r.a.createElement(h.a,{className:"m-1"},r.a.createElement(E.a,{xs:"10"},r.a.createElement(x.a,null,r.a.createElement(N.a,{style:{marginLeft:"auto",maxWidth:"250px",marginRight:"auto",color:"white",opacity:.87,minWidth:"200px",minHeight:"50px",backgroundColor:"#202020",border:"none"},placeholder:"Add Friend By Tagname","aria-label":"Add Friend By Tagname","aria-describedby":"basic-addon1",className:J?"search-friend-bar error-placeholder":"search-friend-bar",onChange:function(e){v(e.target.value)}}))),r.a.createElement(E.a,{xs:"2"},r.a.createElement(w.a,{variant:"dark",className:"mr-3 pr-2",style:{display:"block",marginRight:"auto",marginLeft:"-15px",backgroundColor:"#191919",border:"none",color:"#555555"},onClick:function(){return _()},disabled:g.length<8},r.a.createElement(Da.a,{className:J?"error-icon":"",style:{height:30,width:30,color:"#AAAAAA"}})))),r.a.createElement(h.a,{className:"m-1 mt-2 mb-2 mb-1 pb-3"},r.a.createElement(E.a,{xs:"10"},r.a.createElement(x.a,null,r.a.createElement(N.a,{style:{marginLeft:"auto",maxWidth:"250px",marginRight:"auto",color:"white",opacity:.87,minWidth:"200px",minHeight:"50px",backgroundColor:"#202020",border:"none"},placeholder:"Search Friends...","aria-label":"Search Friends...","aria-describedby":"basic-addon1",className:W?"search-friend-bar error-placeholder":"search-friend-bar",onChange:function(e){k(e.target.value)}}))),r.a.createElement(E.a,{xs:"2"},r.a.createElement(w.a,{variant:"dark",style:{display:"block",marginRight:"auto",marginLeft:"-15px",backgroundColor:"#191919",border:"none",color:"#555555"},onClick:function(){return V()}},r.a.createElement(It.a,{className:W?"error-icon":"",style:{height:30,width:30,color:"#AAAAAA"}})))),r.a.createElement(h.a,{style:{maxWidth:"250px",minWidth:"250px",overflowY:"scroll",marginRight:"auto",marginLeft:"15px"},className:"mt-1 pb-1"},r.a.createElement(E.a,{style:{maxHeight:"190px"}},Array.isArray(H)?H.map((function(n){var o=[];if(c&&Array.isArray(c)){var s,i=Object(p.a)(c);try{for(i.s();!(s=i.n()).done;){var l=s.value;if(l.users&&Array.isArray(l.users)){var d,u=Object(p.a)(l.users);try{for(u.s();!(d=u.n()).done;){if(d.value.tagName===n.tagName){o.push(l);break}}}catch(m){u.e(m)}finally{u.f()}}}}catch(m){i.e(m)}finally{i.f()}}return n&&n.tagName?r.a.createElement(h.a,{key:n.tagName,style:{maxHeight:"65px",backgroundColor:"#505050"},className:"friend-topbar"},r.a.createElement(qa,{account:a,currentConversation:Y,history:t,dispatch:e,conversations:o,key:n.tagName,tagName:n.tagName,isOnline:n.isOnline})):null})):o.map((function(n){if(n&&n.tagName){var o=[];if(c&&Array.isArray(c)){var s,i=Object(p.a)(c);try{for(i.s();!(s=i.n()).done;){var l=s.value;if(l.users&&Array.isArray(l.users)){var d,u=Object(p.a)(l.users);try{for(u.s();!(d=u.n()).done;){if(d.value.tagName===n.tagName){o.push(l);break}}}catch(m){u.e(m)}finally{u.f()}}}}catch(m){i.e(m)}finally{i.f()}}return r.a.createElement(h.a,{key:n.tagName,style:{maxHeight:"65px",backgroundColor:"#505050"},className:"friend-topbar"},r.a.createElement(qa,{account:a,currentConversation:Y,history:t,dispatch:e,conversations:o,key:n.tagName,tagName:n.tagName,isOnline:n.isOnline}))}return null}))))),I?r.a.createElement(b.a,{fluid:!0,className:"text-left lead",style:{opacity:.9}},r.a.createElement(h.a,{className:"font-italic text-danger",style:{margin:"20px",borderBottom:"1px solid red",opacity:.87}},"Errors:"),r.a.createElement(h.a,null,r.a.createElement("ul",null,Z.current.map((function(e){return r.a.createElement("li",{className:"text-danger text-small",key:e},e)}))))):""))}var Ba=a(262),La=a(257),za=a(256),Ja=a(148),Ua=a.n(Ja),Za=a(149),Ya=a.n(Za);function $a(e){var t=e.requestId,a=e.tagName,n=Object(m.c)(ee);return a===n.tagName?"":r.a.createElement(h.a,{className:"friend-request-list-item p-2"},r.a.createElement(E.a,{className:"text-small text-center my-auto",style:{opacity:.67}},"Friend request from @",a),r.a.createElement(E.a,{xs:"5",className:"text-center p-2",style:{opacity:.67}},r.a.createElement(w.a,{className:"button-bg mb-1 rounded-pill",style:{border:"none",color:"#97fa93",backgroundColor:"#191919",opacity:.9},onClick:function(){Ft&&(console.log("Emitted acceptFriendRequest"),Ft.emit("acceptFriendRequest",{friendRequestId:t},(function(){console.log("Successfully emitted accept friend request")})))}},r.a.createElement(At.a,{title:"Accept"},r.a.createElement(Ua.a,null))),r.a.createElement(w.a,{className:"button-bg rounded-pill",style:{border:"none",color:"#bf2700",backgroundColor:"#191919"},onClick:function(){return alert("Decline friend request")}},r.a.createElement(At.a,{title:"Decline"},r.a.createElement(Ya.a,null)))))}function Va(e){var t=e.sender,a=Object(m.c)(L),o=Object(n.useState)(""),c=Object(d.a)(o,2),s=c[0],i=c[1];Object(n.useEffect)((function(){var e;if(a&&Array.isArray(a)){var n,r=Object(p.a)(a);try{for(r.s();!(n=r.n()).done;){var o,c=n.value,s=Object(p.a)(c.users);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(l.id===t){e=JSON.parse(JSON.stringify(l));break}}}catch(d){s.e(d)}finally{s.f()}}}catch(d){r.e(d)}finally{r.f()}}e.tagName&&i(e.tagName)}),[]);return r.a.createElement(h.a,{className:"p-3 accepted-list-item"},r.a.createElement(E.a,{className:"text-small text-center my-auto",style:{opacity:.67}},"Chat with ","".concat(s).length>10?"".concat(s).substring(0,7)+"...":"".concat(s)),r.a.createElement(E.a,{xs:"5",className:"text-center pr-2",style:{opacity:.67}},r.a.createElement(w.a,{onClick:function(){alert("Todo")},className:"btn-sm mb-1 rounded-pill button-bg",style:{border:"none",backgroundColor:"#191919",opacity:.9}},r.a.createElement(At.a,{title:"Delete"},r.a.createElement(pt.a,null)))))}function _a(e){var t=e.sender,a=e.inviteId,n=e.convId;return r.a.createElement(h.a,{className:"p-3 invite-hover"},r.a.createElement(E.a,{className:"text-small text-muted text-center my-auto",style:{opacity:.67}},"Chat with ","".concat(t).length>10?"".concat(t).substring(0,7)+"...":"".concat(t)),r.a.createElement(E.a,{xs:"5",className:"text-center",style:{opacity:.67}},r.a.createElement(w.a,{className:"btn-sm mb-1 rounded-pill",style:{border:"none",color:"#97fa93",backgroundColor:"#191919",opacity:.9},onClick:function(){Ft&&(console.log("Attempting to emit acceptInvite event to server for invite with id ".concat(a)),Ft.emit("acceptInvite",{inviteId:a,conversationId:n},(function(){console.log("Successfully emitted acceptInvite event to server for invite with id ".concat(a))})))}},"Accept"),r.a.createElement(w.a,{className:"btn-sm rounded-pill",style:{border:"none",color:"#bf2700",backgroundColor:"#191919"}},"Decline")))}var Ka=a(94),Ga=a.n(Ka);function Xa(){var e=Object(m.c)(le),t=Object(m.c)(xe),a=Object(m.c)(de),n=Object(m.c)(ee);return r.a.createElement(lt.a,{className:"ml-3 p-1 topbar-dropdown",style:{backgroundColor:"#191919",opacity:.95}},r.a.createElement(At.a,{title:"Notifications"},r.a.createElement(lt.a.Toggle,{as:"button",style:{border:"none",color:"white",backgroundColor:"#191919"},className:"top-dropdown-button font-weight-bold rounded-pill ml-2"},e.length>=1||t.length>=1?r.a.createElement(za.a,{color:"default",overlap:"circle",badgeContent:" ",variant:"dot"},r.a.createElement(Ga.a,null)):r.a.createElement(Ga.a,null))),r.a.createElement(lt.a.Menu,{className:"dropdown-menu-custom-bg",style:{backgroundColor:"#191919",minWidth:"350px"}},r.a.createElement(lt.a.ItemText,{className:"text-center font-weight-bold lead p-3 pb-2",style:{opacity:.9,color:"#AAAAAA"}},r.a.createElement(Ga.a,null),"\xa0\xa0Notifications"),r.a.createElement(b.a,{fluid:!0,style:{maxHeight:"250px",minHeight:"250px",minWidth:"250px",overflowY:"scroll"}},r.a.createElement(Ba.a,{className:"tabs-notifications",defaultActiveKey:"received",id:"uncontrolled-tab-example"},r.a.createElement(La.a,{className:"tab-notifications",eventKey:"received",title:"Received"},t.filter((function(e){return e.recipientId===n.id})).map((function(e){return e&&!1===e.accepted&&!1===e.cancelled&&e.sender.id!==n.id?r.a.createElement($a,{requestId:e.id,recipientId:e.recipientId,sender:e.sender,tagName:e.sender.tagName,key:"".concat(e.id)}):null})),e.map((function(e){return r.a.createElement(_a,{sender:e.sender?e.sender:"".concat(e.senderId),key:"".concat(Math.random()),convId:"".concat(e.conversationId),inviteId:"".concat(e.id)})}))),r.a.createElement(La.a,{eventKey:"accepted",title:"Accepted"},a.map((function(e){return r.a.createElement(Va,{sender:"".concat(e.senderId),key:"".concat(Math.random()),convId:"".concat(e.conversationId),inviteId:"".concat(e.id)})})))))))}var Qa=Object(kt.a)((function(e){return{root:{display:"flex",flexGrow:1,backgroundColor:"#191919",height:"100%",opacity:.87},appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"#191919"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,color:"white"},menu:{backgroundColor:"#404040"}}}));function en(){var e=Object(m.c)(J),t=Object(m.c)(U),a=Object(m.b)();return r.a.createElement("div",null,r.a.createElement(O.b,{id:"startChat",style:{display:"none"},to:"/newConversation"}),r.a.createElement(w.a,{onClick:Object(l.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t&&a(R(!1)),e&&a(H(!1)),document.getElementById("startChat").click();case 3:case"end":return n.stop()}}),n)}))),variant:"primary",className:"rounded-pill mx-auto my-form-control-button",style:{opacity:.75,boxShadow:"black 5px 5px "}},r.a.createElement(ka.a,null)," Start chat"))}function tn(){var e=ct(),t=Qa(),a=Object(m.c)(ee),n=Object(m.b)(),o=e.width<768,c=Object(m.c)(U),s=Object(u.h)(),i=Object(m.c)(Ie);return r.a.createElement(xa.a,null,r.a.createElement(ya.a,{position:"fixed",className:t.appBar},r.a.createElement(jt.a,null,r.a.createElement(Na.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"}),r.a.createElement(it.a,{component:"span",className:t.title},r.a.createElement(b.a,{fluid:!0},r.a.createElement(h.a,{className:"text-center"},a.loggedIn&&o&&!c?r.a.createElement(w.a,{style:{backgroundColor:"#191919",border:"none"},onClick:function(){n(R(!c))}},r.a.createElement(Oa.a,null)):"",a.loggedIn?r.a.createElement("div",null,r.a.createElement(en,null),r.a.createElement(Xa,null),r.a.createElement(Fa,null)):""))),e.width>768?r.a.createElement(it.a,{component:"span",variant:"h4",className:t.title},r.a.createElement("span",{style:{opacity:.67},className:"text-white lead"},i)):"",!1===a.loggedIn&&"/login"!==s.pathname?r.a.createElement(O.b,{className:"rounded-pill btn btn-outline-primary mr-5 rounded-pill",style:{opacity:.67},renderas:w.a,to:"/login"},"Login"):"",a.loggedIn?r.a.createElement(Ra,null):"")))}c.a.render(r.a.createElement("div",{className:"base-div",style:{backgroundColor:"#191919"}},r.a.createElement(r.a.StrictMode,null,r.a.createElement(m.a,{store:Le},r.a.createElement(O.a,{basename:"/client/"},r.a.createElement(n.Suspense,{fallback:null},r.a.createElement(tn,null),r.a.createElement(Zt,null),r.a.createElement(Ea,null)))))),document.getElementById("root"))},29:function(e,t,a){},52:function(e,t,a){},65:function(e,t,a){}},[[159,1,2]]]);
//# sourceMappingURL=main.809ccba4.chunk.js.map